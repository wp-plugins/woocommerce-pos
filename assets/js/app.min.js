!function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,b),e.loaded=!0,e.exports}var c={};return b.m=a,b.c=c,b.p="",b(0)}([function(a,b,c){var d=c(36),e=c(145);c(147);var f=c(52),g=c(149),h=c(92),i=c(191),j=c(194),k=c(103),l=c(110),m=c(195),n=c(201),o=c(242),p=c(251);c(255);var q=new e;q.entitiesService=new f({app:q}),q.headerService=new g({headerContainer:q.layout.getRegion("header"),menuContainer:q.layout.getRegion("menu")}),q.posApp=new n({container:q.layout.getRegion("main")}),q.supportApp=new o({container:q.layout.getRegion("main")}),q.printApp=new p({container:q.layout.getRegion("main")}),q.modalService=new h({container:q.layout.getRegion("modal")}),q.popoverService=new i,q.printService=new j,q.tabsService=new k,q.buttonsService=new l,q.numpadService=new m,a.exports=window.POS=d.create(q)},,function(a,b){a.exports=_},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(a,b,c){var d=c(2),e=c(37),f=c(40),g=c(41);window.wc_pos_debug&&e.enable("*");var h=e().enabled;g.DEBUG=h,console.info("Debugging is "+(h?"on":"off")+", visit http://woopos.com.au/docs/debugging"),a.exports={VERSION:4004,attach:function(a,b){a=a.split(".");var c=d.reduceRight(a,function(a,b){var c={};return c[b]=a,c},b||{});f.extend(!0,this,c)},create:function(a){return d.defaults(a,this)},debug:e,getOption:function(){}}},function(a,b,c){function d(){return"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function e(){var a=arguments,c=this.useColors;if(a[0]=(c?"%c":"")+this.namespace+(c?" %c":" ")+a[0]+(c?"%c ":" ")+"+"+b.humanize(this.diff),!c)return a;var d="color: "+this.color;a=[a[0],d,"color: inherit"].concat(Array.prototype.slice.call(a,1));var e=0,f=0;return a[0].replace(/%[a-z%]/g,function(a){"%%"!==a&&(e++,"%c"===a&&(f=e))}),a.splice(f,0,d),a}function f(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function g(a){try{null==a?b.storage.removeItem("debug"):b.storage.debug=a}catch(c){}}function h(){var a;try{a=b.storage.debug}catch(c){}return a}function i(){try{return window.localStorage}catch(a){}}b=a.exports=c(38),b.log=f,b.formatArgs=e,b.save=g,b.load=h,b.useColors=d,b.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:i(),b.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],b.formatters.j=function(a){return JSON.stringify(a)},b.enable(h())},function(a,b,c){function d(){return b.colors[k++%b.colors.length]}function e(a){function c(){}function e(){var a=e,c=+new Date,f=c-(j||c);a.diff=f,a.prev=j,a.curr=c,j=c,null==a.useColors&&(a.useColors=b.useColors()),null==a.color&&a.useColors&&(a.color=d());var g=Array.prototype.slice.call(arguments);g[0]=b.coerce(g[0]),"string"!=typeof g[0]&&(g=["%o"].concat(g));var h=0;g[0]=g[0].replace(/%([a-z%])/g,function(c,d){if("%%"===c)return c;h++;var e=b.formatters[d];if("function"==typeof e){var f=g[h];c=e.call(a,f),g.splice(h,1),h--}return c}),"function"==typeof b.formatArgs&&(g=b.formatArgs.apply(a,g));var i=e.log||b.log||console.log.bind(console);i.apply(a,g)}c.enabled=!1,e.enabled=!0;var f=b.enabled(a)?e:c;return f.namespace=a,f}function f(a){b.save(a);for(var c=(a||"").split(/[\s,]+/),d=c.length,e=0;d>e;e++)c[e]&&(a=c[e].replace(/\*/g,".*?"),"-"===a[0]?b.skips.push(new RegExp("^"+a.substr(1)+"$")):b.names.push(new RegExp("^"+a+"$")))}function g(){b.enable("")}function h(a){var c,d;for(c=0,d=b.skips.length;d>c;c++)if(b.skips[c].test(a))return!1;for(c=0,d=b.names.length;d>c;c++)if(b.names[c].test(a))return!0;return!1}function i(a){return a instanceof Error?a.stack||a.message:a}b=a.exports=e,b.coerce=i,b.disable=g,b.enable=f,b.enabled=h,b.humanize=c(39),b.names=[],b.skips=[],b.formatters={};var j,k=0},function(a,b){function c(a){if(a=""+a,!(a.length>1e4)){var b=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(a);if(b){var c=parseFloat(b[1]),d=(b[2]||"ms").toLowerCase();switch(d){case"years":case"year":case"yrs":case"yr":case"y":return c*k;case"days":case"day":case"d":return c*j;case"hours":case"hour":case"hrs":case"hr":case"h":return c*i;case"minutes":case"minute":case"mins":case"min":case"m":return c*h;case"seconds":case"second":case"secs":case"sec":case"s":return c*g;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return c}}}}function d(a){return a>=j?Math.round(a/j)+"d":a>=i?Math.round(a/i)+"h":a>=h?Math.round(a/h)+"m":a>=g?Math.round(a/g)+"s":a+"ms"}function e(a){return f(a,j,"day")||f(a,i,"hour")||f(a,h,"minute")||f(a,g,"second")||a+" ms"}function f(a,b,c){return b>a?void 0:1.5*b>a?Math.floor(a/b)+" "+c:Math.ceil(a/b)+" "+c+"s"}var g=1e3,h=60*g,i=60*h,j=24*i,k=365.25*j;a.exports=function(a,b){return b=b||{},"string"==typeof a?c(a):b["long"]?e(a):d(a)}},function(a,b){a.exports=jQuery},function(a,b){a.exports=Backbone.Radio},,function(a,b,c){var d=c(44),e=c(36),f=c(41),g=c(2);a.exports=e.Application=d.Application.extend({_initChannel:function(){this.channelName=g.result(this,"channelName")||"global",this.channel=g.result(this,"channel")||f.channel(this.channelName)}})},function(a,b){a.exports=Marionette},function(a,b){a.exports=Backbone},,function(a,b,c){var d=c(44),e=c(36);a.exports=e.LayoutView=d.LayoutView.extend({working:function(a){"start"===a?this.$el.addClass("working"):this.$el.removeClass("working")}})},function(a,b){a.exports=accounting},function(a,b,c){var d=c(50),e=c(36),f=new d;a.exports=e.polyglot=f},function(a,b,c){a.exports=c(51)},function(a,b,c){var d,e;!function(c,f){d=[],e=function(){return f(c)}.apply(b,d),!(void 0!==e&&(a.exports=e))}(this,function(a){"use strict";function b(a){a=a||{},this.phrases={},this.extend(a.phrases||{}),this.currentLocale=a.locale||"en",this.allowMissing=!!a.allowMissing,this.warn=a.warn||i}function c(a){var b,c,d,e={};for(b in a)if(a.hasOwnProperty(b)){c=a[b];for(d in c)e[c[d]]=b}return e}function d(a){var b=/^\s+|\s+$/g;return a.replace(b,"")}function e(a,b,c){var e,f,h;return null!=c&&a?(f=a.split(k),h=f[g(b,c)]||f[0],e=d(h)):e=a,e}function f(a){var b=c(m);return b[a]||b.en}function g(a,b){return l[f(a)](b)}function h(a,b){for(var c in b)"_"!==c&&b.hasOwnProperty(c)&&(a=a.replace(new RegExp("%\\{"+c+"\\}","g"),b[c]));return a}function i(b){a.console&&a.console.warn&&a.console.warn("WARNING: "+b)}function j(a){var b={};for(var c in a)b[c]=a[c];return b}b.VERSION="0.4.3",b.prototype.locale=function(a){return a&&(this.currentLocale=a),this.currentLocale},b.prototype.extend=function(a,b){var c;for(var d in a)a.hasOwnProperty(d)&&(c=a[d],b&&(d=b+"."+d),"object"==typeof c?this.extend(c,d):this.phrases[d]=c)},b.prototype.clear=function(){this.phrases={}},b.prototype.replace=function(a){this.clear(),this.extend(a)},b.prototype.t=function(a,b){var c,d;return b=null==b?{}:b,"number"==typeof b&&(b={smart_count:b}),"string"==typeof this.phrases[a]?c=this.phrases[a]:"string"==typeof b._?c=b._:this.allowMissing?c=a:(this.warn('Missing translation for key: "'+a+'"'),d=a),"string"==typeof c&&(b=j(b),d=e(c,this.currentLocale,b.smart_count),d=h(d,b)),d},b.prototype.has=function(a){return a in this.phrases};var k="||||",l={chinese:function(a){return 0},german:function(a){return 1!==a?1:0},french:function(a){return a>1?1:0},russian:function(a){return a%10===1&&a%100!==11?0:a%10>=2&&4>=a%10&&(10>a%100||a%100>=20)?1:2},czech:function(a){return 1===a?0:a>=2&&4>=a?1:2},polish:function(a){return 1===a?0:a%10>=2&&4>=a%10&&(10>a%100||a%100>=20)?1:2},icelandic:function(a){return a%10!==1||a%100===11?1:0}},m={chinese:["fa","id","ja","ko","lo","ms","th","tr","zh"],german:["da","de","en","es","fi","el","he","hu","it","nl","no","pt","sv"],french:["fr","tl","pt-br"],russian:["hr","ru"],czech:["cs"],polish:["pl"],icelandic:["is"]};return b})},function(a,b,c){(function(b){var d=c(53),e=c(54),f=c(79),g=c(82),h=c(84),i=c(86),j=c(88),k=c(89),l=c(90),m=c(68),n=c(37)("entities"),o=c(36),p=c(2),q=b.localStorage||window.localStorage,r=b.JSON||window.JSON,s=d.extend({channelName:"entities",initialize:function(){this.channel.reply("get",this.get,this),this.channel.reply("set",this.set,this),this.channel.reply("remove",this.remove,this),this.channel.reply("set:filter",this.setFilter,this)},collections:{products:e,orders:f,cart:g,customers:h,coupons:i,gateways:l,settings:k},getMethods:{collection:"getCollection",model:"getModel",filtered:"getFiltered",option:"getOption",settings:"getSettings",localStorage:"getLocalStorage"},setMethods:{localStorage:"setLocalStorage"},get:function(a){a=a||{};var b=this.getMethods[a.type];return this[b]?this[b](a):void n('request needs a type, eg: "collection" or "option"')},set:function(a){a=a||{};var b=this.setMethods[a.type];return this[b]?this[b](a):void n('set needs a type, eg: "localStorage"')},attach:function(a){var b="model"===a.type?"models":"collections",c="_"+a.name;return this[b].hasOwnProperty(a.name)&&(this[c]=new this[b][a.name]([],a)),this[c]},getCollection:function(a){var b="_"+a.name;return a.init?new this.collections[a.name]([],a):this[b]||this.attach(a)},getAllCollections:function(){return p.reduce(this.collections,function(a,b,c){return a[c]=this.getCollection({name:c}),a},{},this)},getModel:function(a){var b="_"+a.name;return a.init?new this.models[a.name]([],a):this[b]||this.attach(a)},getFiltered:function(a){var b="_"+a.name,c="_filtered"+a.name;return this[c]?this[c]:(this[b]||this.attach(a),this[c]=new m(this[b],a),this[c])},getOption:function(a){return this.app.getOption(a.name)},getSettings:function(a){var b=this.app.getOption(a.name);return new j(b)},setFilter:function(a){a=a||{};var b="_filtered"+a.name;this[b]&&this[b].filterBy("search",a.filter)},serialize:function(a){return r.stringify(a)},deserialize:function(a){try{a=r.parse(a)}catch(b){n(b)}return a||void 0},getLocalStorage:function(a){a=a||{};var b=q.getItem("wc_pos_"+a.name),c=this.deserialize(b);return a.key&&c&&c[a.key]?c[a.key]:c},setLocalStorage:function(a){a=a||{};var b=a.data,c=this.getLocalStorage({name:a.name});p.isObject(c)&&p.isObject(b)&&(b=p.extend(c,b)),q.setItem("wc_pos_"+a.name,this.serialize(b))},remove:function(a){if(a=a||{},"localStorage"===a.type&&a.name&&a.key){var b=this.getLocalStorage({name:a.name});delete b[a.key],q.setItem("wc_pos_"+a.name,r.stringify(b))}else q.removeItem("wc_pos_"+a.name)},idbCollections:function(){return p.reduce(this.getAllCollections(),function(a,b,c){return b instanceof o.IndexedDBCollection&&(a[c]=b),a},{},this)}});a.exports=s,o.attach("Entities.Service",s)}).call(b,function(){return this}())},function(a,b,c){var d=c(44),e=c(41),f=c(36),g=c(2);a.exports=f.Service=d.Object.extend({constructor:function(a){a=a||{},this.channelName&&(this.channel=e.channel(g.result(this,"channelName"))),a.app&&(this.app=a.app),d.Object.apply(this,arguments)},start:function(){this.triggerMethod("before:start"),this._isStarted=!0,this.triggerMethod("start")},stop:function(){this.triggerMethod("before:stop"),this._isStarted=!1,this.triggerMethod("stop")},isStarted:function(){return this._isStarted===!0}})},function(a,b,c){var d=c(55),e=c(61);a.exports=d.extend({model:e,name:"products"})},function(a,b,c){var d=c(45),e=d.Radio,f=c(37)("dualCollection"),g=c(56),h=c(36),i=c(2),j=c(40),k=c(60);a.exports=h.DualCollection=g.extend({keyPath:"local_id",mergeKeyPath:"id",_syncDelayed:!0,queue:[],delay:500,url:function(){var a=e.request("entities","get",{type:"option",name:"wc_api"});return a+this.name},state:{pageSize:10},fetch:function(a){return a=a||{},a.remote?this.remoteFetch(a):g.prototype.fetch.call(this,a)},remoteFetch:function(a){var b=this;return this.sync("read",this,a).then(function(a){var c=b.parse(a);return g.prototype.merge.call(b,c)}).then(function(a){var c=i.map(a,function(a){return a.get("id")});b.dequeue(c)})},fullSync:function(){var a=this;return this._syncing?void f("sync already in progress"):(this._syncing=!0,f("fullSync started"),this.trigger("start:fullSync"),this.fetchUpdated().then(function(){return a.auditRecords()}).then(function(){return a._syncDelayed?a.syncDelayed():void 0}).done(function(){f("fullSync complete")}).fail(function(a){f("fullSync failed",a)}).always(function(){a._syncing=!1,a.trigger("end:fullSync")}))},fetchUpdated:function(){var a=this;if(0===this.length)return this.fetch({remote:!0});var b=i.compact(this.pluck("updated_at")).sort().pop();return this.getRemoteIds(b).then(function(b){return a.enqueue(b),a.processQueue({queue:b,all:!0})})},syncDelayed:function(){var a=this.getDelayedModels(),b=i.map(a,function(a){return a.remoteSync(null,a)});return j.when.apply(this,b)},getDelayedModels:function(){return this.filter(function(a){return a.isDelayed()})},auditRecords:function(){var a=this.pluck("id"),b=this;return this.getRemoteIds().then(function(c){var d=i.chain(c).difference(a).compact().value(),e=i.chain(a).difference(c).compact().value();return b.enqueue(d),b.dequeue(e),b.removeGarbage(e)}).done(function(){f("audit complete")}).fail(function(a){f("audit failed",a)})},getRemoteIds:function(a){var b=e.request("entities","get",{type:"option",name:"ajaxurl"});return f(a?"getting updated ids from server since "+a:"getting all ids from server"),j.getJSON(b,{action:"wc_pos_get_all_ids",type:this.name,updated_at_min:a})},removeGarbage:function(a){var b=this.getModelsByRemoteIds(a);if(0!==b.length)return this.remove(b),this.db.removeBatch(i.pluck(b,"id"))},getModelsByRemoteIds:function(a){return this.filter(function(b){return i(a).contains(b.get("id"))})},enqueue:function(a){return i.isArray(a)?void(this.queue=i.union(this.queue,a)):this.queue.push(a)},dequeue:function(a){i.isArray(a)?this.queue=i.difference(this.queue,a):this.queue=i.without(this.queue,a)},hasAllRecords:function(){return 0===this.queue.length},processQueue:function(a){a=a||{};var b=a.queue||i.clone(this.queue);if(0!==b.length&&!this._processingQueue){this._processingQueue=!0,this.trigger("start:processQueue");var c=this,d=new j.Deferred,e=b.splice(0,this.state.pageSize).join(",");return this.fetch({remote:!0,data:{filter:a.filter||{limit:-1,"in":e}}}).done(function(){a.all&&0!==b.length?(d.progress(e),i.delay(c.processQueue.bind(c),c.getDelay(),a)):d.resolve()}).fail(d.reject).always(function(){c._processingQueue=!1,c.trigger("end:processQueue")}),d.promise()}},getDelay:function(){return e.request("entities","get",{type:"option",name:"delay"})||this.delay},clear:function(){if(this.db){var a=this;return g.prototype.clear.call(this).then(function(){a.queue=[]})}},formatDate:function(a){return a?k(a).toISOString():void 0}})},function(a,b,c){var d=c(57),e=c(36),f=c(58),g=c(41);a.exports=e.IndexedDBCollection=d.extend({name:"store",storePrefix:"wc_pos_",dbVersion:e.VERSION,keyPath:"local_id",autoIncrement:!0,indexes:[{name:"local_id",keyPath:"local_id",unique:!0},{name:"id",keyPath:"id",unique:!0},{name:"status",keyPath:"status",unique:!1}],constructor:function(){d.apply(this,arguments);var a={storeName:this.name,storePrefix:this.storePrefix,dbVersion:this.dbVersion,keyPath:this.keyPath,autoIncrement:this.autoIncrement,indexes:this.indexes,defaultErrorHandler:function(a){g.trigger("global","error",{status:a.target.error.name,message:a.target.error.message})},onVersionChange:function(a){a.clear()}};this.db=new f(a,this),this.db.open().fail(function(a){g.trigger("global","error",{status:"indexedDB error",message:a})})},merge:function(a){var b=this;return this.db.merge(a).then(function(){var a=Array.prototype.slice.apply(arguments);return b.add(a,{merge:!0})})},clear:function(){if(this.db){var a=this;return this.db.open().then(function(){return a.reset(),a.db.clear()})}}})},function(a,b,c){var d=c(45),e=c(36);a.exports=e.Collection=d.Collection.extend({constructor:function(){d.Collection.apply(this,arguments),this._isNew=!0,this.once("sync",function(){this._isNew=!1})},isNew:function(){return this._isNew},parse:function(a){return a&&a[this.name]?a[this.name]:a},sync:function(){return d.sync.apply(this,arguments)}})},function(a,b,c){function d(a,b){this.parent=b,this.options=a,a.defaultErrorHandler&&(j=a.defaultErrorHandler)}var e=c(59),f=c(40),g=c(2),h=c(45),i=function(){},j=function(a){throw a},k={open:function(){if(this._open)return this._open;var a=new f.Deferred,b=this.options||{};return b.onStoreReady=a.resolve,b.onError=a.reject,this.store=new e(b),this._open=a.promise(),this._open},create:function(a,b){b=b||{};var c=b.success||i,d=b.error||j,e=this._returnAttributes(a),f=this.store.keyPath;return this.put(e).then(function(a){return e[f]=a,c(e),e}).fail(d)},update:function(a,b){b=b||{};var c=b.success||i,d=b.error||j,e=this._returnAttributes(a),f=this;return this.put(e).then(function(a){return f.get(a).done(c).fail(d)}).fail(d)},read:function(a,b){b=b||{};var c=b.success||i,d=b.error||j;return this.get(a.id).done(c).fail(d)},destroy:function(a,b){if(a.isNew())return!1;b=b||{};var c=b.success||i,d=b.error||j;return this.remove(a.id).done(c).fail(d)},put:function(a,b){var c=new f.Deferred;return null!==this.store.keyPath?this.store.put(a,c.resolve,c.reject):this.store.put(a,b,c.resolve,c.reject),c.promise()},get:function(a){var b=new f.Deferred;return this.store.get(a,b.resolve,b.reject),b.promise()},remove:function(a){return g.isObject(a)&&a.hasOwnProperty(this.store.keyPath)&&(a=a[this.store.keyPath]),this._remove(a)},_remove:function(a){var b=new f.Deferred;return this.store.remove(a,b.resolve,b.reject),b.promise()},getAll:function(a){var b=new f.Deferred,c=function(c){a.success.apply(this,arguments),b.resolve(c)},d=function(c){a.error.apply(this,arguments),b.reject(c)};return this.store.getAll(c,d),b.promise()},iterate:function(a){a=a||{};var b=new f.Deferred;a.onEnd=b.resolve,a.onError=b.reject;var c=b.notify;return this.store.iterate(c,a),b.promise()},makeKeyRange:function(a){return this.store.makeKeyRange(a)},saveAll:function(){return this.putBatch(this.parent.toJSON())},batch:function(a){var b=new f.Deferred;return this.store.batch(a,b.resolve,b.reject),b.promise()},putBatch:function(a){return g.isArray(a)?this._putBatch(a):this.put(a)},_putBatch:function(a){var b=new f.Deferred;return this.store.putBatch(a,b.resolve,b.reject),b.promise()},removeBatch:function(a){return g.isArray(a)?this._removeBatch(a):this.remove(a)},_removeBatch:function(a){var b=new f.Deferred;return this.store.removeBatch(a,b.resolve,b.reject),b.promise()},clear:function(){var a=new f.Deferred;return this.store.clear(a.resolve,a.reject),a.promise()},query:function(a,b){var c=new f.Deferred;return this.store.query(c.resolve,{index:a,keyRange:b,onError:c.reject}),c.promise()},getByAttribute:function(a){var b=g.chain(a).keys().first().value(),c=this.store.makeKeyRange({only:g.chain(a).values().first().value()});return this.query(b,c)},merge:function(a){if(a=g.isArray(a)?a:[a],!this.parent.mergeKeyPath)return this.putBatch(a);var b=g.map(a,this._merge,this);return f.when.apply(this,b)},_merge:function(a){var b=this.parent.mergeKeyPath,c=this.store.keyPath,d=this,e={};return a[c]?this.update(a):(e[b]=a[b],this.getByAttribute(e).then(function(b){var e=g.first(b);return e?(a[c]=e[c],d.update(a)):d.create(a)}))},_returnAttributes:function(a){return a instanceof h.Model?a.toJSON():a}};g.extend(d.prototype,k),a.exports=d},function(a,b,c){var d,e;!function(f,g,h){d=g,e="function"==typeof d?d.call(b,c,b,a):d,!(void 0!==e&&(a.exports=e))}("IDBStore",function(){"use strict";var a=function(a){throw a},b=function(){},c=function(){},d={storeName:"Store",storePrefix:"IDBWrapper-",dbVersion:1,keyPath:"id",autoIncrement:!0,onStoreReady:function(){},onError:a,onVersionChange:c,indexes:[]},e=function(a,b){"undefined"==typeof b&&"function"==typeof a&&(b=a),"[object Object]"!=Object.prototype.toString.call(a)&&(a={});for(var c in d)this[c]="undefined"!=typeof a[c]?a[c]:d[c];this.dbName=this.storePrefix+this.storeName,this.dbVersion=parseInt(this.dbVersion,10)||1,b&&(this.onStoreReady=b);var e="object"==typeof window?window:self;this.idb=e.indexedDB||e.webkitIndexedDB||e.mozIndexedDB||e.shimIndexedDB,this.keyRange=e.IDBKeyRange||e.webkitIDBKeyRange||e.mozIDBKeyRange,this.features={hasAutoIncrement:!e.mozIndexedDB},this.consts={READ_ONLY:"readonly",READ_WRITE:"readwrite",VERSION_CHANGE:"versionchange",NEXT:"next",NEXT_NO_DUPLICATE:"nextunique",PREV:"prev",PREV_NO_DUPLICATE:"prevunique"},this.openDB()};e.prototype={constructor:e,version:"1.5",db:null,dbName:null,dbVersion:null,store:null,storeName:null,storePrefix:null,keyPath:null,autoIncrement:null,indexes:null,features:null,onStoreReady:null,onError:null,_insertIdCount:0,openDB:function(){var a=this.idb.open(this.dbName,this.dbVersion),b=!1;a.onerror=function(a){var b=!1;"error"in a.target?b="VersionError"==a.target.error.name:"errorCode"in a.target&&(b=12==a.target.errorCode),b?this.onError(new Error("The version number provided is lower than the existing one.")):this.onError(a)}.bind(this),a.onsuccess=function(a){if(!b){if(this.db)return void this.onStoreReady();if(this.db=a.target.result,"string"==typeof this.db.version)return void this.onError(new Error("The IndexedDB implementation in this browser is outdated. Please upgrade your browser."));if(!this.db.objectStoreNames.contains(this.storeName))return void this.onError(new Error("Something is wrong with the IndexedDB implementation in this browser. Please upgrade your browser."));var c=this.db.transaction([this.storeName],this.consts.READ_ONLY);this.store=c.objectStore(this.storeName);var d=Array.prototype.slice.call(this.getIndexList());this.indexes.forEach(function(a){var c=a.name;if(!c)return b=!0,void this.onError(new Error("Cannot create index: No index name given."));if(this.normalizeIndexData(a),this.hasIndex(c)){var e=this.store.index(c),f=this.indexComplies(e,a);f||(b=!0,this.onError(new Error('Cannot modify index "'+c+'" for current version. Please bump version number to '+(this.dbVersion+1)+"."))),d.splice(d.indexOf(c),1)}else b=!0,this.onError(new Error('Cannot create new index "'+c+'" for current version. Please bump version number to '+(this.dbVersion+1)+"."))},this),d.length&&(b=!0,this.onError(new Error('Cannot delete index(es) "'+d.toString()+'" for current version. Please bump version number to '+(this.dbVersion+1)+"."))),b||this.onStoreReady()}}.bind(this),a.onupgradeneeded=function(a){if(this.db=a.target.result,this.db.objectStoreNames.contains(this.storeName))this.store=a.target.transaction.objectStore(this.storeName);else{var c={autoIncrement:this.autoIncrement};null!==this.keyPath&&(c.keyPath=this.keyPath),this.store=this.db.createObjectStore(this.storeName,c)}this.onVersionChange(this.store,a);var d=Array.prototype.slice.call(this.getIndexList());this.indexes.forEach(function(a){var c=a.name;if(c||(b=!0,this.onError(new Error("Cannot create index: No index name given."))),this.normalizeIndexData(a),this.hasIndex(c)){var e=this.store.index(c),f=this.indexComplies(e,a);f||(this.store.deleteIndex(c),this.store.createIndex(c,a.keyPath,{unique:a.unique,multiEntry:a.multiEntry})),d.splice(d.indexOf(c),1)}else this.store.createIndex(c,a.keyPath,{unique:a.unique,multiEntry:a.multiEntry})},this),d.length&&d.forEach(function(a){this.store.deleteIndex(a)},this)}.bind(this)},deleteDatabase:function(a,b){if(this.idb.deleteDatabase){this.db.close();var c=this.idb.deleteDatabase(this.dbName);c.onsuccess=a,c.onerror=b}else b(new Error("Browser does not support IndexedDB deleteDatabase!"))},put:function(c,d,e,f){null!==this.keyPath&&(f=e,e=d,d=c),f||(f=a),e||(e=b);var g,h=!1,i=null,j=this.db.transaction([this.storeName],this.consts.READ_WRITE);return j.oncomplete=function(){var a=h?e:f;a(i)},j.onabort=f,j.onerror=f,null!==this.keyPath?(this._addIdPropertyIfNeeded(d),g=j.objectStore(this.storeName).put(d)):g=j.objectStore(this.storeName).put(d,c),g.onsuccess=function(a){h=!0,i=a.target.result},g.onerror=f,j},get:function(c,d,e){e||(e=a),d||(d=b);var f=!1,g=null,h=this.db.transaction([this.storeName],this.consts.READ_ONLY);h.oncomplete=function(){var a=f?d:e;a(g)},h.onabort=e,h.onerror=e;var i=h.objectStore(this.storeName).get(c);return i.onsuccess=function(a){f=!0,g=a.target.result},i.onerror=e,h},remove:function(c,d,e){e||(e=a),d||(d=b);var f=!1,g=null,h=this.db.transaction([this.storeName],this.consts.READ_WRITE);h.oncomplete=function(){var a=f?d:e;a(g)},h.onabort=e,h.onerror=e;var i=h.objectStore(this.storeName)["delete"](c);return i.onsuccess=function(a){f=!0,g=a.target.result},i.onerror=e,h},batch:function(c,d,e){e||(e=a),d||(d=b),"[object Array]"!=Object.prototype.toString.call(c)&&e(new Error("dataArray argument must be of type Array."));var f=this.db.transaction([this.storeName],this.consts.READ_WRITE);f.oncomplete=function(){var a=i?d:e;a(i)},f.onabort=e,f.onerror=e;var g=c.length,h=!1,i=!1,j=function(){g--,0!==g||h||(h=!0,i=!0)};return c.forEach(function(a){var b=a.type,c=a.key,d=a.value,g=function(a){f.abort(),h||(h=!0,e(a,b,c))};if("remove"==b){var i=f.objectStore(this.storeName)["delete"](c);i.onsuccess=j,i.onerror=g}else if("put"==b){var k;null!==this.keyPath?(this._addIdPropertyIfNeeded(d),k=f.objectStore(this.storeName).put(d)):k=f.objectStore(this.storeName).put(d,c),k.onsuccess=j,k.onerror=g}},this),f},putBatch:function(a,b,c){var d=a.map(function(a){return{type:"put",value:a}});return this.batch(d,b,c)},upsertBatch:function(c,d,e,f){"function"==typeof d&&(e=d,f=e,d={}),f||(f=a),e||(e=b),d||(d={}),"[object Array]"!=Object.prototype.toString.call(c)&&f(new Error("dataArray argument must be of type Array."));var g=this.db.transaction([this.storeName],this.consts.READ_WRITE);g.oncomplete=function(){k?e(c):f(!1)},g.onabort=f,g.onerror=f;var h=d.keyField||this.keyPath,i=c.length,j=!1,k=!1,l=0,m=function(a){var b=c[l++];b[h]=a.target.result,i--,0!==i||j||(j=!0,k=!0)};return c.forEach(function(a){var b,c=a.key,d=function(a){g.abort(),j||(j=!0,f(a))};null!==this.keyPath?(this._addIdPropertyIfNeeded(a),b=g.objectStore(this.storeName).put(a)):b=g.objectStore(this.storeName).put(a,c),b.onsuccess=m,b.onerror=d},this),g},removeBatch:function(a,b,c){var d=a.map(function(a){return{type:"remove",key:a}});return this.batch(d,b,c)},getBatch:function(c,d,e,f){e||(e=a),d||(d=b),f||(f="sparse"),"[object Array]"!=Object.prototype.toString.call(c)&&e(new Error("keyArray argument must be of type Array."));var g=this.db.transaction([this.storeName],this.consts.READ_ONLY);g.oncomplete=function(){var a=k?d:e;a(l)},g.onabort=e,g.onerror=e;var h=[],i=c.length,j=!1,k=!1,l=null,m=function(a){a.target.result||"dense"==f?h.push(a.target.result):"sparse"==f&&h.length++,i--,0===i&&(j=!0,k=!0,l=h)};return c.forEach(function(a){var b=function(a){j=!0,l=a,e(a),g.abort()},c=g.objectStore(this.storeName).get(a);c.onsuccess=m,c.onerror=b},this),g},getAll:function(c,d){d||(d=a),c||(c=b);var e=this.db.transaction([this.storeName],this.consts.READ_ONLY),f=e.objectStore(this.storeName);return f.getAll?this._getAllNative(e,f,c,d):this._getAllCursor(e,f,c,d),e},_getAllNative:function(a,b,c,d){var e=!1,f=null;a.oncomplete=function(){var a=e?c:d;a(f)},a.onabort=d,a.onerror=d;var g=b.getAll();g.onsuccess=function(a){e=!0,f=a.target.result},g.onerror=d},_getAllCursor:function(a,b,c,d){var e=[],f=!1,g=null;a.oncomplete=function(){var a=f?c:d;a(g)},a.onabort=d,a.onerror=d;var h=b.openCursor();h.onsuccess=function(a){var b=a.target.result;b?(e.push(b.value),b["continue"]()):(f=!0,g=e)},h.onError=d},clear:function(c,d){d||(d=a),c||(c=b);var e=!1,f=null,g=this.db.transaction([this.storeName],this.consts.READ_WRITE);g.oncomplete=function(){var a=e?c:d;a(f)},g.onabort=d,g.onerror=d;var h=g.objectStore(this.storeName).clear();return h.onsuccess=function(a){e=!0,f=a.target.result},h.onerror=d,g},_addIdPropertyIfNeeded:function(a){this.features.hasAutoIncrement||"undefined"!=typeof a[this.keyPath]||(a[this.keyPath]=this._insertIdCount++ +Date.now())},getIndexList:function(){return this.store.indexNames},hasIndex:function(a){return this.store.indexNames.contains(a)},normalizeIndexData:function(a){a.keyPath=a.keyPath||a.name,a.unique=!!a.unique,a.multiEntry=!!a.multiEntry},indexComplies:function(a,b){var c=["keyPath","unique","multiEntry"].every(function(c){if("multiEntry"==c&&void 0===a[c]&&b[c]===!1)return!0;if("keyPath"==c&&"[object Array]"==Object.prototype.toString.call(b[c])){var d=b.keyPath,e=a.keyPath;if("string"==typeof e)return d.toString()==e;if("function"!=typeof e.contains&&"function"!=typeof e.indexOf)return!1;if(e.length!==d.length)return!1;for(var f=0,g=d.length;g>f;f++)if(!(e.contains&&e.contains(d[f])||e.indexOf(-1!==d[f])))return!1;return!0}return b[c]==a[c]});return c},iterate:function(b,c){c=g({index:null,order:"ASC",autoContinue:!0,filterDuplicates:!1,keyRange:null,writeAccess:!1,onEnd:null,onError:a,limit:1/0,offset:0},c||{});var d="desc"==c.order.toLowerCase()?"PREV":"NEXT";c.filterDuplicates&&(d+="_NO_DUPLICATE");var e=!1,f=this.db.transaction([this.storeName],this.consts[c.writeAccess?"READ_WRITE":"READ_ONLY"]),h=f.objectStore(this.storeName);c.index&&(h=h.index(c.index));var i=0;f.oncomplete=function(){return e?void(c.onEnd?c.onEnd():b(null)):void c.onError(null)},f.onabort=c.onError,f.onerror=c.onError;var j=h.openCursor(c.keyRange,this.consts[d]);return j.onerror=c.onError,j.onsuccess=function(a){var d=a.target.result;d?c.offset?(d.advance(c.offset),c.offset=0):(b(d.value,d,f),i++,c.autoContinue&&(i+c.offset<c.limit?d["continue"]():e=!0)):e=!0},f},query:function(a,b){var c=[];return b=b||{},b.autoContinue=!0,b.writeAccess=!1,b.onEnd=function(){a(c)},this.iterate(function(a){c.push(a)},b)},count:function(b,c){c=g({index:null,keyRange:null},c||{});var d=c.onError||a,e=!1,f=null,h=this.db.transaction([this.storeName],this.consts.READ_ONLY);h.oncomplete=function(){var a=e?b:d;a(f)},h.onabort=d,h.onerror=d;var i=h.objectStore(this.storeName);c.index&&(i=i.index(c.index));var j=i.count(c.keyRange);return j.onsuccess=function(a){e=!0,f=a.target.result},j.onError=d,h},makeKeyRange:function(a){var b,c="undefined"!=typeof a.lower,d="undefined"!=typeof a.upper,e="undefined"!=typeof a.only;switch(!0){case e:b=this.keyRange.only(a.only);break;case c&&d:b=this.keyRange.bound(a.lower,a.upper,a.excludeLower,a.excludeUpper);break;case c:b=this.keyRange.lowerBound(a.lower,a.excludeLower);break;case d:b=this.keyRange.upperBound(a.upper,a.excludeUpper);break;default:throw new Error('Cannot create KeyRange. Provide one or both of "lower" or "upper" value, or an "only" value.')}return b}};var f={},g=function(a,b){var c,d;for(c in b)d=b[c],d!==f[c]&&d!==a[c]&&(a[c]=d);return a};return e.version=e.prototype.version,e},this)},function(a,b){a.exports=moment},function(a,b,c){var d=c(62),e=c(2),f=c(66),g=c(68);a.exports=d.extend({name:"product",fields:["title"],schema:{price:"number",regular_price:"number",sale_price:"number",stock_quantity:"number"},initialize:function(){this.on({"change:updated_at":this.onUpdate})},onUpdate:function(){if("variable"===this.get("type")){var a=this.getVariations().superset();a.set(this.get("variations"))}},productAttributes:function(){return e.chain(this.get("attributes")).where({variation:!1}).where({visible:!0}).value()},productVariations:function(){return e.where(this.get("attributes"),{variation:!0})},matchMaker:function(a,b,c){var d=e.all(a,function(a){return"prefix"===a.type&&"barcode"===a.prefix&&a.query?this.barcodeMatch(a.query):"prefix"===a.type&&"cat"===a.prefix?(a.prefix="categories",b.prefix(a,this)):void 0},this);return d?d:c(a,this)},barcodeMatch:function(a){var b=this.get("type"),c=this.get("barcode").toLowerCase(),d=a.toString().toLowerCase();return c===d?("variable"!==b&&this.trigger("match:barcode",this),!0):"variable"!==b?this.partialBarcodeMatch(c,d):this.variableBarcodeMatch(c,d)},partialBarcodeMatch:function(a,b){return-1!==a.indexOf(b)?!0:!1},variableBarcodeMatch:function(a,b){var c;return this.getVariations().superset().each(function(a){var d=a.get("barcode").toLowerCase();return d===b?void(c=a):-1!==d.indexOf(b)?void(c="partial"):void 0;
}),c?("partial"!==c&&this.trigger("match:barcode",c,this),!0):this.partialBarcodeMatch(a,b)},getVariationOptions:function(){if(this._variationOptions)return this._variationOptions;var a=this.get("variations"),b=e.pluck(a,"attributes").reduce(function(a,b){return e.each(b,function(b){return a[b.name]?a[b.name].push(b.option):void(a[b.name]=[b.option])}),a},{});return this._variationOptions=e.map(b,function(a,b){return{name:b,options:e.uniq(a)}}),this._variationOptions},getVariations:function(){if("variable"!==this.get("type"))return!1;if(!this._variations){var a=new f(this.get("variations"),{parent:this});this._variations=new g(a)}return this._variations}})},function(a,b,c){var d=c(63),e=c(36),f=c(2),g=c(37)("dualModel");a.exports=e.DualModel=d.extend({idAttribute:"local_id",remoteIdAttribute:"id",fields:["title"],validate:function(a){var b={};a[this.idAttribute]&&(b[this.idAttribute]=parseInt(a[this.idAttribute],10)),a[this.remoteIdAttribute]&&(b[this.remoteIdAttribute]=parseInt(a[this.remoteIdAttribute],10)),this.set(b,{silent:!0})},url:function(){var a=this.get(this.remoteIdAttribute),b=f.result(this.collection,"url");return a?""+b+"/"+a+"/":b},states:{update:"UPDATE_FAILED",create:"CREATE_FAILED","delete":"DELETE_FAILED"},hasRemoteId:function(){return!!this.get(this.remoteIdAttribute)},isDelayed:function(){var a=this.get("status");return a===this.states.update||a===this.states.create||a===this.states["delete"]},sync:function(a,b,c){c=c||{};var e=f.clone(c);e.remote=void 0;var g="patch"===a?"update":a;return this.setStatus(g),d.prototype.sync.call(this,g,b,e).then(function(){return c.remote?b.remoteSync(a,b,c):void 0})},remoteSync:function(a,b,c){return b=b||this,c=c||{},c.remote=!0,a=a||b.getMethod(),d.prototype.sync.call(this,a,b,c).then(function(a){if(a){var c=b.parse(a);return b.merge(c)}})},setStatus:function(a){this.states[a]&&("update"!==a||this.hasRemoteId()||(a="create"),this.set({status:this.states[a]}))},getMethod:function(){var a=this.get("status"),b=f.findKey(this.states,function(b){return b===a});return b?b:void g("No method given for remote sync")},merge:function(a){return this.set(a),this.isDelayed()&&this.unset("status"),this.collection&&this.collection.db?this.collection.merge(this.toJSON()):void 0}})},function(a,b,c){var d=c(36),e=c(64),f=c(65);a.exports=d.DeepModel=e.extend(f)},function(a,b,c){var d=c(45),e=c(36),f=c(2),g={"float":parseFloat,"int":parseInt,number:function(a){return a=Number(a),f.isNaN(a)?0:a}};a.exports=e.Model=d.Model.extend({constructor:function(){d.Model.apply(this,arguments)},parse:function(a){var b=a&&a[this.name]?a[this.name]:a;if(b)return f.each(this.schema,function(a,c){f.has(b,c)&&f.isString(a)&&g[a]&&(b[c]=g[a](b[c]))},this),b}})},function(a,b,c){function d(a){var b={},c=i.keyPathSeparator;for(var e in a){var f=a[e];if(!f||f.constructor!==Object&&f.constructor!==Array||h.isEmpty(f))b[e]=f;else{var g=d(f);for(var j in g){var k=g[j];b[e+c+j]=k}}}return b}function e(a,b,c){for(var d=i.keyPathSeparator,e=b?b.split(d):[],f=a,g=0,j=e.length;j>g;g++){if(c&&!h.has(f,e[g]))return!1;if(f=f[e[g]],null==f&&j-1>g&&(f={}),"undefined"==typeof f)return c?!0:f}return c?!0:f}function f(a,b,c,d){d=d||{};for(var e=i.keyPathSeparator,f=b?b.split(e):[],g=a,j=0,k=f.length;k>j&&void 0!==g;j++){var l=f[j];if(j===k-1)d.unset?delete g[l]:g[l]=c;else{if("undefined"==typeof g[l]||!h.isObject(g[l])){if(d.unset)return void delete g[l];var m=f[j+1];g[l]=/^\d+$/.test(m)?[]:{}}g=g[l]}}}function g(a,b){f(a,b,null,{unset:!0})}var h=c(2),i={constructor:function(a,b){var c=a||{};this.cid=h.uniqueId("c"),this.attributes={},b&&b.collection&&(this.collection=b.collection),b&&b.parse&&(c=this.parse(c,b)||{}),c=h.merge({},h.result(this,"defaults"),c),this.set(c,b),this.changed={},this.initialize.apply(this,arguments)},toJSON:function(a){return h.merge({},this.attributes)},get:function(a){return e(this.attributes,a)},set:function(a,b,c){var j,k,l,m,n,o,p,q;if(null==a)return this;if("object"==typeof a?(k=a,c=b||{}):(k={})[a]=b,c||(c={}),!this._validate(k,c))return!1;l=c.unset,n=c.silent,m=[],o=this._changing,this._changing=!0,o||(this._previousAttributes=h.merge({},this.attributes),this.changed={}),q=this.attributes,p=this._previousAttributes,this.idAttribute in k&&(this.id=k[this.idAttribute]),k=d(k);for(j in k)b=k[j],h.isEqual(e(q,j),b)||m.push(j),h.isEqual(e(p,j),b)?g(this.changed,j):f(this.changed,j,b),l?g(q,j):f(q,j,b);if(!n){m.length&&(this._pending=!0);for(var r=i.keyPathSeparator,s={},t=0,u=m.length;u>t;t++){var a=m[t];s.hasOwnProperty(a)&&s[a]||(s[a]=!0,this.trigger("change:"+a,this,e(q,a),c));for(var v=a.split(r),w=v.length-1;w>0;w--){var x=v.slice(0,w).join(r),y=x+r+"*";s.hasOwnProperty(y)&&s[y]||(s[y]=!0,this.trigger("change:"+y,this,e(q,x),c)),s.hasOwnProperty(x)&&s[x]||(s[x]=!0,this.trigger("change:"+x,this,e(q,x),c))}}}if(o)return this;if(!n)for(;this._pending;)this._pending=!1,this.trigger("change",this,c);return this._pending=!1,this._changing=!1,this},clear:function(a){var b={},c=d(this.attributes);for(var e in c)b[e]=void 0;return this.set(b,h.extend({},a,{unset:!0}))},hasChanged:function(a){return null==a?!h.isEmpty(this.changed):void 0!==e(this.changed,a)},changedAttributes:function(a){if(!a)return this.hasChanged()?d(this.changed):!1;var b=this._changing?this._previousAttributes:this.attributes;a=d(a),b=d(b);var c,e=!1;for(var f in a)h.isEqual(b[f],c=a[f])||((e||(e={}))[f]=c);return e},previous:function(a){return null!=a&&this._previousAttributes?e(this._previousAttributes,a):null},previousAttributes:function(){return h.merge({},this._previousAttributes)}};i.keyPathSeparator=".",a.exports=i},function(a,b,c){var d=c(57),e=c(67),f=c(41),g=c(2);a.exports=d.extend({model:e,url:function(){var a=f.request("entities","get",{type:"option",name:"wc_api"});return a+"products"},initialize:function(){this._isNew=!1},compact:function(a){for(var b=-1,c=a?a.length:0,d=-1,e=[];++b<c;){var f=a[b];(0===f||f)&&(e[++d]=f)}return e},range:function(a){var b=this.compact(this.pluck(a)),c=0,d=0;return g.isEmpty(b)||(c=g(b).min(),d=g(b).max()),g.uniq([c,d])}})},function(a,b,c){var d=c(63);a.exports=d.extend({name:"product",defaults:{type:"variation"},schema:{price:"number",regular_price:"number",sale_price:"number",stock_quantity:"number"},initialize:function(a,b){b=b||{},this.parent=b.parent,this.set({title:b.parent.get("title")})},save:function(a,b){var c=this;return d.prototype.save.call(this,a,b).then(function(){c.parent.set({variations:c.collection.toJSON()}),c.parent.merge()})}})},function(a,b,c){function d(a,b){this._superset=a,this._filtered=new g(a,b),this._sorted=new h(this._filtered,b),this._paginated=new i(this._sorted,b),j(this._paginated,this),k.call(this,this._filtered,o),k.call(this,this._sorted,q),k.call(this,this._paginated,s),this.initialize(b)}var e=c(2),f=c(45),g=c(69),h=c(72),i=c(74),j=c(70),k=c(75),l=c(76);e.extend(g.prototype,l);var m={superset:function(){return this._superset},getFilteredLength:function(){return this._filtered.length},removeTransforms:function(){return this._filtered.resetFilters(),this._sorted.removeSort(),this._paginated.removePagination(),this},destroy:function(){this.stopListening(),this._filtered.destroy(),this._sorted.destroy(),this._paginated.destroy(),this.length=0,this.trigger("obscura:destroy")}},n=["filterBy","removeFilter","resetFilters","refilter","hasFilter","getFilters","query","getQuery","getTokens","getRemoteFilter"],o=["filtered:add","filtered:remove","filtered:reset"],p=["setSort","reverseSort","removeSort"],q=["sorted:add","sorted:remove"],r=["setPerPage","setPage","getPerPage","getNumPages","getPage","hasNextPage","hasPrevPage","nextPage","prevPage","movePage","removePagination","firstPage","lastPage","appendNextPage"],s=["paginated:change:perPage","paginated:change:page","paginated:change:numPages"],t=["add","create","remove","set","reset","sort","parse","sync","fetch","push","pop","shift","unshift"];e.each(n,function(a){m[a]=function(){var b=g.prototype[a].apply(this._filtered,arguments);return b===this._filtered?this:b}}),e.each(r,function(a){m[a]=function(){var b=i.prototype[a].apply(this._paginated,arguments);return b===this._paginated?this:b}}),e.each(p,function(a){m[a]=function(){var b=h.prototype[a].apply(this._sorted,arguments);return b===this._sorted?this:b}}),e.each(t,function(a){m[a]=function(){throw new Error("Backbone.Obscura: Unsupported method: "+a+"called on read-only proxy")}}),e.extend(d.prototype,m,f.Events),d=f.Collection.extend(d.prototype),d.FilteredCollection=g,d.SortedCollection=h,d.PaginatedCollection=i,a.exports=d},function(a,b,c){function d(){this._filterResultCache={}}function e(a){for(var b in this._filterResultCache)this._filterResultCache.hasOwnProperty(b)&&delete this._filterResultCache[b][a]}function f(a,b){this._filters[a]&&e.call(this,a),this._filters[a]=b,this.trigger("filtered:add",a)}function g(a){delete this._filters[a],delete this._query,delete this._tokens,e.call(this,a),this.trigger("filtered:remove",a)}function h(a){this._filterResultCache[a.cid]||(this._filterResultCache[a.cid]={});var b=this._filterResultCache[a.cid];for(var c in this._filters)if(this._filters.hasOwnProperty(c)&&(b.hasOwnProperty(c)||(b[c]=this._filters[c].fn(a)),!b[c]))return!1;return!0}function i(){var a=[];this._superset&&(a=this._superset.filter(o.bind(h,this))),this._collection.reset(a),this.length=this._collection.length}function j(a){if(this._filterResultCache[a.cid]={},h.call(this,a)){if(!this._collection.get(a.cid)){for(var b=this.superset().indexOf(a),c=null,d=b-1;d>=0;d-=1)if(this.contains(this.superset().at(d))){c=this.indexOf(this.superset().at(d))+1;break}c=c||0,this._collection.add(a,{at:c})}}else this._collection.get(a.cid)&&this._collection.remove(a);this.length=this._collection.length}function k(a){this._filterResultCache[a.cid]={},h.call(this,a)||this._collection.get(a.cid)&&this._collection.remove(a)}function l(a,b,c){"change:"===a.slice(0,7)&&k.call(this,arguments[1])}function m(a){this.contains(a)&&this._collection.remove(a),this.length=this._collection.length}function n(a){this._superset=a,this._collection=new p.Collection(a.toArray()),q(this._collection,this),this.resetFilters(),this.listenTo(this._superset,"reset sort",i),this.listenTo(this._superset,"add change",j),this.listenTo(this._superset,"remove",m),this.listenTo(this._superset,"all",l)}var o=c(2),p=c(45),q=c(70),r=c(71),s={defaultFilterName:"__default",filterBy:function(a,b){return b||(b=a,a=this.defaultFilterName),f.call(this,a,r(b)),i.call(this),this},removeFilter:function(a){return a||(a=this.defaultFilterName),g.call(this,a),i.call(this),this},resetFilters:function(){return this._filters={},d.call(this),this.trigger("filtered:reset"),i.call(this),this},superset:function(){return this._superset},refilter:function(a){return"object"==typeof a&&a.cid?j.call(this,a):(d.call(this),i.call(this)),this},getFilters:function(){return o.keys(this._filters)},hasFilter:function(a){return o.contains(this.getFilters(),a)},destroy:function(){this.stopListening(),this._collection.reset([]),this._superset=this._collection,this.length=0,this.trigger("filtered:destroy")}};o.extend(n.prototype,s,p.Events),a.exports=n},function(a,b,c){function d(a,b){function c(){b.length=a.length}function d(c){var d=e.toArray(arguments),f="change"===c||"change:"===c.slice(0,7);"reset"===c&&(b.models=a.models),e.contains(h,c)?(e.contains(["add","remove","destroy"],c)?d[2]=b:e.contains(["reset","sort"],c)&&(d[1]=b),b.trigger.apply(this,d)):f&&b.contains(d[1])&&b.trigger.apply(this,d)}var i={};return e.each(e.functions(f.Collection.prototype),function(b){e.contains(g,b)||(i[b]=function(){return a[b].apply(a,arguments)})}),e.extend(b,f.Events,i),b.listenTo(a,"all",c),b.listenTo(a,"all",d),b.models=a.models,c(),b}var e=c(2),f=c(45),g=["_onModelEvent","_prepareModel","_removeReference","_reset","add","initialize","sync","remove","reset","set","push","pop","unshift","shift","sort","parse","fetch","create","model","off","on","listenTo","listenToOnce","bind","trigger","once","stopListening"],h=["add","remove","reset","sort","destroy","sync","request","error"];a.exports=d},function(a,b,c){function d(a,b){return function(c){return c.get(a)===b}}function e(a,b){return function(c){return b(c.get(a))}}function f(a,b){return i.isArray(b)||(b=null),{fn:a,keys:b}}function g(a){var b=i.keys(a),c=i.map(b,function(b){var c=a[b];return i.isFunction(c)?e(b,c):d(b,c)}),g=function(a){for(var b=0;b<c.length;b++)if(!c[b](a))return!1;return!0};return f(g,b)}function h(a,b){return i.isFunction(a)?f(a,b):i.isObject(a)?g(a):void 0}var i=c(2);a.exports=h},function(a,b,c){function d(a){return k.isFunction(a)?a:function(b){return b.get(a)}}function e(a){return this._comparator?n(this._collection.models,a,d(this._comparator),this._reverse):this._superset.indexOf(a)}function f(a){var b=e.call(this,a);this._collection.add(a,{at:b})}function g(a){this.contains(a)&&this._collection.remove(a)}function h(a){this.contains(a)&&this._collection.indexOf(a)!==e.call(this,a)&&(this._collection.remove(a),f.call(this,a))}function i(){if(!this._comparator)return void this._collection.reset(this._superset.toArray());var a;a=k.isString(this._comparator)||1===this._comparator.length?this._superset.sortBy(this._comparator):this._superset.models.sort(this._comparator),this._collection.reset(this._reverse?a.reverse():a)}function j(a){this._superset=a,this._reverse=!1,this._comparator=null,this._collection=new l.Collection(a.toArray()),m(this._collection,this),this.listenTo(this._superset,"add",f),this.listenTo(this._superset,"remove",g),this.listenTo(this._superset,"change",h),this.listenTo(this._superset,"reset",i)}var k=c(2),l=c(45),m=c(70),n=c(73),o={setSort:function(a,b){return this._reverse="desc"===b?!0:!1,this._comparator=a,i.call(this),a?this.trigger("sorted:add"):this.trigger("sorted:remove"),this},reverseSort:function(){return this._reverse=!this._reverse,i.call(this),this},removeSort:function(){return this.setSort(),this},superset:function(){return this._superset},destroy:function(){this.stopListening(),this._collection.reset([]),this._superset=this._collection,this.length=0,this.trigger("sorted:destroy")}};k.extend(j.prototype,o,l.Events),a.exports=j},function(a,b,c){function d(a,b){return function(c,d){var e=a(c),f=a(d);return e===f?0:b?f>e?1:-1:f>e?-1:1}}function e(a,b){return 2===a.length?a:d(a,b)}function f(a,b,c,d){c=null===c?g.identity:e(c,d);for(var f=0,h=a.length;h>f;){var i=f+h>>>1;c(a[i],b)<0?f=i+1:h=i}return f}var g=c(2);a.exports=f},function(a,b,c){function d(){if(this._infinite)var a=0,b=this._collection.length;else var a=this.getPage()*this.getPerPage(),b=a+this.getPerPage();return[a,b]}function e(){var a=d.call(this);return this._collection.reset(this.superset().slice(a[0],a[1]))}function f(){var a=0,b=this._collection.length+this.getPerPage();return this._collection.add(this.superset().slice(a,b))}function g(){var a=this.getPerPage(),b=this.superset().length-this._collection.length,c=b%a===0?b/a:Math.floor(b/a)+1;return c+1}function h(){var a=this.superset().length,b=this.getPerPage(),c=a%b===0?a/b:Math.floor(a/b)+1,d=this._totalPages!==c;return this._totalPages=c,d&&this.trigger("paginated:change:numPages",{numPages:c}),this.getPage()>=c?(this.setPage(c-1),!0):void 0}function i(){this._infinite=!1,h.call(this)||e.call(this)}function j(a,b){for(var c=m.max([a.length,b.length]),d=0,e=0;c>d;d+=1,e+=1)if(a[d]!==b[e])if(b[d-1]===a[d])e-=1;else{if(b[d+1]!==a[d])return a[d];e+=1}}function k(a,b,c){if(!h.call(this)){var e,f=d.call(this),g=f[0],i=f[1],k=j(this.superset().slice(g,i),this._collection.toArray()),l=this._infinite&&c.add;l||(e=j(this._collection.toArray(),this.superset().slice(g,i))),e&&this._collection.remove(e),k&&this._collection.add(k,{at:this.superset().indexOf(k)-g})}}function l(a,b){this._superset=a,this._collection=new n.Collection(a.toArray()),this._page=0,this.setPerPage(b&&b.perPage?b.perPage:null),o(this._collection,this),this.listenTo(this._superset,"add remove",k),this.listenTo(this._superset,"reset sort",i)}var m=c(2),n=c(45),o=c(70),p={removePagination:function(){return this._infinite=!1,this.setPerPage(null),this},setPerPage:function(a){return this._perPage=a,i.call(this),this.setPage(0),this.trigger("paginated:change:perPage",{perPage:a,numPages:this.getNumPages()}),this},setPage:function(a){this._infinite=!1;var b=0,c=this.getNumPages()-1;return a=a>b?a:b,a=c>a?a:c,a=0>a?0:a,this._page=a,e.call(this),this.trigger("paginated:change:page",{page:a}),this},getPerPage:function(){return this._perPage||this.superset().length||1},getNumPages:function(){return this._infinite?g.call(this):this._totalPages},getPage:function(){return this._page},hasNextPage:function(){return this.getPage()<this.getNumPages()-1},hasPrevPage:function(){return this.getPage()>0},nextPage:function(){return this.movePage(1),this},prevPage:function(){return this.movePage(-1),this},firstPage:function(){this.setPage(0)},lastPage:function(){this.setPage(this.getNumPages()-1)},movePage:function(a){return this.setPage(this.getPage()+a),this},superset:function(){return this._superset},destroy:function(){this.stopListening(),this._collection.reset([]),this._superset=this._collection,this._page=0,this._totalPages=0,this.length=0,this._infinite=!1,this.trigger("paginated:destroy")},appendNextPage:function(){return this._infinite=!0,f.call(this),this.trigger("paginated:change:page",{page:0}),this}};m.extend(l.prototype,p,n.Events),a.exports=l},function(a,b,c){function d(a,b){e.each(b,function(b){this.listenTo(a,b,function(){var a=e.toArray(arguments);a.unshift(b),this.trigger.apply(this,a)})},this)}var e=c(2);a.exports=d},function(a,b,c){var d=c(2),e=c(77);a.exports={query:function(a,b){return d.isUndefined(b)&&(b=a,a="search"),this._query=b,""===b?this.removeFilter(a):this.filterBy(a,d.bind(e,this,b))},getQuery:function(){return this._query},getTokens:function(){return this._tokens},getRemoteFilter:function(){if(this._tokens){var a={not_in:this.pluck("id").join(",")};return d.each(this._tokens,function(b){"string"===b.type&&(a.q=b.query),"prefix"===b.type&&(a[b.prefix]=b.query)}),a}}}},function(a,b,c){function d(a){return{}.toString.call(a).match(/\s([a-z|A-Z]+)/)[1].toLowerCase()}function e(a,b){return f.all(a,function(a){return i[a.type](a,b)})}var f=c(2),g=c(78),h=new g,i={string:function(a,b){if(a=a||{},!f.isString(a.query))return!1;var c=f.chain(b.fields||["title"]).map(function(a){return b.get(a)}).compact().value();return f.any(c,function(b){return this._partialString(b,a.query.toLowerCase())},this)},prefix:function(a,b){if(a=a||{},!f.isString(a.query))return!1;var c=b.get(a.prefix),e=d(c);return this.hasOwnProperty("_"+e)?this["_"+e](c,a.query.toLowerCase()):void 0},or:function(a,b){return f.any(a.queries,function(a){return this[a.type](a,b)},this)},_string:function(a,b){return a.toLowerCase()===b},_partialString:function(a,b){return-1!==a.toLowerCase().indexOf(b)},_number:function(a,b){return a.toString()===b},_partialNumber:function(a,b){return-1!==a.toString().indexOf(b)},_boolean:function(a,b){return"true"===b?a===!0:"false"===b?a===!1:!1},_array:function(a,b){return f.any(a,function(a){return a.toLowerCase()===b})}};a.exports=function(a,b){var c=f.isArray(a)?a:h.parse(a);return this._tokens=c,b.matchMaker?b.matchMaker(c,i,e):e(c,b)}},function(a,b,c){function d(a){this.options=a||{}}function e(a){var b;return j.any(["SCREEN","OR_OPEN","OR_CLOSE","GROUP_OPEN","GROUP_CLOSE","OR","PREFIX","SPACES","QUOTES","FLAGS"],function(c){return k[c].test(a)?(b=c,!0):(b=void 0,!1)}),b}function f(a){var b=a.pop(),c=a.pop();a.push({type:"or",queries:[c,b]})}function g(a){var b=a.part||{};a.hasarg&&(["range","prange"].indexOf(b.type)>=0?b.to=a.buffer:a.buffer&&a.buffer.length&&(b.query=a.buffer),b.type||(b.type=b.prefix?"prefix":"string"),a.parts.push(b),a.or_at_next_arg&&a.or_at_next_arg+1===a.parts.length&&(f(a.parts),a.or_at_next_arg=0),a.part={},a.buffer="",a.hasarg=!1)}function h(a,b){0!==this._input.length&&(a.character=this._input.shift(),a.character===b?g.call(this,a):(a.buffer+=a.character,a.hasarg=!0,h.call(this,a,b)))}function i(a){a.character=this._input.shift();var b=e.call(this,a.character);return b&&!a.screen?l[b.toLowerCase()].call(this,a):(a.buffer+=a.character,a.hasarg=!0,a.screen=!1),this._input.length>0&&!a.close?void i.call(this,a):void(a.close=void 0)}var j=c(2),k={QUOTES:/['"`]/,SPACES:/[ \t\r\n]/,FLAGS:/[~\+#!\*\/]/,SCREEN:/[\\]/,GROUP_OPEN:/\(/,GROUP_CLOSE:/\)/,OR:/\|/,PREFIX:/:/,RANGE:/-/,OR_OPEN:/\[/,OR_CLOSE:/]/},l={screen:function(a){a.screen=!0},or_open:function(a){a.hasarg?a.buffer+=a.character:(a.part.type="or",a.part.queries=this.parse(this._input.join(""),!0),a.part.queries&&a.part.queries.length&&(a.hasarg=!0,g.call(this,a)))},or_close:function(a){a.close=!0},group_open:function(a){a.hasarg?a.buffer+=a.character:(a.part.type="and",a.part.queries=this.parse(this._input.join(""),!0),a.part.queries&&a.part.queries.length&&(a.hasarg=!0,g.call(this,a)))},group_close:function(a){a.open?(a.close=!0,a.open=void 0):a.buffer+=a.character},or:function(a){a.or_at_next_arg=a.parts.length,a.hasarg&&(a.or_at_next_arg+=1,g.call(this,a))},prefix:function(a){a.part.prefix=a.buffer,a.part.type="prefix",a.buffer="",a.hasarg=!0},range:function(a){a.part.type&&"prefix"===a.part.type?a.part.type="prange":a.part.type="range",a.part.from=a.buffer,a.buffer="",a.hasarg=!0},spaces:function(a){g.call(this,a)},quotes:function(a){a.buffer.length?(a.buffer+=a.character,a.hasarg=!0):h.call(this,a,a.character)},flags:function(a){a.buffer.length?a.buffer+=a.character:(a.part.flags||(a.part.flags=[]),a.part.flags.push(a.character))}},m={parse:function(a,b){var c={parts:[],part:{},open:b,buffer:"",hasarg:!1};return a&&a.length&&"string"==typeof a?(this._input=a.split(""),i.call(this,c),g.call(this,c),c.parts):c.parts}};j.extend(d.prototype,m),a.exports=d},function(a,b,c){var d=c(55),e=c(80),f=c(40),g=c(2),h=c(45);a.exports=d.extend({model:e,name:"orders",_syncDelayed:!1,setActiveOrder:function(a){var b=this.get(a);return b||"new"===a||(b=g.first(this.openOrders())),this.active=b,b},getActiveOrder:function(){var a=this,b=new f.Deferred;return this.active?b.resolve(this.active):this.create().then(function(c){c.cart.order_id=c.id,a.active=c,"cart/new"===h.history.getHash()&&h.history.navigate("cart/"+c.id),b.resolve(c)}),b.promise()},addToCart:function(a){this.getActiveOrder().then(function(b){b.cart.addToCart(a)})},create:function(){var a=new f.Deferred;return d.prototype.create.call(this,{local_id:Date.now()},{wait:!0,success:a.resolve,error:a.reject}),a.promise()},openOrders:function(){return this.filter(function(a){return a.isEditable()})}})},function(a,b,c){var d=c(62),e=c(41),f=c(81),g=c(37)("order"),h=c(36),i=c(40),j=d.extend({name:"order",fields:["customer.first_name","customer.last_name","customer.email"],defaults:function(){var a=this.getEntities("customers"),b=a["default"]||a.guest||{};return{note:"",order_discount:0,customer_id:b.id,customer:b}},initialize:function(){this.tax=this.getEntities("tax"),this.tax_rates=this.getEntities("tax_rates"),this.isEditable()&&(this.attachCart(),this.attachGateways()),this.on({"change:order_discount":this.calcTotals,"change:status":this.isEditable})},getEntities:function(a){return e.request("entities","get",{type:"option",name:a})||{}},isEditable:function(){return void 0===this.get("status")||this.isDelayed()},destroy:function(a){var b=this;return this.cart.db.removeBatch(this.cart.pluck("local_id")).always(function(){return d.prototype.destroy.call(b,a)})},attachCart:function(){var a=e.request("entities","get",{init:!0,type:"collection",name:"cart"});a.order_id=this.id,this.listenTo(a,{"add change":this.calcTotals,remove:this.itemRemoved}),a.db&&a.db.open().then(function(){a.fetchCartItems()}),this.cart=a},clearCart:function(){this.cart&&this.cart.db.removeBatch(this.cart.pluck("local_id"))},attachGateways:function(){this.gateways=e.request("entities","get",{init:!0,type:"collection",name:"gateways"}),this.gateways.fetch()},itemRemoved:function(){return this.cart.length>0?this.calcTotals():this.destroy()},calcTotals:function(){var a=0,b=0,c=0,d=0,e=this.cart.sum("subtotal"),h=this.cart.sum("total"),i=e-h,j=this.get("order_discount");"yes"===this.tax.calc_taxes&&(a=this.cart.sum("total_tax"),b=this.cart.sum("subtotal_tax"),c=this.cart.sum("total_tax","shipping"),d=b-a),h+=a,h-=j,this.unset("tax_lines",{silent:!0});var k={total:f.round(h,4),subtotal:f.round(e,4),total_tax:f.round(a,4),subtotal_tax:f.round(b,4),shipping_tax:f.round(c,4),cart_discount:f.round(i,4),cart_discount_tax:f.round(d,4),tax_lines:this.cart.itemizedTax()};this.save(k),g("update totals",k)},sum:function(a){for(var b=0,c=0;c<a.length;c++)b+=parseFloat(this.get(a[c]));return b},process:function(){var a=this;return i.when(this.processCart()).then(function(){return a.processGateway()}).then(function(){var b=a.get("id")?"update":"create";return a.remoteSync(b)}).then(function(a){var b=a[0];"failed"===b.get("status")&&b.save({status:"UPDATE_FAILED"})})},processCart:function(){var a={product:[],shipping:[],fee:[]};this.cart.each(function(b){var c=b.get("type");"shipping"!==c&&"fee"!==c&&(c="product"),a[c].push(b.toJSON())}),this.set({line_items:a.product,shipping_lines:a.shipping,fee_lines:a.fee,tax_lines:this.cart.itemizedTax()})},processGateway:function(){var a=this.gateways.findWhere({active:!0}).toJSON();this.set({payment_details:a})}});a.exports=j,h.attach("Entities.Order.Model",j)},function(a,b,c){var d=c(48),e=c(36),f=c(2),g={};g.round=function(a,b,c){f.isFinite(parseInt(b,10))||(b=d.settings.currency.precision);var e,g,h,i;if(e=Math.pow(10,b),a*=e,i=a>0|-(0>a),h=a%1===.5*i,g=Math.floor(a),h)switch(c){case"2":case"PHP_ROUND_HALF_DOWN":a=g+(0>i);break;case"3":case"PHP_ROUND_HALF_EVEN":a=g+g%2*i;break;case"4":case"PHP_ROUND_HALF_ODD":a=g+!(g%2);break;default:a=g+(i>0)}return(h?a:Math.round(a))/e},g.decimalPlaces=function(a){return(+a).toFixed(4).replace(/^-?\d*\.?|0+$/g,"").length},g.unformat=function(a){return d.unformat(a,d.settings.number.decimal)},g.formatNumber=function(a,b){return"auto"===b&&(b=g.decimalPlaces(a)),f.isFinite(parseInt(b,10))||(b=d.settings.currency.precision),d.formatNumber(a,b)},g.formatMoney=function(a,b){return"auto"===b&&(b=g.decimalPlaces(a)),f.isFinite(parseInt(b,10))||(b=d.settings.currency.precision),a=g.round(a,b),d.formatMoney(a)},g.isPositiveInteger=function(a,b){var c=~~Number(a);return b?String(c)===a&&c>=0:String(c)===a&&c>0},g.parseErrorResponse=function(a){var b=a.responseJSON;return b.errors?b.errors[0].message:a.responseText},g.toType=function(a){return{}.toString.call(a).match(/\s([a-z|A-Z]+)/)[1].toLowerCase()},a.exports=e.Utils=g},function(a,b,c){var d=c(56),e=c(83),f=c(2),g=c(45);a.exports=d.extend({model:e,name:"cart",indexes:[{name:"local_id",keyPath:"local_id",unique:!0},{name:"order",keyPath:"order",unique:!1},{name:"type",keyPath:"type",unique:!1}],productAttributes:["order","title","local_id","product_id","type","price","regular_price","sale_price","taxable","tax_status","tax_class","attributes","meta","method_title","method_id"],comparator:function(a){var b=a.get("type");return"fee"===b?2:"shipping"===b?1:0},fetchCartItems:function(){if(this.order_id){var a=this.add.bind(this),b=this.db.store.makeKeyRange({only:this.order_id});this.db.store.query(a,{index:"order",keyRange:b})}},sum:function(a,b){var c=this.toJSON();return b&&(c=f.where(c,{type:b})),f.pluck(c,a).reduce(function(a,b){return a+b},0)},addToCart:function(a){a=a||{};var b,c=a.model||a;c instanceof g.Model&&(c=c.toJSON()),c.id&&(b=this.findWhere({product_id:c.id}),c.product_id=c.id,delete c.id),b?b.quantity("increase"):b=this._addToCart(c),b.trigger("pulse")},_addToCart:function(a){return a.order=this.order_id,"variation"===a.type&&(a.meta=f.map(a.attributes,function(a,b){return{key:++b,label:a.name,value:a.option}})),this.add(f.pick(a,this.productAttributes))},itemizedTax:function(){var a=f.clone(this.toJSON(),!0),b=f.map(a,function(a){return a.tax?(f.each(a.tax,function(b){b.shipping="shipping"===a.type?b.total:0}),a.tax):void 0}),c=this.sumTaxes(b),d=[];return f.each(c,function(a,b){a.rate_id=b.toString(),d.push(a)}),d},sumTaxes:function(a){return f.reduce(a,function(a,b){return f.merge(a,b,function(a,b){return a&&(b.total+=a.total,b.subtotal+=a.subtotal,b.shipping+=a.shipping),b})},{})}})},function(a,b,c){var d=c(64),e=c(37)("cartItem"),f=c(81),g=c(2),h=c(41);a.exports=d.extend({idAttribute:"local_id",defaults:{subtotal:0,subtotal_tax:0,total_tax:0,total:0,item_tax:0,quantity:1,taxable:!0,tax_class:""},initialize:function(){if(this.tax=h.request("entities","get",{type:"option",name:"tax"})||{},this.tax_rates=h.request("entities","get",{type:"option",name:"tax_rates"})||{},this.on("change:quantity change:item_price change:regular_price change:taxable change:tax_class",this.updateLineTotals),void 0===this.get("item_price")){var a=parseFloat(this.get("price"));this.set({item_price:g.isNaN(a)?0:a})}},updateLineTotals:function(){var a,b,c,d=this.get("quantity"),h=this.get("item_price"),i=this.get("type"),j=parseFloat(this.get("regular_price")),k=this.get("tax_class");this.tax_rates[k]&&(c=g.cloneDeep(this.tax_rates[k])),("shipping"===i||"fee"===i)&&(j=h),a=this.calcTax({price:h,quantity:d,rates:c}),b=this.calcTax({price:j,quantity:d,rates:c,subtotal:!0}),"yes"===this.tax.prices_include_tax&&(j-=b,h-=a);var l={item_subtotal:f.round(j,4),item_subtotal_tax:f.round(b,4),item_tax:f.round(a,4),subtotal:f.round(j*d,4),subtotal_tax:f.round(b*d,4),total_tax:f.round(a*d,4),total:f.round(h*d,4)};this.save(l),e("update totals",l)},calcTax:function(a){var b=0;return"yes"===this.tax.calc_taxes&&this.get("taxable")&&a.rates?b="yes"===this.tax.prices_include_tax?this.calcInclusiveTax(a):this.calcExclusiveTax(a):this.set("tax",void 0),b},calcInclusiveTax:function(a){var b=0,c=0,d=0,e=0,h=0,i=a.price,j=a.rates,k=a.quantity;g.each(j,function(a,d){return"shipping"===this.get("type")&&"no"===a.shipping?void delete j[d]:void("yes"===a.compound?c+=parseFloat(a.rate):b+=parseFloat(a.rate))},this);var l=1+b/100,m=1+c/100;return d=i/m,g.each(j,function(b){var c=parseFloat(b.rate)/100,g=0;"yes"===b.compound?(g=i,c/=m):(g=d,c/=l);var j=i-c*g;e=i-j;var n=a.subtotal?"subtotal":"total";b[n]=f.round(e*k,4),h+=e},this),g.isEmpty(j)||this.set("tax",j),h},calcExclusiveTax:function(a){var b=[],c=0,d=0,e=0,h=a.price,i=a.rates,j=a.quantity;return g.each(i,function(a,c){return d=0,"shipping"===this.get("type")&&"no"===a.shipping?void delete i[c]:("yes"!==a.compound&&(d=h*(parseFloat(a.rate)/100)),void(b[c]=d))},this),b.length>0&&(c=b.reduce(function(a,b){return a+b})),g.each(i,function(d,g){if("yes"===d.compound){var i=h+c;b[g]=i*(parseFloat(d.rate)/100)}var k=a.subtotal?"subtotal":"total";d[k]=f.round(b[g]*j,4),e+=b[g]},this),g.isEmpty(i)||this.set("tax",i),e},quantity:function(a){var b=this.get("quantity");return this.set("quantity","increase"===a?++b:--b),this},sum:function(a){for(var b=0,c=0;c<a.length;c++)b+=this.get(a[c]);return f.round(b,4)}})},function(a,b,c){var d=c(57),e=c(85),f=c(41);a.exports=d.extend({model:e,name:"customers",url:function(){var a=f.request("entities","get",{type:"option",name:"wc_api"});return a+"customers"},initialize:function(){var a=f.request("entities","get",{type:"option",name:"customers"});a&&(this._guest=a.guest,this._default=a["default"]||a.guest)}})},function(a,b,c){var d=c(64);a.exports=d.extend({name:"customer"})},function(a,b,c){var d=c(57),e=c(87);a.exports=d.extend({model:e})},function(a,b,c){var d=c(64);a.exports=d.extend({})},function(a,b,c){var d=c(63),e=c(41),f=c(49);a.exports=d.extend({initialize:function(){this.url=e.request("entities","get",{type:"option",name:"ajaxurl"})},sync:function(a,b,c){var f=e.request("entities","get",{type:"option",name:"nonce"}),g="id="+b.get("id"),h="action=wc_pos_admin_settings",i="security="+f;return c.url=this.url+"?"+h+"&"+g+"&"+i,c.buttons&&this.updateButtonState(c),d.prototype.sync(a,b,c)},parse:function(a){return a||(a=null),a},updateButtonState:function(a){
var b=a.success,c=a.error,d=a.buttons;d.trigger("state",["loading",""]),a.success=function(a,c,e){b&&b(a,c,e),d.trigger("state",["success",null])},a.error=function(a,b,e){c&&c(a,b,e);var g=null;a.status&&405===a.status&&(g=f.t("messages.legacy")+'. <a href="#tools">'+f.t("buttons.legacy")+"</a>."),!g&&a.responseJSON&&a.responseJSON.errors&&(g=a.responseJSON.errors[0].message),d.trigger("state",["error",g])}},destroy:function(a){var b=this;return this.sync("delete",this,a).then(function(a){a.id=b.id,b.clear({silent:!0}).set(a)})}})},function(a,b,c){var d=c(57),e=c(88);a.exports=d.extend({model:e})},function(a,b,c){var d=c(57),e=c(91),f=c(40),g=[];f(".tmpl-checkout-gateways").each(function(){g.push({method_id:f(this).data("gateway"),method_title:f(this).data("title"),icon:f(this).data("icon"),active:1===f(this).data("default")})}),a.exports=d.extend({model:e,initialize:function(){this._isNew=!1,this.on("change:active",this.onChangeActive)},fetch:function(){this.add(g)},onChangeActive:function(a,b){b&&this.each(function(b){a.id!==b.id&&b.set({active:!1})})}})},function(a,b,c){var d=c(64);a.exports=d.extend({idAttribute:"method_id",defaults:{active:!1}})},function(a,b,c){var d=c(53),e=c(45),f=c(93),g=c(101),h=c(40),i=c(2),j=c(41).channel("global");a.exports=d.extend({channelName:"modal",initialize:function(a){this.container=a.container,this.start()},onStart:function(){this.channel.reply({open:this.open,close:this.close,alert:this.alert,confirm:this.confirm,prompt:this.prompt},this),this.layout=new f,this.container.show(this.layout),this.channel.reply({update:this.layout.update},this.layout),j.on({error:this.error},this),this.listenTo(e.history,{route:this.onRoute})},onStop:function(){delete this.layout,this.container.reset(),this.channel.reset()},onRoute:function(){this.fragment!==e.history.fragment&&this.close()},open:function(a){var b=this;return this.fragment=e.history.fragment,this.close().then(function(){return b.isOpen=!0,b.layout.open(a)})},close:function(){return this.isOpen?(this.isOpen=!1,this.layout.close()):h.Deferred().resolve()},error:function(a){a=a||{},a.jqXHR&&this.parseXHR(a);var b=new g({className:"error",title:a.status,message:a.message,raw:a.raw});this.open(b)},parseXHR:function(a){i.isObject(a.thrownError)?(a.status=a.thrownError.name,a.message=a.thrownError.message):(a.status=a.jqXHR.statusText,a.jqXHR.responseJSON&&a.jqXHR.responseJSON.errors[0]&&(a.message=a.jqXHR.responseJSON.errors[0].message)),a.raw=a.jqXHR.responseText}})},function(a,b,c){var d=c(47),e=c(94),f=c(2),g=c(40),h=c(96),i=c(98),j=c(41),k=c(37)("modalLayout");c(99),c(100),a.exports=d.extend({template:h.compile(i),className:function(){return window.adminpage?"wc_pos-modal":"modal"},attributes:{tabindex:-1,role:"dialog"},buttons:[{type:"message"},{action:"save",icon:"prepend",className:"btn-primary"}],regions:{header:".modal-header",content:".modal-body",footer:".modal-footer"},initialize:function(){this.$el.modal({show:!1,backdrop:"static"})},events:{'click [data-action="close"]':function(a){a.preventDefault(),j.request("modal","close")}},triggers:{"show.bs.modal":{preventDefault:!1,event:"before:open"},"shown.bs.modal":{preventDefault:!1,event:"open"},"hide.bs.modal":{preventDefault:!1,event:"before:close"},"hidden.bs.modal":{preventDefault:!1,event:"close"}},open:function(a){var b=g.Deferred();return this.once("open",b.resolve),this.setup(a),this.content.show(a),this.$el.modal("show"),b},close:function(){var a=g.Deferred();return this.once("close",function(){this.tearDown(),a.resolve()}),this.$el.modal("hide"),a},setup:function(a){var b=a.modal||{};f.defaults(b,{header:{},footer:{}}),f.each(b,function(a,b){var c=g.camelCase("modal-"+b);this[c]?this[c](a):k("no method matching "+c)},this)},tearDown:function(){this.header.empty(),this.content.empty(),this.footer.empty(),this.$(".modal-dialog").removeClass().addClass("modal-dialog")},update:function(a){a=a||{},f.each(a,function(a,b){this[b].currentView.triggerMethod("Update",a)},this)},modalHeader:function(a){var b=new e(a);this.header.show(b)},modalFooter:function(a){a.buttons=a.buttons||this.buttons;var b=j.request("buttons","view",a);this.footer.show(b)},modalTitle:function(a){this.$(".modal-header h1").html(a)},modalClassName:function(a){a&&this.$(".modal-dialog").addClass(a)},getButtons:function(){return this.getRegion("footer").currentView}})},function(a,b,c){var d=c(95),e=c(96),f=c(97),g=c(2),h=c(49);a.exports=d.extend({template:e.compile(f),initialize:function(a){a=a||{};var b={title:h.t("messages.loading"),close:h.t("buttons.close")};this.data=g.defaults(a,b)},templateHelpers:function(){return this.data.iconPrefix=window.adminpage?"wc_pos-icon":"icon",this.data},onUpdate:function(a){g.extend(this.data,a),this.render()}})},function(a,b,c){var d=c(44),e=c(36);a.exports=e.ItemView=d.ItemView},function(a,b){a.exports=Handlebars},function(a,b){a.exports='<h1>{{{title}}}</h1>\n<i class="{{iconPrefix}}-times" data-action="close" title="{{close}}"></i>'},function(a,b){a.exports='<div class="modal-dialog">\n  <div class="modal-content">\n    <div class="modal-header"></div>\n    <div class="modal-body"></div>\n    <div class="modal-footer"></div>\n  </div>\n</div>'},function(a,b){+function(a){"use strict";function b(b,d){return this.each(function(){var e=a(this),f=e.data("bs.modal"),g=a.extend({},c.DEFAULTS,e.data(),"object"==typeof b&&b);f||e.data("bs.modal",f=new c(this,g)),"string"==typeof b?f[b](d):g.show&&f.show(d)})}var c=function(b,c){this.options=c,this.$body=a(document.body),this.$element=a(b),this.$dialog=this.$element.find(".modal-dialog"),this.$backdrop=null,this.isShown=null,this.originalBodyPad=null,this.scrollbarWidth=0,this.ignoreBackdropClick=!1,this.options.remote&&this.$element.find(".modal-content").load(this.options.remote,a.proxy(function(){this.$element.trigger("loaded.bs.modal")},this))};c.VERSION="3.3.4",c.TRANSITION_DURATION=300,c.BACKDROP_TRANSITION_DURATION=150,c.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},c.prototype.toggle=function(a){return this.isShown?this.hide():this.show(a)},c.prototype.show=function(b){var d=this,e=a.Event("show.bs.modal",{relatedTarget:b});this.$element.trigger(e),this.isShown||e.isDefaultPrevented()||(this.isShown=!0,this.checkScrollbar(),this.setScrollbar(),this.$body.addClass("modal-open"),this.escape(),this.resize(),this.$element.on("click.dismiss.bs.modal",'[data-dismiss="modal"]',a.proxy(this.hide,this)),this.$dialog.on("mousedown.dismiss.bs.modal",function(){d.$element.one("mouseup.dismiss.bs.modal",function(b){a(b.target).is(d.$element)&&(d.ignoreBackdropClick=!0)})}),this.backdrop(function(){var e=a.support.transition&&d.$element.hasClass("fade");d.$element.parent().length||d.$element.appendTo(d.$body),d.$element.show().scrollTop(0),d.adjustDialog(),e&&d.$element[0].offsetWidth,d.$element.addClass("in").attr("aria-hidden",!1),d.enforceFocus();var f=a.Event("shown.bs.modal",{relatedTarget:b});e?d.$dialog.one("bsTransitionEnd",function(){d.$element.trigger("focus").trigger(f)}).emulateTransitionEnd(c.TRANSITION_DURATION):d.$element.trigger("focus").trigger(f)}))},c.prototype.hide=function(b){b&&b.preventDefault(),b=a.Event("hide.bs.modal"),this.$element.trigger(b),this.isShown&&!b.isDefaultPrevented()&&(this.isShown=!1,this.escape(),this.resize(),a(document).off("focusin.bs.modal"),this.$element.removeClass("in").attr("aria-hidden",!0).off("click.dismiss.bs.modal").off("mouseup.dismiss.bs.modal"),this.$dialog.off("mousedown.dismiss.bs.modal"),a.support.transition&&this.$element.hasClass("fade")?this.$element.one("bsTransitionEnd",a.proxy(this.hideModal,this)).emulateTransitionEnd(c.TRANSITION_DURATION):this.hideModal())},c.prototype.enforceFocus=function(){a(document).off("focusin.bs.modal").on("focusin.bs.modal",a.proxy(function(a){this.$element[0]===a.target||this.$element.has(a.target).length||this.$element.trigger("focus")},this))},c.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keydown.dismiss.bs.modal",a.proxy(function(a){27==a.which&&this.hide()},this)):this.isShown||this.$element.off("keydown.dismiss.bs.modal")},c.prototype.resize=function(){this.isShown?a(window).on("resize.bs.modal",a.proxy(this.handleUpdate,this)):a(window).off("resize.bs.modal")},c.prototype.hideModal=function(){var a=this;this.$element.hide(),this.backdrop(function(){a.$body.removeClass("modal-open"),a.resetAdjustments(),a.resetScrollbar(),a.$element.trigger("hidden.bs.modal")})},c.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},c.prototype.backdrop=function(b){var d=this,e=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var f=a.support.transition&&e;if(this.$backdrop=a('<div class="modal-backdrop '+e+'" />').appendTo(this.$body),this.$element.on("click.dismiss.bs.modal",a.proxy(function(a){return this.ignoreBackdropClick?void(this.ignoreBackdropClick=!1):void(a.target===a.currentTarget&&("static"==this.options.backdrop?this.$element[0].focus():this.hide()))},this)),f&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!b)return;f?this.$backdrop.one("bsTransitionEnd",b).emulateTransitionEnd(c.BACKDROP_TRANSITION_DURATION):b()}else if(!this.isShown&&this.$backdrop){this.$backdrop.removeClass("in");var g=function(){d.removeBackdrop(),b&&b()};a.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one("bsTransitionEnd",g).emulateTransitionEnd(c.BACKDROP_TRANSITION_DURATION):g()}else b&&b()},c.prototype.handleUpdate=function(){this.adjustDialog()},c.prototype.adjustDialog=function(){var a=this.$element[0].scrollHeight>document.documentElement.clientHeight;this.$element.css({paddingLeft:!this.bodyIsOverflowing&&a?this.scrollbarWidth:"",paddingRight:this.bodyIsOverflowing&&!a?this.scrollbarWidth:""})},c.prototype.resetAdjustments=function(){this.$element.css({paddingLeft:"",paddingRight:""})},c.prototype.checkScrollbar=function(){var a=window.innerWidth;if(!a){var b=document.documentElement.getBoundingClientRect();a=b.right-Math.abs(b.left)}this.bodyIsOverflowing=document.body.clientWidth<a,this.scrollbarWidth=this.measureScrollbar()},c.prototype.setScrollbar=function(){var a=parseInt(this.$body.css("padding-right")||0,10);this.originalBodyPad=document.body.style.paddingRight||"",this.bodyIsOverflowing&&this.$body.css("padding-right",a+this.scrollbarWidth)},c.prototype.resetScrollbar=function(){this.$body.css("padding-right",this.originalBodyPad)},c.prototype.measureScrollbar=function(){var a=document.createElement("div");a.className="modal-scrollbar-measure",this.$body.append(a);var b=a.offsetWidth-a.clientWidth;return this.$body[0].removeChild(a),b};var d=a.fn.modal;a.fn.modal=b,a.fn.modal.Constructor=c,a.fn.modal.noConflict=function(){return a.fn.modal=d,this},a(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(c){var d=a(this),e=d.attr("href"),f=a(d.attr("data-target")||e&&e.replace(/.*(?=#[^\s]+$)/,"")),g=f.data("bs.modal")?"toggle":a.extend({remote:!/#/.test(e)&&e},f.data(),d.data());d.is("a")&&c.preventDefault(),f.one("show.bs.modal",function(a){a.isDefaultPrevented()||f.one("hidden.bs.modal",function(){d.is(":visible")&&d.trigger("focus")})}),b.call(f,g,this)})}(jQuery)},function(a,b){+function(a){"use strict";function b(){var a=document.createElement("bootstrap"),b={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var c in b)if(void 0!==a.style[c])return{end:b[c]};return!1}a.fn.emulateTransitionEnd=function(b){var c=!1,d=this;a(this).one("bsTransitionEnd",function(){c=!0});var e=function(){c||a(d).trigger(a.support.transition.end)};return setTimeout(e,b),this},a(function(){a.support.transition=b(),a.support.transition&&(a.event.special.bsTransitionEnd={bindType:a.support.transition.end,delegateType:a.support.transition.end,handle:function(b){return a(b.target).is(this)?b.handleObj.handler.apply(this,arguments):void 0}})})}(jQuery)},function(a,b,c){var d=c(95),e=c(96),f=c(102);a.exports=d.extend({template:e.compile(f),initialize:function(a){a=a||{},this.message=a.message,this.raw=a.raw,this.modal={className:a.className,header:{title:a.title},footer:{buttons:[{action:"close"}]}}},templateHelpers:function(){var a={};return a.message=this.message,a.raw=this.raw,a},ui:{raw:'*[data-action="raw"]',output:".raw-output"},events:{"click @ui.raw":"toggleRaw"},toggleRaw:function(a){a.preventDefault(),this.ui.output.toggle()}})},function(a,b){a.exports='<p>\n  {{message}}\n  {{#if raw}}\n    <a href="#" data-action="raw"><i class="icon icon-info-circle"></i></a>\n  {{/if}}\n<p>\n{{#if raw}}\n  <div class="raw-output" style="display:none">{{{raw}}}</div>\n{{/if}}'},function(a,b,c){var d=c(53),e=c(104),f=c(108);a.exports=d.extend({channelName:"tabs",initialize:function(){this.channel.reply({view:this.tabsView},this)},tabsView:function(a){return a=a||{},new e({collection:this.tabsCollection(a)})},tabsCollection:function(a){return new f(a.tabs)}})},function(a,b,c){var d=c(105),e=c(106),f=d.extend({tagName:"ul",childView:e,attributes:{role:"tablist"},setActive:function(a){var b=this.collection.get(a);b.set({active:!0})},setLabel:function(a){a=a||{};var b=this.collection.get(a.tab);b.set({label:a.label})},onShow:function(){this.collection.ensureActiveTab()}});a.exports=f},function(a,b,c){var d=c(44),e=c(36);a.exports=e.CollectionView=d.CollectionView.extend({})},function(a,b,c){var d=c(96),e=c(95),f=c(107),g=e.extend({tagName:"li",template:d.compile(f),className:function(){return this.model.get("active")?"active":void 0},modelEvents:{"change:active":"toggleActive","change:label":"render"},toggleActive:function(){this.$el.toggleClass("active",this.model.get("active"))},triggers:{click:"tab:clicked",'click *[data-action="remove"]':"remove:tab"},onTabClicked:function(){this.model.set({active:!0})},onRemoveTab:function(){this.model.collection.remove(this.model)}});a.exports=g},function(a,b){a.exports='{{#unless fixed}}\n<a href="#" data-action="remove">\n  <i class="icon icon-times-circle"></i>\n</a>\n{{/unless}}\n{{{ label }}}'},function(a,b,c){var d=c(57),e=c(109),f=d.extend({model:e,initialize:function(){this.on({"change:active":this.onChangeActive,remove:this.ensureActiveTab})},onChangeActive:function(a,b){b&&(this.each(function(b){b.set({active:b===a})}),this.trigger("active:tab",a))},ensureActiveTab:function(){var a=this.where({active:!0});0===a.length&&this.at(0).set({active:!0})}});a.exports=f},function(a,b,c){var d=c(64),e=d.extend({defaults:{id:"",label:"Tab",active:!1,fixed:!0}});a.exports=e},function(a,b,c){var d=c(53),e=c(111);a.exports=d.extend({channelName:"buttons",initialize:function(){this.channel.reply({view:this.view},this)},view:function(a){var b=new e(a);return b}})},function(a,b,c){var d=c(95),e=c(96),f=c(2),g=c(112),h=c(49),i=c(113);a.exports=d.extend({viewOptions:["buttons"],buttons:[{action:"save",className:"btn-primary"}],template:e.compile(g),initialize:function(a){this.mergeOptions(a,this.viewOptions)},templateHelpers:function(){return f.each(this.buttons,function(a){var b=a.type||"button";a[b]=!0,a.label=a.label||h.t("buttons."+a.action)}),{buttons:this.buttons}},behaviors:{Buttons:{behaviorClass:i}}})},function(a,b){a.exports='{{#each buttons}}\n\n  {{#if this.button}}\n    <button class="btn {{this.className}}"\n            {{#if this.action}}data-action="{{this.action}}"{{/if}}\n      {{#if this.toggle}}data-toggle="{{this.toggle}}"{{/if}}\n      {{#if this.loading}}data-loading="{{this.loadingText}}"{{/if}}\n      {{#if this.icon}}data-icon="{{this.icon}}"{{/if}}\n      {{#if this.disabled}}disabled{{/if}}\n      >\n      {{this.label}}\n    </button>\n  {{/if}}\n\n  {{#if this.link}}\n    <a href="#" class="btn {{this.className}}"\n       {{#if this.action}}data-action="{{this.action}}"{{/if}}\n      {{#if this.toggle}}data-toggle="{{this.toggle}}"{{/if}}\n      {{#if this.loading}}data-loading="{{this.loadingText}}"{{/if}}\n      {{#if this.icon}}data-icon="{{this.icon}}"{{/if}}\n      >\n      {{this.label}}\n    </a>\n  {{/if}}\n\n  {{#if this.input}}\n    <input type="button" class="btn {{this.className}}" value="{{this.label}}"\n           {{#if this.action}}data-action="{{this.action}}"{{/if}}\n      {{#if this.toggle}}data-toggle="{{this.toggle}}"{{/if}}\n      {{#if this.loading}}data-loading="{{this.loadingText}}"{{/if}}\n      >\n  {{/if}}\n\n  {{#if this.message}}\n    <p class="message {{this.className}}"></p>\n  {{/if}}\n\n{{/each}}'},function(a,b,c){var d=c(114),e=c(36),f=c(40),g=c(49),h="disabled",i=d.extend({loadingText:g.t("messages.loading"),iconPrefix:"icon-",initialize:function(){window.adminpage&&(this.iconPrefix="wc_pos-icon-")},ui:{btns:".btn",action:"[data-action]",toggle:"[data-toggle]",message:".message"},events:{"click @ui.action":"action","click @ui.toggle":"toggle","state @ui.btns":"setState"},action:function(a){a.preventDefault();var b=f(a.target).data("action");this.view.trigger("action:"+b,f(a.target),this.view,b)},toggle:function(a){a.preventDefault(),this.enable().disable(f(a.target));var b=f(a.target).data("toggle");this.view.trigger("toggle:"+b,f(a.target),this.view,b)},enable:function(a){return a?a.removeClass(h).prop(h,!1):this.ui.btns.each(function(){f(this).removeClass(h).prop(h,!1)}),this},disable:function(a){return a?a.addClass(h).prop(h,!0):this.ui.btns.each(function(){f(this).addClass(h).prop(h,!0)}),this},setState:function(a,b,c){var d=f(a.target),e="loading"===b?"disable":"enable";this[e](),this.updateText(d),d.is("input")?this.updateInput(d,b):this.updateIcon(d,b),void 0!==c&&this.updateMessage(c,b)},updateText:function(a){if(void 0!==a.data("loading")){var b=a.is("input")?"val":"html",c=a[b](),d=a.data("loading")||this.loadingText;a.data("loading",c),a[b](d)}},updateIcon:function(a,b){if(void 0!==a.data("icon")){var c=a.data("icon")||"prepend",d="reset"!==b?this.icon(b):"";a.children("i").remove(),a[c](d)}},icon:function(a){return'<i class="'+this.iconPrefix+a+'"></i>'},updateInput:function(a,b){a.removeClass("loading success error"),"reset"!==b&&a.addClass(b)},updateMessage:function(a,b){null===a&&(a=g.t("messages."+b)),b||(b=a,a=g.t("messages."+a)),"reset"===b&&(a=""),this.ui.message.removeClass("loading success error").addClass(b).html(a)},onMessage:function(a,b){this.updateMessage(a,b)},onDisableButtons:function(){this.disable()},onEnableButtons:function(){this.enable()}});a.exports=i,e.attach("Behaviors.Buttons",i)},function(a,b,c){var d=c(44),e=c(36);a.exports=e.Behavior=d.Behavior},,function(a,b,c){var d=c(45),e=c(44),f=c(40),g=c(2),h=c(117),i=c(36);a.exports=i.Router=e.AppRouter.extend({constructor:function(){this.channel=d.Radio.channel("router"),this.on("all",this._onRouterEvent),this.listenTo(d.history,"route",this._onHistoryRoute),e.AppRouter.apply(this,arguments)},_onRouterEvent:function(a){var b=g.toArray(arguments).slice(1);this.channel.trigger.apply(this.channel,[a,this].concat(b))},_onHistoryRoute:function(a){this===a?this.active=!0:(this.active=!1,this._currentRoute=void 0)},execute:function(a,b){var c=this;this.active||this.triggerMethod.apply(this,["before:enter"].concat(b)),this.triggerMethod.apply(this,["before:route"].concat(b)),f.when(this._execute(a,b)).then(function(){c.active||c.triggerMethod.apply(c,["enter"].concat(b)),c.triggerMethod.apply(c,["route"].concat(b))})},_execute:function(a,b){var c=a.apply(this,b);return this._currentRoute=c,c instanceof h?(c.router=this,c.enter(b)):void 0},triggerMethod:e.triggerMethod})},function(a,b,c){var d=c(45),e=c(44),f=c(40),g=c(2),h=c(36),i=c(118),j=c(41),k=j.channel("global");a.exports=h.Route=e.Object.extend({constructor:function(){this.initialize.apply(this,arguments)},_triggerMethod:function(a,b){this.router&&this.router.triggerMethod.apply(this.router,[a+":route"].concat(b)),this.triggerMethod.apply(this,[a].concat(b))},enter:function(a){var b=this;return this.transitioning=!0,this._triggerMethod("before:enter",a),this._triggerMethod("before:fetch",a),g.defer(function(){b.transitioning&&(b.loading=new i({container:b.container}))}),f.when(this.fetch.call(this,a)).then(function(){b._triggerMethod("fetch",a),b._triggerMethod("before:render",a)}).then(function(){return b.transitioning=!1,b.render.apply(b,a)}).then(function(){b._triggerMethod("render",a),b._triggerMethod("enter",a)}).fail(function(){b._triggerMethod("error",a)})},navigate:function(){d.history.navigate.apply(d.history,arguments)},fetch:function(){},render:function(){},setTabLabel:function(a){k.trigger("tab:label",a)}})},function(a,b,c){var d=c(53),e=c(119),f=c(2),g=c(37)("loading");a.exports=d.extend({channelName:"loading",initialize:function(a){f.defaults(a,{type:"spinner",message:""}),a.container&&this[a.type]?this[a.type](a):g("invalid loading options",a)},spinner:function(a){var b=new e({message:a.message});a.container.show(b)},opacity:function(a){a.container.currentView.$el.css({opacity:.5})}})},function(a,b,c){var d=c(95),e=c(2),f=c(36),g=d.extend({className:"loading",iconPrefix:"icon-",initialize:function(){this.on("update:message",this.render),this.timeout=setTimeout(e.bind(this.fail,this),6e4),window.adminpage&&(this.iconPrefix="wc_pos-icon-")},render:function(){var a="";return e.isEmpty(this.options.message)||(a="<p>"+this.options.message+"</p>"),this.$el.html("<p>"+this.icon()+"</p>"+a),this},onBeforeDestroy:function(){clearTimeout(this.timeout)},fail:function(a){a?this.options.message=a:this.options.message="Script Error",this.render(),this.$("i").removeClass("icon-spinner").addClass("icon-fail")},icon:function(){return'<i class="'+this.iconPrefix+"spinner "+this.iconPrefix+'lg"></i>'}});a.exports=g,f.attach("Components.Loading.View",g)},,,,function(a,b,c){var d=c(95),e=c(45),f=c(36);c(124),c(125),c(126),a.exports=f.FormView=d.extend({constructor:function(){return d.prototype.constructor.apply(this,arguments)},bindings:{},render:function(){var a=Array.prototype.slice.apply(arguments),b=d.prototype.render.apply(this,a);return e.Validation.bind(this,{model:this.model,valid:function(a,b){a.$('input[name="'+b+'"]').parent().removeClass("error")},invalid:function(a,b){a.$('input[name="'+b+'"]').parent().addClass("error")}}),this.stickit(),b},remove:function(){return e.Validation.unbind(this),d.prototype.remove.apply(this,arguments)}})},function(a,b,c){var d,e,f;!function(g){e=[c(2),c(45),b],d=g,f="function"==typeof d?d.apply(b,e):d,!(void 0!==f&&(a.exports=f))}(function(a,b,c){b.Stickit=c,c._handlers=[],c.addHandler=function(b){b=a.map(a.flatten([b]),function(b){return a.defaults({},b,{updateModel:!0,updateView:!0,updateMethod:"text"})}),this._handlers=this._handlers.concat(b)},c.ViewMixin={_modelBindings:null,unstickit:function(b,c){if(a.isObject(c))return void a.each(c,function(a,c){this.unstickit(b,c)},this);var d=[],e=[];this._modelBindings=a.reject(this._modelBindings,function(a){return b&&a.model!==b||c&&a.config.selector!=c?void 0:(a.model.off(a.event,a.fn),e.push(a.config._destroy),d.push(a.model),!0)}),a.invoke(a.uniq(d),"trigger","stickit:unstuck",this.cid),a.each(a.uniq(e),function(a){a.call(this)},this),this.$el.off(".stickit"+(b?"."+b.cid:""),c)},stickit:function(b,c){var d=b||this.model,e=c||a.result(this,"bindings")||{};this._modelBindings||(this._modelBindings=[]),this.addBinding(d,e);var f=this.remove;return f.stickitWrapped||(this.remove=function(){var a=this;return this.unstickit(),f&&(a=f.apply(this,arguments)),a}),this.remove.stickitWrapped=!0,this},addBinding:function(b,c,e){var p=b||this.model,q=".stickit."+p.cid;if(e=e||{},a.isObject(c)){var r=c;return void a.each(r,function(a,b){this.addBinding(p,b,a)},this)}var s=":el"===c?this.$el:this.$(c);if(this.unstickit(p,c),s.length){a.isString(e)&&(e={observe:e}),a.isFunction(e.observe)&&(e.observe=e.observe.call(this));var t=k(s,e),u=t.observe;t.selector=c,t.view=this;var v=t.bindId=a.uniqueId(),w=a.extend({stickitChange:t},t.setOptions);if(t._destroy=function(){f.call(this,t.destroy,s,p,t)},l(s,t,p,u),n(s,t,p,u),m(s,t,p,u),u){a.each(t.events,function(b){var e=b+q,h=function(a){var b=f.call(this,t.getVal,s,a,t,d.call(arguments,1)),c=g(t.updateModel,b,a,t);c&&i(p,u,b,w,t)},j=":el"===c?"":c;this.$el.on(e,j,a.bind(h,this))},this),a.each(a.flatten([u]),function(a){h(p,"change:"+a,t,function(a,b,c){var d=c&&c.stickitChange&&c.stickitChange.bindId;if(d!==v){var e=j(p,u,t);o(s,t,e,p)}})});var x=j(p,u,t);o(s,t,x,p,!0)}f.call(this,t.initialize,s,p,t)}}},a.extend(b.View.prototype,c.ViewMixin);var d=[].slice,e=function(b,c){var d=(c||"").split("."),e=a.reduce(d,function(a,b){return a[b]},b);return null==e?b:e},f=function(b){return b=a.isString(b)?e(this,b):b,b?b.apply(this,d.call(arguments,1)):void 0},g=function(b,c,d){if(a.isBoolean(b))return b;if(a.isFunction(b)||a.isString(b)){var e=a.last(arguments).view;return f.apply(e,arguments)}return!1},h=function(a,b,c,d){var e=c.view;a.on(b,d,e),e._modelBindings.push({model:a,event:b,fn:d,config:c})},i=function(b,c,d,e,g){var h={},i=g.view;g.onSet&&(d=f.call(i,g.onSet,d,g)),g.set?f.call(i,g.set,c,d,e,g):(h[c]=d,a.isArray(c)&&a.isArray(d)&&(h=a.reduce(c,function(b,c,e){return b[c]=a.has(d,e)?d[e]:null,b},{})),b.set(h,e))},j=function(b,c,d){var e=d.view,g=function(a){return b[d.escape?"escape":"get"](a)},h=function(a){return null==a?"":a},i=a.isArray(c)?a.map(c,g):g(c);return d.onGet&&(i=f.call(e,d.onGet,i,d)),a.isArray(i)?a.map(i,h):h(i)},k=c.getConfiguration=function(b,d){var e=[{updateModel:!1,updateMethod:"text",update:function(a,b,c,d){a[d.updateMethod]&&a[d.updateMethod](b)},getVal:function(a,b,c){return a[c.updateMethod]()}}];e=e.concat(a.filter(c._handlers,function(a){return b.is(a.selector)})),e.push(d);var f=a.extend.apply(a,e);return a.has(f,"updateView")||(f.updateView=!f.visible),f},l=function(b,c,d,e){var f=["autofocus","autoplay","async","checked","controls","defer","disabled","hidden","indeterminate","loop","multiple","open","readonly","required","scoped","selected"],g=c.view;a.each(c.attributes||[],function(i){i=a.clone(i),i.view=g;var k="",l=i.observe||(i.observe=e),m=function(){var c=a.contains(f,i.name)?"prop":"attr",e=j(d,l,i);"class"===i.name?(b.removeClass(k).addClass(e),k=e):b[c](i.name,e)};a.each(a.flatten([l]),function(a){h(d,"change:"+a,c,m)}),m()})},m=function(b,c,d,e){a.each(c.classes||[],function(e,f){a.isString(e)&&(e={observe:e}),e.view=c.view;var g=e.observe,i=function(){var a=j(d,g,e);b.toggleClass(f,!!a)};a.each(a.flatten([g]),function(a){h(d,"change:"+a,c,i)}),i()})},n=function(b,c,d,e){if(null!=c.visible){var g=c.view,i=function(){var h=c.visible,i=c.visibleFn,k=j(d,e,c),l=!!k;(a.isFunction(h)||a.isString(h))&&(l=!!f.call(g,h,k,c)),i?f.call(g,i,b,l,c):b.toggle(l)};a.each(a.flatten([e]),function(a){h(d,"change:"+a,c,i)}),i()}},o=function(a,b,c,d,e){var h=b.view;g(b.updateView,c,b)&&(f.call(h,b.update,a,c,d,b),e||f.call(h,b.afterUpdate,a,c,b))};return c.addHandler([{selector:"[contenteditable]",updateMethod:"html",events:["input","change"]},{selector:"input",events:["propertychange","input","change"],update:function(a,b){a.val(b)},getVal:function(a){return a.val()}},{selector:"textarea",events:["propertychange","input","change"],update:function(a,b){a.val(b)},getVal:function(a){return a.val()}},{selector:'input[type="radio"]',events:["change"],update:function(a,b){a.filter('[value="'+b+'"]').prop("checked",!0)},getVal:function(a){return a.filter(":checked").val()}},{selector:'input[type="checkbox"]',events:["change"],update:function(c,d,e,f){if(c.length>1)d||(d=[]),c.each(function(c,e){var f=b.$(e),g=a.contains(d,f.val());f.prop("checked",g)});else{var g=a.isBoolean(d)?d:d===c.val();c.prop("checked",g)}},getVal:function(c){var d;if(c.length>1)d=a.reduce(c,function(a,c){var d=b.$(c);return d.prop("checked")&&a.push(d.val()),a},[]);else{d=c.prop("checked");var e=c.val();"on"!==e&&null!=e&&(d=d?c.val():null)}return d}},{selector:"select",events:["change"],update:function(c,d,g,h){var i,k=h.selectOptions,l=k&&k.collection||void 0,m=c.prop("multiple");if(!k){k={};var n=function(a){return a.map(function(a,c){var d=b.$(c).data("stickit-bind-val");return{value:void 0!==d?d:c.value,label:c.text}}).get()};c.find("optgroup").length?(l={opt_labels:[]},c.find("> option").length&&(l.opt_labels.push(void 0),a.each(c.find("> option"),function(a){l[void 0]=n(b.$(a))})),a.each(c.find("optgroup"),function(a){var c=b.$(a).attr("label");l.opt_labels.push(c),l[c]=n(b.$(a).find("option"))})):l=n(c.find("option"))}k.valuePath=k.valuePath||"value",k.labelPath=k.labelPath||"label",k.disabledPath=k.disabledPath||"disabled";var o=function(c,d,f){a.each(c,function(c){var g,h,i,j=b.$("<option/>"),l=c,n=function(b,c,d){j.text(b),l=c,j.data("stickit-bind-val",l),a.isArray(l)||a.isObject(l)||j.val(l),d===!0&&j.prop("disabled","disabled")};"__default__"===c?(g=f.label,h=f.value,i=f.disabled):(g=e(c,k.labelPath),h=e(c,k.valuePath),i=e(c,k.disabledPath)),n(g,h,i);var o=function(){return m||null==l||null==f||l!==f?a.isObject(f)&&a.isEqual(l,f)?!0:!1:!0};o()?j.prop("selected",!0):m&&a.isArray(f)&&a.each(f,function(b){a.isObject(b)&&(b=e(b,k.valuePath)),(b===l||a.isObject(b)&&a.isEqual(l,b))&&j.prop("selected",!0)}),d.append(j)})};if(c.find("*").remove(),a.isString(l)){var p=window;0===l.indexOf("this.")&&(p=this),l=l.replace(/^[a-z]*\.(.+)$/,"$1"),i=e(p,l)}else i=a.isFunction(l)?f.call(this,l,c,h):l;if(i instanceof b.Collection){var q=i,r=function(){var a=j(g,h.observe,h);f.call(this,h.update,c,a,g,h)},s=function(){q.off("add remove reset sort",r)},t=function(){s(),q.off("stickit:selectRefresh"),g.off("stickit:selectRefresh")};q.trigger("stickit:selectRefresh"),q.once("stickit:selectRefresh",s,this),q.on("add remove reset sort",r,this),g.trigger("stickit:selectRefresh"),g.once("stickit:selectRefresh",function(){g.off("stickit:unstuck",t)}),g.once("stickit:unstuck",t,this),i=i.toJSON()}if(k.defaultOption){var u=a.isFunction(k.defaultOption)?k.defaultOption.call(this,c,h):k.defaultOption;o(["__default__"],c,u)}if(a.isArray(i))o(i,c,d);else if(i.opt_labels)a.each(i.opt_labels,function(a){var e=b.$("<optgroup/>").attr("label",a);o(i[a],e,d),c.append(e)});else{var v,w=[];for(var x in i)v={},v[k.valuePath]=x,v[k.labelPath]=i[x],w.push(v);w=a.sortBy(w,k.comparator||k.labelPath),o(w,c,d)}},getVal:function(c){var d=c.find("option:selected");return c.prop("multiple")?a.map(d,function(a){return b.$(a).data("stickit-bind-val")}):d.data("stickit-bind-val")}}]),c})},function(a,b,c){!function(b){a.exports=b(c(45),c(2))}(function(a,b){return a.Validation=function(a){"use strict";var b={forceUpdate:!1,selector:"name",labelFormatter:"sentenceCase",valid:Function.prototype,invalid:Function.prototype},c={formatLabel:function(a,c){return i[b.labelFormatter](a,c)},format:function(){var a=Array.prototype.slice.call(arguments),b=a.shift();return b.replace(/\{(\d+)\}/g,function(b,c){return"undefined"!=typeof a[c]?a[c]:b})}},d=function(b,c,e){return c=c||{},e=e||"",a.each(b,function(f,g){b.hasOwnProperty(g)&&(f&&a.isArray(f)?a.forEach(f,function(a,b){d(a,c,e+g+"."+b+"."),c[e+g+"."+b]=a}):f&&"object"==typeof f&&f.constructor===Object&&d(f,c,e+g+"."),c[e+g]=f)}),c},e=function(){var e=function(b,c){return c=c||a.keys(a.result(b,"validation")||{}),a.reduce(c,function(a,b){return a[b]=void 0,a},{})},g=function(b,c){var d=b.attributes;return a.isFunction(d)?d=d(c):a.isString(d)&&a.isFunction(j[d])&&(d=j[d](c)),a.isArray(d)?d:void 0},h=function(b,c){var d=b.validation?a.result(b,"validation")[c]||{}:{};return(a.isFunction(d)||a.isString(d))&&(d={fn:d}),a.isArray(d)||(d=[d]),a.reduce(d,function(b,c){return a.each(a.without(a.keys(c),"msg"),function(a){b.push({fn:k[a],val:c[a],msg:c.msg})}),b},[])},i=function(b,d,e,f){return a.reduce(h(b,d),function(g,h){var i=a.extend({},c,k),j=h.fn.call(i,e,d,h.val,b,f);return j===!1||g===!1?!1:j&&!g?a.result(h,"msg")||j:g},"")},l=function(b,c,d){var e,f={},g=!0,h=a.clone(c);return a.each(d,function(a,c){e=i(b,c,a,h),e&&(f[c]=e,g=!1)}),{invalidAttrs:f,isValid:g}},m=function(b,c){return{preValidate:function(b,c){var d,e=this,f={};return a.isObject(b)?(a.each(b,function(a,b){
d=e.preValidate(b,a),d&&(f[b]=d)}),a.isEmpty(f)?void 0:f):i(this,b,c,a.extend({},this.attributes))},isValid:function(e){var f,h,j,k;return e=e||g(c,b),a.isString(e)?h=[e]:a.isArray(e)&&(h=e),h&&(f=d(this.attributes),a.each(this.associatedViews,function(b){a.each(h,function(d){j=i(this,d,f[d],a.extend({},this.attributes)),j?(c.invalid(b,d,j,c.selector),k=k||{},k[d]=j):c.valid(b,d,c.selector)},this)},this)),e===!0&&(k=this.validate()),k&&this.trigger("invalid",this,k,{validationError:k}),h?!k:this.validation?this._isValid:!0},validate:function(f,h){var i=this,j=!f,k=a.extend({},c,h),m=e(i,g(c,b)),n=a.extend({},m,i.attributes,f),o=d(n),p=f?d(f):o,q=l(i,n,a.pick(o,a.keys(m)));return i._isValid=q.isValid,a.each(i.associatedViews,function(b){a.each(m,function(a,c){var d=q.invalidAttrs.hasOwnProperty(c),e=p.hasOwnProperty(c);d||k.valid(b,c,k.selector),d&&(e||j)&&k.invalid(b,c,q.invalidAttrs[c],k.selector)})}),a.defer(function(){i.trigger("validated",i._isValid,i,q.invalidAttrs),i.trigger("validated:"+(i._isValid?"valid":"invalid"),i,q.invalidAttrs)}),!k.forceUpdate&&a.intersection(a.keys(q.invalidAttrs),a.keys(p)).length>0?q.invalidAttrs:void 0}}},n=function(b,c,d){c.associatedViews?c.associatedViews.push(b):c.associatedViews=[b],a.extend(c,m(b,d))},o=function(b,c){c&&b.associatedViews&&b.associatedViews.length>1?b.associatedViews=a.without(b.associatedViews,c):(delete b.validate,delete b.preValidate,delete b.isValid,delete b.associatedViews)},p=function(a){n(this.view,a,this.options)},q=function(a){o(a)};return{version:"0.11.3",configure:function(c){a.extend(b,c)},bind:function(c,d){d=a.extend({},b,f,d);var e=d.model||c.model,g=d.collection||c.collection;if("undefined"==typeof e&&"undefined"==typeof g)throw"Before you execute the binding your view must have a model or a collection.\nSee http://thedersen.com/projects/backbone-validation/#using-form-model-validation for more information.";e?n(c,e,d):g&&(g.each(function(a){n(c,a,d)}),g.bind("add",p,{view:c,options:d}),g.bind("remove",q))},unbind:function(b,c){c=a.extend({},c);var d=c.model||b.model,e=c.collection||b.collection;d?o(d,b):e&&(e.each(function(a){o(a,b)}),e.unbind("add",p),e.unbind("remove",q))},mixin:m(null,b)}}(),f=e.callbacks={valid:function(a,b,c){a.$("["+c+'~="'+b+'"]').removeClass("invalid").removeAttr("data-error")},invalid:function(a,b,c,d){a.$("["+d+'~="'+b+'"]').addClass("invalid").attr("data-error",c)}},g=e.patterns={digits:/^\d+$/,number:/^-?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d+)?$/,email:/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i,url:/^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i},h=e.messages={required:"{0} is required",acceptance:"{0} must be accepted",min:"{0} must be greater than or equal to {1}",max:"{0} must be less than or equal to {1}",range:"{0} must be between {1} and {2}",length:"{0} must be {1} characters",minLength:"{0} must be at least {1} characters",maxLength:"{0} must be at most {1} characters",rangeLength:"{0} must be between {1} and {2} characters",oneOf:"{0} must be one of: {1}",equalTo:"{0} must be the same as {1}",digits:"{0} must only contain digits",number:"{0} must be a number",email:"{0} must be a valid email",url:"{0} must be a valid url",inlinePattern:"{0} is invalid"},i=e.labelFormatters={none:function(a){return a},sentenceCase:function(a){return a.replace(/(?:^\w|[A-Z]|\b\w)/g,function(a,b){return 0===b?a.toUpperCase():" "+a.toLowerCase()}).replace(/_/g," ")},label:function(a,b){return b.labels&&b.labels[a]||i.sentenceCase(a,b)}},j=e.attributeLoaders={inputNames:function(a){var b=[];return a&&a.$("form [name]").each(function(){/^(?:input|select|textarea)$/i.test(this.nodeName)&&this.name&&"submit"!==this.type&&-1===b.indexOf(this.name)&&b.push(this.name)}),b}},k=e.validators=function(){var b=String.prototype.trim?function(a){return null===a?"":String.prototype.trim.call(a)}:function(a){var b=/^\s+/,c=/\s+$/;return null===a?"":a.toString().replace(b,"").replace(c,"")},c=function(b){return a.isNumber(b)||a.isString(b)&&b.match(g.number)},d=function(c){return!(a.isNull(c)||a.isUndefined(c)||a.isString(c)&&""===b(c)||a.isArray(c)&&a.isEmpty(c))};return{fn:function(b,c,d,e,f){return a.isString(d)&&(d=e[d]),d.call(e,b,c,f)},required:function(b,c,e,f,g){var i=a.isFunction(e)?e.call(f,b,c,g):e;return i||d(b)?i&&!d(b)?this.format(h.required,this.formatLabel(c,f)):void 0:!1},acceptance:function(b,c,d,e){return"true"===b||a.isBoolean(b)&&b!==!1?void 0:this.format(h.acceptance,this.formatLabel(c,e))},min:function(a,b,d,e){return!c(a)||d>a?this.format(h.min,this.formatLabel(b,e),d):void 0},max:function(a,b,d,e){return!c(a)||a>d?this.format(h.max,this.formatLabel(b,e),d):void 0},range:function(a,b,d,e){return!c(a)||a<d[0]||a>d[1]?this.format(h.range,this.formatLabel(b,e),d[0],d[1]):void 0},length:function(b,c,d,e){return a.isString(b)&&b.length===d?void 0:this.format(h.length,this.formatLabel(c,e),d)},minLength:function(b,c,d,e){return!a.isString(b)||b.length<d?this.format(h.minLength,this.formatLabel(c,e),d):void 0},maxLength:function(b,c,d,e){return!a.isString(b)||b.length>d?this.format(h.maxLength,this.formatLabel(c,e),d):void 0},rangeLength:function(b,c,d,e){return!a.isString(b)||b.length<d[0]||b.length>d[1]?this.format(h.rangeLength,this.formatLabel(c,e),d[0],d[1]):void 0},oneOf:function(b,c,d,e){return a.include(d,b)?void 0:this.format(h.oneOf,this.formatLabel(c,e),d.join(", "))},equalTo:function(a,b,c,d,e){return a!==e[c]?this.format(h.equalTo,this.formatLabel(b,d),this.formatLabel(c,d)):void 0},pattern:function(a,b,c,e){return d(a)&&a.toString().match(g[c]||c)?void 0:this.format(h[c]||h.inlinePattern,this.formatLabel(b,e),c)}}}();return a.each(k,function(b,d){k[d]=a.bind(k[d],a.extend({},c,k))}),e}(b),a.Validation})},function(a,b,c){var d=c(45),e=c(2);d.Stickit.addHandler({selector:".autogrow",afterUpdate:function(a){a.trigger("input")}}),d.Stickit.addHandler({selector:"select[multiple].select2",onSet:function(a,b){return e.isArray(a)&&this.model.unset(b.observe,{silent:!0}),a}})},function(a,b,c){var d=c(114),e=c(2),f=c(36),g=d.extend({initialize:function(a){a=a||{};var b={},c=["query","initSelection","formatResult","formatSelection"];e.each(c,function(c){this.view[c]&&(a[c]=e.bind(this.view[c],this.view)),b[c]=this[c]},this),this.options=e.defaults(a,b)},ui:{select:".select2"},onRender:function(){this.ui.select.hasClass("no-search")&&(this.options.dropdownCssClass="no-search"),this.ui.select.select2(this.options)},onBeforeDestroy:function(){this.ui.select.select2("destroy")},onSelectDisable:function(a){this.ui.select.attr("disabled",a)}});a.exports=g,f.attach("Behaviors.Select2",g)},function(a,b,c){var d=c(114),e=c(36);c(129);var f=d.extend({initialize:function(a){this.options=a},ui:{tooltip:'*[data-toggle="tooltip"]'},onRender:function(){this.ui.tooltip.tooltip(this.options)}});a.exports=f,e.attach("Behaviors.Tooltip",f)},function(a,b){+function(a){"use strict";function b(b){return this.each(function(){var d=a(this),e=d.data("bs.tooltip"),f="object"==typeof b&&b;(e||!/destroy|hide/.test(b))&&(e||d.data("bs.tooltip",e=new c(this,f)),"string"==typeof b&&e[b]())})}var c=function(a,b){this.type=null,this.options=null,this.enabled=null,this.timeout=null,this.hoverState=null,this.$element=null,this.init("tooltip",a,b)};c.VERSION="3.3.4",c.TRANSITION_DURATION=150,c.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1,viewport:{selector:"body",padding:0}},c.prototype.init=function(b,c,d){if(this.enabled=!0,this.type=b,this.$element=a(c),this.options=this.getOptions(d),this.$viewport=this.options.viewport&&a(this.options.viewport.selector||this.options.viewport),this.$element[0]instanceof document.constructor&&!this.options.selector)throw new Error("`selector` option must be specified when initializing "+this.type+" on the window.document object!");for(var e=this.options.trigger.split(" "),f=e.length;f--;){var g=e[f];if("click"==g)this.$element.on("click."+this.type,this.options.selector,a.proxy(this.toggle,this));else if("manual"!=g){var h="hover"==g?"mouseenter":"focusin",i="hover"==g?"mouseleave":"focusout";this.$element.on(h+"."+this.type,this.options.selector,a.proxy(this.enter,this)),this.$element.on(i+"."+this.type,this.options.selector,a.proxy(this.leave,this))}}this.options.selector?this._options=a.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},c.prototype.getDefaults=function(){return c.DEFAULTS},c.prototype.getOptions=function(b){return b=a.extend({},this.getDefaults(),this.$element.data(),b),b.delay&&"number"==typeof b.delay&&(b.delay={show:b.delay,hide:b.delay}),b},c.prototype.getDelegateOptions=function(){var b={},c=this.getDefaults();return this._options&&a.each(this._options,function(a,d){c[a]!=d&&(b[a]=d)}),b},c.prototype.enter=function(b){var c=b instanceof this.constructor?b:a(b.currentTarget).data("bs."+this.type);return c&&c.$tip&&c.$tip.is(":visible")?void(c.hoverState="in"):(c||(c=new this.constructor(b.currentTarget,this.getDelegateOptions()),a(b.currentTarget).data("bs."+this.type,c)),clearTimeout(c.timeout),c.hoverState="in",c.options.delay&&c.options.delay.show?void(c.timeout=setTimeout(function(){"in"==c.hoverState&&c.show()},c.options.delay.show)):c.show())},c.prototype.leave=function(b){var c=b instanceof this.constructor?b:a(b.currentTarget).data("bs."+this.type);return c||(c=new this.constructor(b.currentTarget,this.getDelegateOptions()),a(b.currentTarget).data("bs."+this.type,c)),clearTimeout(c.timeout),c.hoverState="out",c.options.delay&&c.options.delay.hide?void(c.timeout=setTimeout(function(){"out"==c.hoverState&&c.hide()},c.options.delay.hide)):c.hide()},c.prototype.show=function(){var b=a.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){this.$element.trigger(b);var d=a.contains(this.$element[0].ownerDocument.documentElement,this.$element[0]);if(b.isDefaultPrevented()||!d)return;var e=this,f=this.tip(),g=this.getUID(this.type);this.setContent(),f.attr("id",g),this.$element.attr("aria-describedby",g),this.options.animation&&f.addClass("fade");var h="function"==typeof this.options.placement?this.options.placement.call(this,f[0],this.$element[0]):this.options.placement,i=/\s?auto?\s?/i,j=i.test(h);j&&(h=h.replace(i,"")||"top"),f.detach().css({top:0,left:0,display:"block"}).addClass(h).data("bs."+this.type,this),this.options.container?f.appendTo(this.options.container):f.insertAfter(this.$element);var k=this.getPosition(),l=f[0].offsetWidth,m=f[0].offsetHeight;if(j){var n=h,o=this.options.container?a(this.options.container):this.$element.parent(),p=this.getPosition(o);h="bottom"==h&&k.bottom+m>p.bottom?"top":"top"==h&&k.top-m<p.top?"bottom":"right"==h&&k.right+l>p.width?"left":"left"==h&&k.left-l<p.left?"right":h,f.removeClass(n).addClass(h)}var q=this.getCalculatedOffset(h,k,l,m);this.applyPlacement(q,h);var r=function(){var a=e.hoverState;e.$element.trigger("shown.bs."+e.type),e.hoverState=null,"out"==a&&e.leave(e)};a.support.transition&&this.$tip.hasClass("fade")?f.one("bsTransitionEnd",r).emulateTransitionEnd(c.TRANSITION_DURATION):r()}},c.prototype.applyPlacement=function(b,c){var d=this.tip(),e=d[0].offsetWidth,f=d[0].offsetHeight,g=parseInt(d.css("margin-top"),10),h=parseInt(d.css("margin-left"),10);isNaN(g)&&(g=0),isNaN(h)&&(h=0),b.top=b.top+g,b.left=b.left+h,a.offset.setOffset(d[0],a.extend({using:function(a){d.css({top:Math.round(a.top),left:Math.round(a.left)})}},b),0),d.addClass("in");var i=d[0].offsetWidth,j=d[0].offsetHeight;"top"==c&&j!=f&&(b.top=b.top+f-j);var k=this.getViewportAdjustedDelta(c,b,i,j);k.left?b.left+=k.left:b.top+=k.top;var l=/top|bottom/.test(c),m=l?2*k.left-e+i:2*k.top-f+j,n=l?"offsetWidth":"offsetHeight";d.offset(b),this.replaceArrow(m,d[0][n],l)},c.prototype.replaceArrow=function(a,b,c){this.arrow().css(c?"left":"top",50*(1-a/b)+"%").css(c?"top":"left","")},c.prototype.setContent=function(){var a=this.tip(),b=this.getTitle();a.find(".tooltip-inner")[this.options.html?"html":"text"](b),a.removeClass("fade in top bottom left right")},c.prototype.hide=function(b){function d(){"in"!=e.hoverState&&f.detach(),e.$element.removeAttr("aria-describedby").trigger("hidden.bs."+e.type),b&&b()}var e=this,f=a(this.$tip),g=a.Event("hide.bs."+this.type);return this.$element.trigger(g),g.isDefaultPrevented()?void 0:(f.removeClass("in"),a.support.transition&&f.hasClass("fade")?f.one("bsTransitionEnd",d).emulateTransitionEnd(c.TRANSITION_DURATION):d(),this.hoverState=null,this)},c.prototype.fixTitle=function(){var a=this.$element;(a.attr("title")||"string"!=typeof a.attr("data-original-title"))&&a.attr("data-original-title",a.attr("title")||"").attr("title","")},c.prototype.hasContent=function(){return this.getTitle()},c.prototype.getPosition=function(b){b=b||this.$element;var c=b[0],d="BODY"==c.tagName,e=c.getBoundingClientRect();null==e.width&&(e=a.extend({},e,{width:e.right-e.left,height:e.bottom-e.top}));var f=d?{top:0,left:0}:b.offset(),g={scroll:d?document.documentElement.scrollTop||document.body.scrollTop:b.scrollTop()},h=d?{width:a(window).width(),height:a(window).height()}:null;return a.extend({},e,g,h,f)},c.prototype.getCalculatedOffset=function(a,b,c,d){return"bottom"==a?{top:b.top+b.height,left:b.left+b.width/2-c/2}:"top"==a?{top:b.top-d,left:b.left+b.width/2-c/2}:"left"==a?{top:b.top+b.height/2-d/2,left:b.left-c}:{top:b.top+b.height/2-d/2,left:b.left+b.width}},c.prototype.getViewportAdjustedDelta=function(a,b,c,d){var e={top:0,left:0};if(!this.$viewport)return e;var f=this.options.viewport&&this.options.viewport.padding||0,g=this.getPosition(this.$viewport);if(/right|left/.test(a)){var h=b.top-f-g.scroll,i=b.top+f-g.scroll+d;h<g.top?e.top=g.top-h:i>g.top+g.height&&(e.top=g.top+g.height-i)}else{var j=b.left-f,k=b.left+f+c;j<g.left?e.left=g.left-j:k>g.width&&(e.left=g.left+g.width-k)}return e},c.prototype.getTitle=function(){var a,b=this.$element,c=this.options;return a=b.attr("data-original-title")||("function"==typeof c.title?c.title.call(b[0]):c.title)},c.prototype.getUID=function(a){do a+=~~(1e6*Math.random());while(document.getElementById(a));return a},c.prototype.tip=function(){return this.$tip=this.$tip||a(this.options.template)},c.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},c.prototype.enable=function(){this.enabled=!0},c.prototype.disable=function(){this.enabled=!1},c.prototype.toggleEnabled=function(){this.enabled=!this.enabled},c.prototype.toggle=function(b){var c=this;b&&(c=a(b.currentTarget).data("bs."+this.type),c||(c=new this.constructor(b.currentTarget,this.getDelegateOptions()),a(b.currentTarget).data("bs."+this.type,c))),c.tip().hasClass("in")?c.leave(c):c.enter(c)},c.prototype.destroy=function(){var a=this;clearTimeout(this.timeout),this.hide(function(){a.$element.off("."+a.type).removeData("bs."+a.type)})};var d=a.fn.tooltip;a.fn.tooltip=b,a.fn.tooltip.Constructor=c,a.fn.tooltip.noConflict=function(){return a.fn.tooltip=d,this}}(jQuery)},function(a,b,c){var d=c(95),e=c(127),f=c(2),g=c(41),h=c(96),i=c(36),j=d.extend({template:function(){return'<input name="customer" type="hidden" class="select2">'},initialize:function(a){a=a||{},this.model=a.model,this.customers=g.request("entities","get",{type:"collection",name:"customers"})},behaviors:{Select2:{behaviorClass:e,minimumInputLength:3}},ui:{select:'input[name="customer"]'},events:{"change @ui.select":"onSelect","select2-opening @ui.select":"onSelectOpen"},query:f.debounce(function(a){var b=function(b){var c=b.toJSON();c.unshift(b._guest),a.callback({results:c})};this.customers.fetch({beforeSend:function(a){a.setRequestHeader("X-WC-POS",1)},data:"filter[q]="+a.term,success:b})},250),initSelection:function(a,b){var c;this.model&&(c=this.model.get("customer")),c||(c=this.customers._default),b(c)},formatResult:function(a){var b="{{first_name}} {{last_name}} {{#if email}}({{email}}){{/if}}";this.hasNoNames(a)&&(b="{{username}} ({{email}})");var c=h.compile(b);return c(a)},formatSelection:function(a){var b="{{first_name}} {{last_name}}";this.hasNoNames(a)&&(b="{{username}}");var c=h.compile(b);return c(a)},hasNoNames:function(a){return f.chain(a).pick("first_name","last_name").values().compact().isEmpty().value()},onSelect:function(a){this.trigger("customer:select",a.added)},onSelectOpen:function(){}});a.exports=j,i.attach("Components.CustomerSelect.View",j)},,,,,,,,,,,function(a,b,c){var d=c(114),e=c(36),f=c(40),g=c(41),h=d.extend({ui:{toggle:'*[data-action^="legacy-"]'},events:{"click @ui.toggle":"toggle"},toggle:function(a){a.preventDefault();var b=g.request("entities","get",{type:"option",name:"ajaxurl"}),c=g.request("entities","get",{type:"option",name:"nonce"});f.getJSON(b,{action:"wc_pos_toggle_legacy_server",enable:"enable"===f(a.target).data("action").split("-").pop(),security:c},function(){window.location.reload()})}});a.exports=h,e.attach("Behaviors.EmulateHTTP",h)},,,,function(a,b,c){var d=c(43),e=c(45),f=c(146),g=c(37)("app"),h=c(48),i=c(49);a.exports=d.extend({initialize:function(){this.layout=new f,this.layout.render()},onBeforeStart:function(){g("starting WooCommerce POS app"),e.emulateHTTP=this.options.emulateHTTP===!0,i.extend(this.options.i18n),h.settings=this.options.accounting,this.headerService.start()},onStart:function(){e.history.start()}})},function(a,b,c){var d=c(47),e=c(40),f=c(41),g=f.channel("global");a.exports=d.extend({el:"#page",template:function(){return'<header id="header"></header><div id="menu"></div><div id="tabs" class="tabs"></div><main id="main"></main><div id="modal"></div>'},regions:{header:"#header",menu:"#menu",tabs:"#tabs",main:"#main",modal:"#modal"},initialize:function(){this.getRegion("main").on("show",this.setup,this),g.on("tab:label",this.updateTabLabel,this)},setup:function(a){a.columns&&2===a.columns?(this.$el.addClass("two-column"),this.showTabs()):(this.$el.removeClass("two-column"),this.getRegion("tabs").empty())},showTabs:function(){var a=this.getRegion("main").tabs=f.request("tabs","view",{tabs:[{id:"left"},{id:"right"}]});this.listenTo(a.collection,"active:tab",this.toggleLayout),this.getRegion("tabs").show(a)},toggleLayout:function(a){e("#main").removeClass("left-active right-active"),e("#main").addClass(a.id+"-active")},updateTabLabel:function(a){this.getRegion("main").tabs.setLabel(a)}})},function(a,b,c){var d=c(45),e=c(41);d.idbSync=c(148),d.ajaxSync=d.sync,d.$.ajaxSetup({data:{security:function(){return e.request("entities","get",{type:"option",name:"nonce"})}},beforeSend:function(a){a.setRequestHeader("X-WC-POS",1)},timeout:5e4}),d.$(document).ajaxError(function(a,b,c,d){e.trigger("global","error",{jqXHR:b,thrownError:d})}),d.sync=function(a,b,c){return!c.remote&&(b.db||b.collection&&b.collection.db)?d.idbSync.apply(this,[a,b,c]):(c.beforeSend=function(a){a.setRequestHeader("X-WC-POS",1)},d.ajaxSync.apply(this,[a,b,c]))}},function(a,b,c){var d=c(40),e=function(){},f={read:function(a,b,c){return a.id?c.read(a,b):c.getAll(b)},create:function(a,b,c){return a.id?c.update(a,b):c.create(a,b)},update:function(a,b,c){return a.id?c.update(a,b):c.create(a,b)},"delete":function(a,b,c){return a.id?c.destroy(a,b):void 0}},g=function(a,b,c){var g=new d.Deferred,h=b.db||b.collection.db,i=c.success||e,j=c.success||e;return c.success=function(a){i.apply(this,arguments),g.resolve(a)},c.error=function(a){j.apply(this,arguments),g.reject(a)},h.open().then(function(){return f[a]?f[a](b,c,h):void 0}),g.promise()};a.exports=g},function(a,b,c){(function(b){var d=c(53),e=c(150),f=c(189),g=c(36),h=c(41),i=h.channel("router"),j=c(190),k=c(2),l=b.Modernizr,d=d.extend({channelName:"header",initialize:function(a){a=a||{},this.header=a.headerContainer,this.menu=a.menuContainer,this.listenToOnce(i,{route:this.browserCheck}),this.channel.reply({"update:title":this.updateTitle},this)},onStart:function(){this.showTitleBar(),this.showMenu()},showTitleBar:function(){var a=new e;this.header.show(a)},updateTitle:function(a){this.header.currentView.update(a)},showMenu:function(){var a=new f;this.channel.reply({"open:menu":a.open,"close:menu":a.close},a),this.menu.show(a)},browserCheck:function(){var a=["flexbox","indexeddb","smil"],b=k.every(a,function(a){return l[a]});if(!b){var c=new j;h.request("modal","open",c)}},onStop:function(){this.channel.reset()}});a.exports=d,g.attach("HeaderApp.Service",d)}).call(b,function(){return this}())},function(a,b,c){var d=c(95),e=c(36),f=c(151),g=c(185),h=c(41),i=c(187),j=d.extend({template:"#tmpl-header",onRender:function(){this.title=this.$("h1").text()},ui:{menu:"#menu-btn"},events:{"click @ui.menu":"openMenu"},keyEvents:{help:"showHelpModal"},behaviors:{HotKeys:{behaviorClass:f},Dropdown:{behaviorClass:g}},update:function(a){var b=a?a:this.title;this.$("h1").text(b)},openMenu:function(a){a.preventDefault(),h.request("header","open:menu")},showHelpModal:function(){var a=new i;h.request("modal","open",a)}});a.exports=j,e.attach("HeaderApp.Views.TitleBar",j)},function(a,b,c){var d=c(114),e=c(41),f=c(2),g=c(37)("hotkey"),h=c(36),i=c(152),j=d.extend({keys:[],initialize:function(a){a=a||{},this.element=a.el,this.hotkeys=e.request("entities","get",{type:"option",name:"hotkeys"})||{}},onRender:function(){var a=this.element||document.documentElement,b=this.view;this.combokeys=new i(a),f.each(b.keyEvents,function(a,c){var d=this.hotkeys[c];return f.isFunction(a)||(a=b[a]),d&&a?(this.combokeys.bind(d.key,function(c,d){a.call(b,c,d)}),void this.keys.push(d.key)):g("hotkey not found: "+c,this.view.keyEvents)},this)},onDestroy:function(){f.each(this.keys,function(a){this.combokeys.unbind(a)},this)}});a.exports=j,h.attach("Behaviors.HotKeys",j)},function(a,b,c){"use strict";a.exports=function(a){var b=this,c=b.constructor;return b.callbacks={},b.directMap={},b.sequenceLevels={},b.resetTimer,b.ignoreNextKeyup=!1,b.ignoreNextKeypress=!1,b.nextExpectedAction=!1,b.element=a,b.addEvents(),c.instances.push(b),b},a.exports.prototype.bind=c(153),a.exports.prototype.bindMultiple=c(154),a.exports.prototype.unbind=c(155),a.exports.prototype.trigger=c(156),a.exports.prototype.reset=c(157),a.exports.prototype.stopCallback=c(158),a.exports.prototype.handleKey=c(159),a.exports.prototype.addEvents=c(161),a.exports.prototype.bindSingle=c(168),a.exports.prototype.getKeyInfo=c(169),a.exports.prototype.pickBestAction=c(173),a.exports.prototype.getReverseMap=c(174),a.exports.prototype.getMatches=c(175),a.exports.prototype.resetSequences=c(177),a.exports.prototype.fireCallback=c(178),a.exports.prototype.bindSequence=c(181),a.exports.prototype.resetSequenceTimer=c(182),a.exports.prototype.detach=c(183),a.exports.instances=[],a.exports.reset=c(184),a.exports.REVERSE_MAP=null},function(a,b){"use strict";a.exports=function(a,b,c){var d=this;return a=a instanceof Array?a:[a],d.bindMultiple(a,b,c),d}},function(a,b){"use strict";a.exports=function(a,b,c){for(var d=this,e=0;e<a.length;++e)d.bindSingle(a[e],b,c)}},function(a,b){"use strict";a.exports=function(a,b){var c=this;return c.bind(a,function(){},b)}},function(a,b){"use strict";a.exports=function(a,b){var c=this;return c.directMap[a+":"+b]&&c.directMap[a+":"+b]({},a),this}},function(a,b){"use strict";a.exports=function(){var a=this;return a.callbacks={},a.directMap={},this}},function(a,b){"use strict";a.exports=function(a,b){if((" "+b.className+" ").indexOf(" combokeys ")>-1)return!1;var c=b.tagName.toLowerCase();return"input"===c||"select"===c||"textarea"===c||b.isContentEditable}},function(a,b,c){"use strict";a.exports=function(a,b,d){var e,f,g,h,i=this,j={},k=0,l=!1;for(e=i.getMatches(a,b,d),f=0;f<e.length;++f)e[f].seq&&(k=Math.max(k,e[f].level));for(f=0;f<e.length;++f)if(e[f].seq){if(e[f].level!==k)continue;l=!0,j[e[f].seq]=1,i.fireCallback(e[f].callback,d,e[f].combo,e[f].seq)}else l||i.fireCallback(e[f].callback,d,e[f].combo);h="keypress"===d.type&&i.ignoreNextKeypress,g=c(160),d.type!==i.nextExpectedAction||g(a)||h||i.resetSequences(j),i.ignoreNextKeypress=l&&"keydown"===d.type}},function(a,b){"use strict";a.exports=function(a){return"shift"===a||"ctrl"===a||"alt"===a||"meta"===a}},function(a,b,c){"use strict";a.exports=function(){var a=this,b=c(162),d=a.element;a.eventHandler=c(163).bind(a),b(d,"keypress",a.eventHandler),b(d,"keydown",a.eventHandler),b(d,"keyup",a.eventHandler)}},function(a,b){function c(a,b,c,d){return!a.addEventListener&&(b="on"+b),(a.addEventListener||a.attachEvent).call(a,b,c,d),c}function d(a,b,c,d){return!a.removeEventListener&&(b="on"+b),(a.removeEventListener||a.detachEvent).call(a,b,c,d),c}a.exports=c,a.exports.on=c,a.exports.off=d},function(a,b,c){"use strict";a.exports=function(a){var b,d,e=this;"number"!=typeof a.which&&(a.which=a.keyCode),b=c(164);var f=b(a);if(f){if("keyup"===a.type&&e.ignoreNextKeyup===f)return void(e.ignoreNextKeyup=!1);d=c(167),e.handleKey(f,d(a),a)}}},function(a,b,c){"use strict";a.exports=function(a){var b,d;if(b=c(165),d=c(166),"keypress"===a.type){var e=String.fromCharCode(a.which);return a.shiftKey||(e=e.toLowerCase()),e}return b[a.which]?b[a.which]:d[a.which]?d[a.which]:String.fromCharCode(a.which).toLowerCase()}},function(a,b){"use strict";a.exports={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",187:"plus",189:"minus",224:"meta"};for(var c=1;20>c;++c)a.exports[111+c]="f"+c;for(c=0;9>=c;++c)a.exports[c+96]=c},function(a,b){"use strict";a.exports={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"}},function(a,b){"use strict";a.exports=function(a){var b=[];return a.shiftKey&&b.push("shift"),a.altKey&&b.push("alt"),a.ctrlKey&&b.push("ctrl"),a.metaKey&&b.push("meta"),b}},function(a,b){"use strict";a.exports=function(a,b,c,d,e){var f=this;f.directMap[a+":"+c]=b,a=a.replace(/\s+/g," ");var g,h=a.split(" ");return h.length>1?void f.bindSequence(a,h,b,c):(g=f.getKeyInfo(a,c),f.callbacks[g.key]=f.callbacks[g.key]||[],f.getMatches(g.key,g.modifiers,{type:g.action},d,a,e),void f.callbacks[g.key][d?"unshift":"push"]({callback:b,modifiers:g.modifiers,action:g.action,seq:d,level:e,combo:a}))}},function(a,b,c){"use strict";a.exports=function(a,b){var d,e,f,g,h,i,j,k=this,l=[];for(d=c(170),e=d(a),h=c(171),i=c(172),j=c(160),g=0;g<e.length;++g)f=e[g],h[f]&&(f=h[f]),b&&"keypress"!==b&&i[f]&&(f=i[f],l.push("shift")),j(f)&&l.push(f);return b=k.pickBestAction(f,l,b),{key:f,modifiers:l,action:b}}},function(a,b){"use strict";a.exports=function(a){return"+"===a?["+"]:a.split("+")}},function(a,b){"use strict";a.exports={option:"alt",command:"meta","return":"enter",escape:"esc",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl"}},function(a,b){"use strict";a.exports={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"}},function(a,b){"use strict";a.exports=function(a,b,c){var d=this;return c||(c=d.getReverseMap()[a]?"keydown":"keypress"),"keypress"===c&&b.length&&(c="keydown"),c}},function(a,b,c){"use strict";a.exports=function(){var a,b=this,d=b.constructor;if(!d.REVERSE_MAP){d.REVERSE_MAP={},a=c(165);for(var e in a)e>95&&112>e||a.hasOwnProperty(e)&&(d.REVERSE_MAP[a[e]]=e)}return d.REVERSE_MAP}},function(a,b,c){"use strict";a.exports=function(a,b,d,e,f,g){var h,i,j,k,l=this,m=[],n=d.type;if("keypress"===n){var o=l.callbacks["any-character"]||[];o.forEach(function(a){m.push(a)})}if(!l.callbacks[a])return m;for(j=c(160),"keyup"===n&&j(a)&&(b=[a]),h=0;h<l.callbacks[a].length;++h)if(i=l.callbacks[a][h],(e||!i.seq||l.sequenceLevels[i.seq]===i.level)&&n===i.action&&(k=c(176),"keypress"===n&&!d.metaKey&&!d.ctrlKey||k(b,i.modifiers))){var p=!e&&i.combo===f,q=e&&i.seq===e&&i.level===g;(p||q)&&l.callbacks[a].splice(h,1),m.push(i)}return m}},function(a,b){"use strict";a.exports=function(a,b){return a.sort().join(",")===b.sort().join(",")}},function(a,b){"use strict";a.exports=function(a){var b=this;a=a||{};var c,d=!1;for(c in b.sequenceLevels)a[c]?d=!0:b.sequenceLevels[c]=0;d||(b.nextExpectedAction=!1)}},function(a,b,c){"use strict";a.exports=function(a,b,d,e){var f,g,h=this;h.stopCallback(b,b.target||b.srcElement,d,e)||a(b,d)===!1&&(f=c(179),f(b),(g=c(180))(b))}},function(a,b){"use strict";a.exports=function(a){return a.preventDefault?void a.preventDefault():void(a.returnValue=!1)}},function(a,b){"use strict";a.exports=function(a){return a.stopPropagation?void a.stopPropagation():void(a.cancelBubble=!0)}},function(a,b,c){"use strict";a.exports=function(a,b,d,e){function f(b){return function(){h.nextExpectedAction=b,++h.sequenceLevels[a],h.resetSequenceTimer()}}function g(b){var f;h.fireCallback(d,b,a),"keyup"!==e&&(f=c(164),h.ignoreNextKeyup=f(b)),setTimeout(function(){h.resetSequences()},10)}var h=this;h.sequenceLevels[a]=0;for(var i=0;i<b.length;++i){var j=i+1===b.length,k=j?g:f(e||h.getKeyInfo(b[i+1]).action);h.bindSingle(b[i],k,e,a,i)}}},function(a,b){"use strict";a.exports=function(){var a=this;clearTimeout(a.resetTimer),a.resetTimer=setTimeout(function(){a.resetSequences()},1e3)}},function(a,b,c){var d=c(162).off;a.exports=function(){var a=this,b=a.element;d(b,"keypress",a.eventHandler),d(b,"keydown",a.eventHandler),d(b,"keyup",a.eventHandler)}},function(a,b){"use strict";a.exports=function(){var a=this;a.instances.forEach(function(a){a.reset()})}},function(a,b,c){var d=c(114),e=c(36);c(186);var f=d.extend({ui:{dropdown:'*[data-toggle="dropdown"]'}});a.exports=f,e.attach("Behaviors.Dropdown",f)},function(a,b){+function(a){"use strict";function b(b){b&&3===b.which||(a(e).remove(),a(f).each(function(){var d=a(this),e=c(d),f={relatedTarget:this};e.hasClass("open")&&(e.trigger(b=a.Event("hide.bs.dropdown",f)),b.isDefaultPrevented()||(d.attr("aria-expanded","false"),e.removeClass("open").trigger("hidden.bs.dropdown",f)))}))}function c(b){var c=b.attr("data-target");c||(c=b.attr("href"),c=c&&/#[A-Za-z]/.test(c)&&c.replace(/.*(?=#[^\s]*$)/,""));
var d=c&&a(c);return d&&d.length?d:b.parent()}function d(b){return this.each(function(){var c=a(this),d=c.data("bs.dropdown");d||c.data("bs.dropdown",d=new g(this)),"string"==typeof b&&d[b].call(c)})}var e=".dropdown-backdrop",f='[data-toggle="dropdown"]',g=function(b){a(b).on("click.bs.dropdown",this.toggle)};g.VERSION="3.3.4",g.prototype.toggle=function(d){var e=a(this);if(!e.is(".disabled, :disabled")){var f=c(e),g=f.hasClass("open");if(b(),!g){"ontouchstart"in document.documentElement&&!f.closest(".navbar-nav").length&&a('<div class="dropdown-backdrop"/>').insertAfter(a(this)).on("click",b);var h={relatedTarget:this};if(f.trigger(d=a.Event("show.bs.dropdown",h)),d.isDefaultPrevented())return;e.trigger("focus").attr("aria-expanded","true"),f.toggleClass("open").trigger("shown.bs.dropdown",h)}return!1}},g.prototype.keydown=function(b){if(/(38|40|27|32)/.test(b.which)&&!/input|textarea/i.test(b.target.tagName)){var d=a(this);if(b.preventDefault(),b.stopPropagation(),!d.is(".disabled, :disabled")){var e=c(d),g=e.hasClass("open");if(!g&&27!=b.which||g&&27==b.which)return 27==b.which&&e.find(f).trigger("focus"),d.trigger("click");var h=" li:not(.disabled):visible a",i=e.find('[role="menu"]'+h+', [role="listbox"]'+h);if(i.length){var j=i.index(b.target);38==b.which&&j>0&&j--,40==b.which&&j<i.length-1&&j++,~j||(j=0),i.eq(j).trigger("focus")}}}};var h=a.fn.dropdown;a.fn.dropdown=d,a.fn.dropdown.Constructor=g,a.fn.dropdown.noConflict=function(){return a.fn.dropdown=h,this},a(document).on("click.bs.dropdown.data-api",b).on("click.bs.dropdown.data-api",".dropdown form",function(a){a.stopPropagation()}).on("click.bs.dropdown.data-api",f,g.prototype.toggle).on("keydown.bs.dropdown.data-api",f,g.prototype.keydown).on("keydown.bs.dropdown.data-api",'[role="menu"]',g.prototype.keydown).on("keydown.bs.dropdown.data-api",'[role="listbox"]',g.prototype.keydown)}(jQuery)},function(a,b,c){var d=c(95),e=c(128),f=c(188),g=c(96),h=c(41),i=c(36),j=c(49),k=d.extend({template:g.compile(f),initialize:function(){this.hotkeys=h.request("entities","get",{type:"option",name:"hotkeys"}),this.modal={header:{title:j.t("titles.hotkeys")},footer:{show:!1}}},behaviors:{Tooltip:{behaviorClass:e}},templateHelpers:function(){return this.hotkeys}});a.exports=k,i.attach("HeaderApp.Views.HelpModal",k)},function(a,b){a.exports='<ul class="hotkeys">\n  {{#each []}}\n    <li>\n      <input type="text" value="{{key}}" disabled>\n      {{label}}\n    </li>\n  {{/each}}\n</ul>'},function(a,b,c){var d=c(95),e=c(40),f=c(2),g=c(36),h=d.extend({template:"#tmpl-menu",tagName:"ul",initialize:function(){f.bindAll(this,"open","close")},ui:{menuItem:"li a"},events:{"click @ui.menuItem":"goTo"},goTo:function(){this.close()},open:function(){e("body").addClass("menu-open"),this.backdrop=e('<div class="modal-backdrop in"></div>'),this.backdrop.height("100%"),e("body").append(this.backdrop),this.backdrop.on("click",this.close)},close:function(){e("body").removeClass("menu-open"),this.backdrop&&(this.backdrop.remove(),delete this.backdrop)}});a.exports=h,g.attach("HeaderApp.Views.Menu",h)},function(a,b,c){var d=c(95),e=c(41),f=c(36),g=c(40),h=c(49),i=d.extend({template:function(){return'<i class="icon icon-spinner"></i>'},modal:{footer:{buttons:[{action:"close"}]}},initialize:function(){var a=this,b=e.request("entities","get",{type:"option",name:"ajaxurl"});g.get(b,{action:"wc_pos_get_modal",template:"browser"}).always(function(b){a.update(b)}),this.modal.header={title:h.t("messages.browser")}},update:function(a){this.$el.html(a)}});a.exports=i,f.attach("HeaderApp.Views.BrowserModal",i)},function(a,b,c){var d=c(53),e=c(192);a.exports=d.extend({channelName:"popover",initialize:function(){this.channel.reply({open:this.open,close:this.close},this)},open:function(a){return a.target.data("popoverOpen")?void 0:(this.layout=new e(a),this.layout.open(),this.layout)},close:function(){this.layout.close()}})},function(a,b,c){var d=c(47),e=c(2),f=c(40);c(129),c(193),a.exports=d.extend({template:e.template('<div class="arrow"></div><h1 class="popover-title"></h1><div class="popover-region"></div>'),_className:"popover",className:function(){return console.log("called now"),this._className},attributes:{role:"tooltip"},regions:{content:".popover-region"},initialize:function(a){a=a||{},this.target=a.target,this.view=a.view,this.parent=a.parent,this.render().setup(a),e.bindAll(this,"open","close","show","shown","hide","hidden"),this.target.on({"show.bs.popover":this.show,"shown.bs.popover":this.shown,"hide.bs.popover":this.hide,"hidden.bs.popover":this.hidden}),this.listenTo(this.parent,"before:destroy",this.close)},setup:function(a){e.defaults(a,{container:"body",content:" ",delay:0,placement:"right",template:this.el,title:"",trigger:"manual"}),this.target.popover(a)},open:function(){this.target.popover("show")},close:function(a){a&&f(a.target).is(".popover *, .popover")||this.target.popover("hide")},show:function(){this.content.show(this.view)},shown:function(){this.target.data("popoverOpen",!0),f("body").on("click",this.close)},hide:function(){f("body").off("click")},hidden:function(){this.target.off({"show.bs.popover":this.show,"shown.bs.popover":this.shown,"hide.bs.popover":this.hide,"hidden.bs.popover":this.hidden}),this.destroy(),this.target.popover("destroy"),this.target.data("popoverOpen",!1)}})},function(a,b){+function(a){"use strict";function b(b){return this.each(function(){var d=a(this),e=d.data("bs.popover"),f="object"==typeof b&&b;(e||!/destroy|hide/.test(b))&&(e||d.data("bs.popover",e=new c(this,f)),"string"==typeof b&&e[b]())})}var c=function(a,b){this.init("popover",a,b)};if(!a.fn.tooltip)throw new Error("Popover requires tooltip.js");c.VERSION="3.3.4",c.DEFAULTS=a.extend({},a.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),c.prototype=a.extend({},a.fn.tooltip.Constructor.prototype),c.prototype.constructor=c,c.prototype.getDefaults=function(){return c.DEFAULTS},c.prototype.setContent=function(){var a=this.tip(),b=this.getTitle(),c=this.getContent();a.find(".popover-title")[this.options.html?"html":"text"](b),a.find(".popover-content").children().detach().end()[this.options.html?"string"==typeof c?"html":"append":"text"](c),a.removeClass("fade top bottom left right in"),a.find(".popover-title").html()||a.find(".popover-title").hide()},c.prototype.hasContent=function(){return this.getTitle()||this.getContent()},c.prototype.getContent=function(){var a=this.$element,b=this.options;return a.attr("data-content")||("function"==typeof b.content?b.content.call(a[0]):b.content)},c.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")};var d=a.fn.popover;a.fn.popover=b,a.fn.popover.Constructor=c,a.fn.popover.noConflict=function(){return a.fn.popover=d,this}}(jQuery)},function(a,b,c){var d=c(53),e=c(96),f=c(40),g=c(2),h=c(37)("print"),i=c(41),j=c(36);a.exports=d.extend({channelName:"print",initialize:function(){g.bindAll(this,"mediaQueryListener","beforePrint","afterPrint"),this.start()},onStart:function(){this.channel.reply({print:this.print},this)},onStop:function(){this.channel.reset()},print:function(a){var b=this.template(a),c=this.init();this.deferred=f.Deferred(),c.document.write(b),c.onbeforeprint=this.beforePrint,c.onafterprint=this.afterPrint;var d=function(){c.focus(),c.print()},e=c.document.getElementsByTagName("img")[0];return e?e.onload=d:d(),this.deferred},init:function(){if(this.iframe&&this.iframe.remove(),this.iframe=f("<iframe>").attr("name","iframe").css({visibility:"hidden",position:"-fixed",right:"0",bottom:"0"}).appendTo("body"),frames.iframe.matchMedia){var a=frames.iframe.matchMedia("print");a.addListener(this.mediaQueryListener)}return frames.iframe},mediaQueryListener:function(a){a.matches?this.beforePrint():g.delay(this.afterPrint)},beforePrint:function(){h("printing ...")},afterPrint:function(){this.iframe.remove(),this.iframe=void 0,h("printing finished"),this.deferred.resolve()},template:function(a){if(a=a||{},a.model){var b=e.compile(f("#tmpl-print-receipt").html()),c=i.request("entities","get",{type:"option",name:"tax"})||{},d=j.ReceiptView.prototype.prepare(a.model.toJSON(),c);return b(d)}}})},function(a,b,c){var d=c(53),e=c(196);a.exports=d.extend({channelName:"numpad",initialize:function(){this.channel.reply({view:this.view},this)},view:function(a){var b=new e(a);return b}})},function(a,b,c){var d=c(123),e=c(36),f=c(96),g=c(197),h=c(198),i=c(2),j=c(40),k=c(48),l=c(41),m=c(199),n=c(200),o=c(81),p={amount:function(){return{left:{addOn:this.symbol}}},discount:function(){return{left:{btn:this.symbol},right:{btn:"%"},toggle:!0}},cash:function(){return{left:{addOn:this.symbol}}},quantity:function(){return{left:{btn:'<i class="icon icon-minus"></i>'},right:{btn:'<i class="icon icon-plus"></i>'}}}},q={amount:function(){},discount:function(){var a=l.request("entities","get",{type:"option",name:"discount_keys"})||{};return i.map(a,function(a){return a+"%"})},cash:function(a){var b=l.request("entities","get",{type:"option",name:"denominations"})||{};return i.map(n(a,b),function(a){return 0===this.value?a:o.formatNumber(a)},this)},quantity:function(){}},r=d.extend({template:f.compile(g),viewOptions:["numpad","label","value","decimal","symbol"],initialize:function(a){a=a||{},a=i.defaults(a,{label:"Numpad",numpad:"amount",value:0,decimal:k.settings.currency.decimal,symbol:k.settings.currency.symbol}),this.mergeOptions(a,this.viewOptions),this.model=new h({},a)},behaviors:{AutoGrow:{behaviorClass:m}},bindings:{'input[name="value"]':{observe:["value","percentage","active"],onGet:function(a){var b,c="percentage"===a[2]?a[1]:a[0];return("percentage"===a[2]||"quantity"===this.numpad)&&(b="auto"),o.formatNumber(c,b)}},'.numpad-discount [data-btn="left"]':{updateMethod:"html",observe:["value","percentage","active"],onGet:function(a){return"percentage"===a[2]?o.formatMoney(a[0]):this.symbol}},'.numpad-discount [data-btn="right"]':{updateMethod:"html",observe:["percentage","value","active"],onGet:function(a){return"percentage"===a[2]?"%":k.toFixed(a[0],0)+"%"}}},templateHelpers:function(){var a={numpad:this.numpad,label:this.label,input:p[this.numpad].call(this),keys:q[this.numpad].call(this,this.value),decimal:this.decimal,"return":"return"};return a},ui:{input:'.numpad-header input[name="value"]',toggle:".numpad-header .input-group",common:".numpad-keys .common .btn",discount:".numpad-keys .discount .btn",cash:".numpad-keys .cash .btn",keys:".numpad-keys .btn"},events:{"click @ui.toggle a":"toggle","click @ui.common":"commonKeys","click @ui.discount":"discountKeys","click @ui.cash":"cashKeys","mousedown @ui.keys":"keyPress"},toggle:function(a){a.preventDefault();var b=j(a.currentTarget).data("btn");"quantity"===this.numpad&&this.model.quantity("right"===b?"increase":"decrease"),"discount"===this.numpad&&(this.ui.toggle.toggleClass("toggle"),this.model.toggle("percentage"))},commonKeys:function(a){a.preventDefault();var b=j(a.currentTarget).data("key");switch(b){case"ret":return void this.trigger("input",this.model.getFloatValue(),this.model);case"del":this._hasSelection&&this.model.clearInput(),this.model.backSpace();break;case"+/-":this.model.plusMinus();break;case".":this.model.decimal();break;default:this._hasSelection&&this.model.clearInput(),this.model.key(b)}},discountKeys:function(a){a.preventDefault();var b=j(a.currentTarget).data("key");this.model.set("active","percentage"),this.model.set("percentage",b.replace("%","")),this.ui.toggle.addClass("toggle")},cashKeys:function(a){a.preventDefault();var b=j(a.currentTarget).data("key");b=o.unformat(b),this.model.clearInput().key(b)},keyPress:function(){var a=window.getSelection();this._hasSelection=a.toString()===this.ui.input.val()}});a.exports=r,e.attach("Components.Numpad.View",r)},function(a,b){a.exports='<div class="numpad numpad-{{numpad}}">\n  <div class="numpad-header">\n    <strong class="title">{{label}}</strong>\n\n    {{#if input}}\n      <div class="input-group {{#if input.toggle}}input-toggle{{/if}}">\n        {{#if input.left}}\n          {{#if input.left.addOn}}<span class="input-group-addon">{{{input.left.addOn}}}</span>{{/if}}\n          {{#if input.left.btn}}<span class="input-group-btn"><a href="#" data-btn="left">{{{input.left.btn}}}</a></span>{{/if}}\n        {{/if}}\n        <input type="text" name="value" class="form-control autogrow" readonly="readonly">\n        {{#if input.right}}\n          {{#if input.right.btn}}<span class="input-group-btn"><a href="#" data-btn="right">{{{input.right.btn}}}</a></span>{{/if}}\n          {{#if input.right.addOn}}<span class="input-group-addon">{{{input.right.addOn}}}</span>{{/if}}\n        {{/if}}\n      </div>\n    {{/if}}\n\n  </div>\n\n  <div class="numpad-keys">\n    <div class="keys common">\n      <div class="row">\n        <a href="#" data-key="1" class="btn">1</a>\n        <a href="#" data-key="2" class="btn">2</a>\n        <a href="#" data-key="3" class="btn">3</a>\n      </div>\n      <div class="row">\n        <a href="#" data-key="4" class="btn">4</a>\n        <a href="#" data-key="5" class="btn">5</a>\n        <a href="#" data-key="6" class="btn">6</a>\n      </div>\n      <div class="row">\n        <a href="#" data-key="7" class="btn">7</a>\n        <a href="#" data-key="8" class="btn">8</a>\n        <a href="#" data-key="9" class="btn">9</a>\n      </div>\n      <div class="row">\n        <a href="#" data-key="0" class="btn">0</a>\n        <a href="#" data-key="00" class="btn">00</a>\n        <a href="#" data-key="." class="btn decimal">{{{decimal}}}</a>\n      </div>\n    </div>\n    <div class="keys common extra-keys">\n      <a href="#" data-key="del" class="btn"><i class="icon icon-delete"><span>del</span></i></a>\n      <a href="#" data-key="+/-" class="btn">+/-</a>\n      <a href="#" data-key="ret" class="btn return">{{return}}</a>\n    </div>\n\n    {{#if keys}}\n      <div class="keys extra-keys {{numpad}}">\n        {{#each keys}}\n          <a href="#" data-key="{{this}}" class="btn">{{this}}</a>\n        {{/each}}\n      </div>\n    {{/if}}\n\n  </div>\n</div>'},function(a,b,c){var d=c(45),e=c(2);a.exports=d.Model.extend({dec:"",defaults:{active:"value"},precision:4,initialize:function(a,b){b=b||{},this.numpad=b.numpad,this.set({value:b.value.toString()}),b.precision&&(this.precision=b.precision),b.original&&this.initPercentage(b)},initPercentage:function(a){"off"===a.percentage&&(this.percentageOff=!0),this.set({original:a.original.toString()}),this.set({percentage:this.calcPercentage()}),this.on({"change:value":function(){this.set({percentage:this.calcPercentage()},{silent:!0})},"change:percentage":function(){this.set({value:this.calcValue()},{silent:!0})}})},getFloatValue:function(){return parseFloat(this.get("value"))},getActive:function(a){var b=this.get(this.get("active"));return"float"===a?parseFloat(b):b.toString()},setActive:function(a){"."===this.dec&&(this.dec=""),e.isNaN(a)&&(a=0),this.set(this.get("active"),this.round(a))},backSpace:function(){var a=this.getActive().slice(0,-1);return"."===a.slice(-1)&&(a=a.slice(0,-1)),this.setActive(a),this},plusMinus:function(){var a=-1*this.getActive("float");return this.setActive(a),this},clearInput:function(){return this.setActive(""),this},key:function(a){var b=this.getActive();return this.decimalPlaces(b)<this.precision&&this.setActive(b+this.dec+a),this},decimal:function(){return this.dec=-1===this.getActive().indexOf(".")?".":"",this},quantity:function(a){var b=this.getActive("float");return this.setActive("increase"===a?++b:--b),this},calcPercentage:function(){var a=parseFloat(this.get("value")),b=parseFloat(this.get("original")),c=a/b*100;return this.percentageOff?this.round(100-c):this.round(c)},calcValue:function(){var a=parseFloat(this.get("percentage")),b=parseFloat(this.get("original")),c=a/100;return this.percentageOff?this.round((1-c)*b):this.round(c*b)},toggle:function(a){this.set({active:a===this.get("active")?"value":a})},round:function(a){return a=a.toString(),this.decimalPlaces(a)>this.precision&&(a=parseFloat(a).toFixed(this.precision),a=parseFloat(a).toString()),a},decimalPlaces:function(a){return a.replace(/^-?\d*\.?|0+$/g,"").length}})},function(a,b,c){var d=c(114),e=c(40),f=c(2),g=c(36),h=d.extend({initialize:function(a){this.options=a||{},f.defaults(this.options,{padding:20}),this.tester=e("#autogrow-tester"),0===this.tester.length&&(this.tester=e('<div id="autogrow-tester" />').css({opacity:0,top:-9999,left:-9999,position:"absolute",whiteSpace:"nowrap"}),e("body").append(this.tester))},ui:{target:".autogrow"},events:{"input @ui.target":"autoGrow"},onShow:function(){f.each(this.ui.target,function(a){this.autoGrow(e(a))},this)},autoGrow:function(a){var b=a.target?e(a.target):a,c=b.is("input")?b.val():b.text();c=c.replace(/&/g,"&amp;").replace(/\s/g,"&nbsp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),this.tester.html(c);var d=this.tester.width()+this.options.padding;b.css({width:d})}});a.exports=h,g.attach("Behaviors.AutoGrow",h)},function(a,b,c){function d(a){return parseFloat(g.toFixed(a,2))}function e(a,b){var c=Math.ceil(a/b)*b;return d(c)}var f=c(2),g=c(48);a.exports=function(a,b){var c=[a];return 0===a?b.notes.slice(-4):(f.pull(b.coins,.01,.02),f.each(b.coins,function(b){c.push(e(a,b))}),c=f.chain(c).uniq().sortBy().value(),a>b.notes[0]&&c.slice(0,3),f.each(b.notes,function(b){c.push(e(a,b))}),f.chain(c).uniq().sortBy().value().slice(1,5))}},function(a,b,c){var d=c(36),e=c(116),f=c(202),g=c(203),h=c(216),i=c(225),j=c(233),k=c(41),l=c(45),m=e.extend({routes:{"(cart)(/:id)(/)":"showCart","checkout(/:id)(/)":"showCheckout","receipt(/:id)(/)":"showReceipt"},initialize:function(a){this.container=a.container,this.channel.reply({"show:cart":this.showCart,"show:checkout":this.showCheckout,"show:receipt":this.showReceipt,"add:to:cart":this.addToCart},this)},onBeforeEnter:function(){this.layout=new f,this.container.show(this.layout),this.initOrders()},initOrders:function(){this.orders||(this.orders=k.request("entities","get",{type:"collection",name:"orders"}),this.listenTo(this.orders,{add:this.addOrder,remove:this.removeOrder}))},onBeforeRoute:function(){this.showProducts(),k.request("header","update:title","")},setActiveTab:function(){var a=""===l.history.getFragment()?"left":"right";this.container.tabs.setActive(a)},showProducts:function(){if(!this.layout.getRegion("left").hasView()){var a=new g({container:this.layout.getRegion("left")});a.enter()}},showCart:function(){return new h({container:this.layout.getRegion("right"),collection:this.orders})},showCheckout:function(){return new i({container:this.layout.getRegion("right"),collection:this.orders})},showReceipt:function(){var a=k.request("entities","get",{type:"option",name:"auto_print"});return new j({container:this.layout.getRegion("right"),collection:this.orders,autoPrint:a})},addToCart:function(a){this._currentRoute instanceof h&&this.orders.addToCart(a)},addOrder:function(a){this._currentRoute instanceof h&&a.isEditable()&&this.execute(this.showCart,[a.id])},removeOrder:function(){this._currentRoute instanceof h&&(l.history.navigate(""),this.execute(this.showCart))}});a.exports=m,d.attach("POSApp.Router",m)},function(a,b,c){var d=c(47);a.exports=d.extend({columns:2,template:function(){return'<div id="left"></div><div id="right"></div>'},regions:{left:"#left",right:"#right"}})},function(a,b,c){var d=c(117),e=c(204),f=c(205),g=c(207),h=c(215),i=c(41),j=c(2),k=c(49);a.exports=d.extend({initialize:function(a){this.container=a.container,this.filtered=i.request("entities","get",{type:"filtered",name:"products",perPage:10}),this.setTabLabel({tab:"left",label:k.t("titles.products")})},fetch:function(){var a=this.filtered.superset();return a.isNew()?a.fetch().then(function(){a.fullSync()}):void this.filtered.resetFilters().removeSort().setPage(0)},render:function(){this.layout=new e,this.listenTo(this.layout,"show",function(){this.showActions(),this.showTabs(),this.showProducts(),this.showPagination()}),this.container.show(this.layout)},showActions:function(){var a=new f({collection:this.filtered});this.layout.getRegion("actions").show(a)},showTabs:function(){var a=i.request("tabs","view",{tabs:this.tabsArray()});this.listenTo(a.collection,"active:tab",function(a){this.filtered.query("tab",a.id)}),this.layout.getRegion("tabs").show(a),this.tabs=a},showProducts:function(){var a=new g({collection:this.filtered});this.layout.getRegion("list").show(a)},tabsArray:function(){var a=i.request("entities","get",{type:"option",name:"tabs"});return j.map(a)},showPagination:function(){var a=new h({collection:this.filtered});this.layout.getRegion("footer").show(a)}})},function(a,b,c){var d=c(96),e=c(47),f=c(36),g=e.extend({template:d.compile('<div class="list-actions"></div><div class="list-tabs tabs infinite-tabs"></div><div class="list"></div><div class="list-footer"></div>'),tagName:"section",regions:{actions:".list-actions",tabs:".list-tabs",list:".list",footer:".list-footer"},attributes:{"class":"module products-module"}});a.exports=g,f.attach("POSApp.Products.Layout",g)},function(a,b,c){var d=c(95),e=c(36),f=c(206),g=c(151),h=c(41),i=d.extend({template:"#tmpl-products-filter",initialize:function(){var a=this.collection,b=this;this.listenTo(a.superset(),"match:barcode",function(c){a.once("paginated:change:page",function(){b.triggerMethod("clear")}),h.request("router","add:to:cart",c)})},behaviors:{Filter:{behaviorClass:f},HotKeys:{behaviorClass:g}},keyEvents:{search:"barcodeModeOff",barcode:"barcodeModeOn"},ui:{modeIcon:'*[data-toggle="dropdown"] i',searchBtn:'*[data-action="search"]',barcodeBtn:'*[data-action="barcode"]',searchField:"input[type=search]"},events:{"click @ui.searchBtn":"barcodeModeOff","click @ui.barcodeBtn":"barcodeModeOn"},onRender:function(){this.barcodeModeOff()},toggleBarcodeMode:function(){return"barcode"===this._mode?this.barcodeModeOff():void this.barcodeModeOn()},barcodeModeOn:function(a){a&&a.preventDefault(),this._mode="barcode",this.ui.modeIcon.removeClass("icon-search").addClass("icon-barcode"),this.ui.searchField.attr("placeholder",this.ui.barcodeBtn.text()).focus().trigger("keyup")},barcodeModeOff:function(a){a&&a.preventDefault(),this._mode=void 0,this.ui.modeIcon.removeClass("icon-barcode").addClass("icon-search"),this.ui.searchField.attr("placeholder",this.ui.searchBtn.text()).focus().trigger("keyup")}});a.exports=i,e.attach("POSApp.Products.Actions",i)},function(a,b,c){var d=c(114),e=c(2),f=c(36),g=c(152),h=c(41),i=d.extend({initialize:function(){this.listenTo(this.view.options.collection.superset(),{"start:fullSync":this.syncStart,"end:fullSync":this.syncEnd}),this.hotkeys=h.request("entities","get",{type:"option",name:"hotkeys"})||{},this.combokeys=new g(document.documentElement),this.combokeys.bind(this.hotkeys.sync.key,e.bind(this.sync,this))},ui:{searchField:"input[type=search]",clearBtn:"a.clear",sync:'*[data-action="sync"]'},events:{"keyup @ui.searchField":"query","click @ui.clearBtn":"clear","click @ui.sync":"sync"},query:function(){var a=this.ui.searchField.val();return""===a?this.clear():(this.view._mode&&(a=[{type:"prefix",prefix:this.view._mode,query:a}]),this.ui.clearBtn.show(),void this._query(a))},_query:e.debounce(function(a){this.view.collection.query(a).firstPage()},149),clear:function(a){a&&a.preventDefault(),this.view.collection.removeFilter("search"),this.ui.searchField.val(""),this.ui.clearBtn.hide()},onRender:function(){if(this.view.collection.hasFilter("search")){var a=this.view.collection._filtered._query;a&&this.ui.searchField.val(a).trigger("keyup")}},sync:function(a){a&&a.preventDefault(),this.view.collection.superset().fullSync()},syncStart:function(){this.ui.sync.children("i").addClass("icon-spin")},syncEnd:function(){this.ui.sync.children("i").removeClass("icon-spin")},onDestroy:function(){this.combokeys.unbind(this.hotkeys.sync.key)},onClear:function(){this.clear()}});a.exports=i,f.attach("Behaviors.Filter",i)},function(a,b,c){var d=c(95),e=c(208),f=c(209),g=c(36),h=d.extend({tagName:"li",className:"empty",template:"#tmpl-products-empty"}),i=e.extend({childView:f,emptyView:h,childViewContainer:"ul"});a.exports=i,g.attach("POSApp.Products.List",i)},function(a,b,c){var d=c(44),e=c(36),f=c(2);a.exports=e.InfiniteListView=d.CompositeView.extend({className:"infinite-list",template:function(){return'<div></div><ul class="striped"></ul><div><i class="icon icon-spinner"></i>'},initialize:function(){this.listenTo(this.collection.superset(),{"start:processQueue":this.startLoading,"end:processQueue":this.endLoading,"end:fullSync":this.checkOverflow}),this.on({all:this.checkOverflow}),f.bindAll(this,"onScroll","loadMore","getOverflow")},onShow:function(){this._parent.$el.scroll(this.onScroll)},onScroll:f.throttle(function(){this.getOverflow()<100&&this.loadMore()},200),checkOverflow:f.debounce(function(){this.getOverflow()<100&&this.loadMore()},200),getOverflow:function(){if(this._parent&&this._parent.el.clientHeight){var a=this._parent.el.scrollHeight,b=this._parent.el.clientHeight,c=this._parent.el.scrollTop;return a-b-c}},loadMore:function(){return this.collection.hasNextPage()?this.collection.appendNextPage():void(this.collection.superset().queue.length>0&&this.remoteFetchMore())},remoteFetchMore:function(){this.collection.superset().processQueue({filter:this.collection.getRemoteFilter()})},startLoading:function(){this.toggleLoading(!0)},endLoading:function(){this.toggleLoading(!1)},toggleLoading:function(a){this.$el.toggleClass("loading",a)}})},function(a,b,c){var d=c(36),e=c(47),f=c(210),g=c(213),h=e.extend({tagName:"li",className:function(){return this.model.get("type")},template:function(){return'<div class="item"></div><div class="drawer"></div>'},regions:{item:".item",drawer:".drawer"},onRender:function(){var a=new f({model:this.model});this.listenTo(a,{"open:drawer":this.openDrawer,"close:drawer":this.closeDrawer,"toggle:drawer":this.toggleDrawer}),this.getRegion("item").show(a)},openDrawer:function(a){a=a||{},a.model=this.model,a.className="variations";var b=new g(a);this.getRegion("drawer").show(b),this.$el.addClass("drawer-open")},closeDrawer:function(){var a=this.getRegion("drawer");a.$el.slideUp(250,function(){a.empty(),a.$el.show()}),this.$el.removeClass("drawer-open")},toggleDrawer:function(a){var b=this.getRegion("drawer"),c=b.hasView();return c&&a.filter?b.currentView.filterVariations(a.filter):void(c?this.closeDrawer():this.openDrawer(a))}});a.exports=h,d.attach("POSApp.Products.Item.Layout",h)},function(a,b,c){var d=c(95),e=c(36),f=c(96),g=c(40),h=c(2),i=c(128),j=c(41),k=c(211),l=d.extend({template:f.compile(g("#tmpl-product").html()),ui:{add:'a[data-action="add"]',vpopover:'a[data-action="variations"]',vdrawer:".title dl.variations dd a"},events:{"click @ui.add":"addToCart","click @ui.vpopover":"variationsPopover","click @ui.vdrawer":"variationsDrawer"},modelEvents:{"change:updated_at":"render"},behaviors:{Tooltip:{behaviorClass:i,html:!0}},addToCart:function(a){a.preventDefault(),j.request("router","add:to:cart",{model:this.model})},variationsPopover:function(a){a.preventDefault();var b=new k({model:this.model});this.listenTo(b,"add:to:cart",function(a){var b=a.collection.models[0].toJSON();j.request("router","add:to:cart",b),j.request("popover","close")});var c=h.extend({view:b,parent:this,model:this.model,target:g(a.currentTarget)},b.popover);j.request("popover","open",c)},variationsDrawer:function(a){a.preventDefault();var b={},c=g(a.target).data("name");c&&(b.filter={name:c,option:g(a.target).text()}),this.trigger("toggle:drawer",b)},templateHelpers:function(){var a=this.model.getVariations(),b=a?{price:a.superset().range("price"),sale_price:a.superset().range("sale_price"),regular_price:a.superset().range("regular_price"),product_variations:this.model.getVariationOptions()}:{};return b.product_attributes=this.model.productAttributes(),b}});a.exports=l,e.attach("POSApp.Products.Item",l)},function(a,b,c){var d=c(95),e=c(212),f=c(36),g=c(96),h=c(2),i=c(40),j=c(49),k=function(a){var b=a.options.length,c=a.options.reduce(function(a,b){return a+b.length},0);return 26*b+5*c>220},l=d.extend({template:g.compile(e),popover:{className:"popover popover-variations popover-dark-bg"},initialize:function(){this.collection=this.model.getVariations(),this.collection.resetFilters()},templateHelpers:function(){var a={};return a.variations=h.chain(this.model.get("attributes")).where({variation:!0}).sortBy(function(a){return k(a)&&(a.select=!0,a.emptyOption=j.t("messages.choose")),a.position}).value(),a},ui:{add:'*[data-action="add"]',btn:".btn-group .btn",select:"select"},triggers:{"click @ui.add":"add:to:cart"},events:{"click @ui.btn":"onVariationSelect","change @ui.select":"onVariationSelect"},onVariationSelect:function(a){var b=i(a.currentTarget);b.is("button")&&b.addClass("active").siblings(".btn").removeClass("active");var c=b.data("name"),d=b.val();this.collection.filterBy(c,function(a){return h.some(a.get("attributes"),function(a){return a.name===c&&a.option===d})}),this.ui.add.prop("disabled",1!==this.collection.length)}});a.exports=l,f.attach("POSApp.Products.Variations",l)},function(a,b){a.exports='{{#variations}}\n  <strong>{{name}}</strong>\n  {{#unless this.select}}\n    <div class="btn-group" data-toggle="buttons">\n    {{#each options}}\n      <button class="btn btn-default" value="{{this}}" data-name="{{../name}}">{{this}}</button>\n    {{/each}}\n    </div>\n  {{/unless}}\n  {{#if this.select}}\n    <select data-name="{{name}}">\n      <option value="">{{this.emptyOption}}</option>\n    {{#each options}}\n      <option value="{{this}}">{{this}}</option>\n    {{/each}}\n    </select>\n  {{/if}}\n{{/variations}}\n<button class="btn btn-success" data-action="add" disabled>Add to Cart</button>'},function(a,b,c){var d=c(95),e=c(105),f=c(214),g=c(2),h=d.extend({tagName:"li",className:"empty",template:"#tmpl-products-empty"});a.exports=e.extend({childView:f,emptyView:h,childViewContainer:"ul",initialize:function(a){a=a||{},this.collection=this.model.getVariations(),this.collection.resetFilters(),this.filterVariations(a.filter)},onShow:function(){this.$el.hide().slideDown(250)},filterVariations:function(a){if(a){a=a||{};var b=function(b){var c=b.get("attributes");return g.any(c,function(b){return b.name===a.name&&b.option===a.option})};this.collection.filterBy("variation",b)}}})},function(a,b,c){var d=c(95),e=c(36),f=c(96),g=c(40),h=c(41),i=d.extend({template:f.compile(g("#tmpl-product").html()),className:"variation",ui:{add:'a[data-action="add"]'},events:{"click @ui.add":"addToCart"},modelEvents:{"change:stock_quantity":"render"},addToCart:function(a){a.preventDefault(),h.request("router","add:to:cart",{model:this.model})},templateHelpers:function(){return{variation:!0,title:this.options.model.parent.get("title")}}});a.exports=i,e.attach("POSApp.Products.Item.Drawer.Variation",i)},function(a,b,c){var d=c(95),e=c(36),f=c(40),g=c(2),h=c(96),i=d.extend({template:h.compile(f("#tmpl-pagination").html()),collectionEvents:{"add remove paginated:change:page paginated:change:numPages reset":g.debounce(function(){this.isDestroyed||this.render()},10)},initialize:function(){this.listenTo(this.collection.superset(),{"end:fullSync":this.render})},templateHelpers:function(){var a=this.collection.superset().queue.length;return{showing:this.collection.length,local:this.collection.superset().length,queue:a,hasQueue:a>0}}});a.exports=i,e.attach("Components.Pagination.View",i)},function(a,b,c){var d=c(117),e=c(217),f=c(218),g=c(223),h=c(224),i=c(111),j=c(130),k=c(2),l=c(36),m=c(81),n=c(49),o=d.extend({initialize:function(a){a=a||{},this.container=a.container,this.collection=a.collection,this.setTabLabel({tab:"right",label:n.t("titles.cart")})},fetch:function(){return this.collection.isNew()?this.collection.fetch({silent:!0}):void 0},onFetch:function(a){this.order=this.collection.setActiveOrder(a),this.order&&(this.setTabLabel({tab:"right",
label:this.tabLabel(this.order)}),this.listenTo(this.order,"change:total",function(a){this.setTabLabel({tab:"right",label:this.tabLabel(a)})}))},render:function(){this.layout=new e({order:this.order}),this.listenTo(this.layout,"show",this.onShow),this.container.show(this.layout)},onRender:function(){this.order&&!this.order.isEditable()&&this.navigate("receipt/"+this.order.id,{trigger:!0})},onShow:function(){return this.order?(this.showCart(),this.showTotals(),this.showCustomer(),this.showActions(),void this.showNotes()):this.noActiveOrder()},noActiveOrder:function(){var a=new f;this.layout.getRegion("list").show(a),k.invoke([this.layout.getRegion("totals"),this.layout.getRegion("customer"),this.layout.getRegion("actions"),this.layout.getRegion("note")],"empty")},showCart:function(){var a=new f({collection:this.order.cart});this.layout.getRegion("list").show(a)},showTotals:function(){var a=new g({model:this.order});this.on("discount:clicked",a.showDiscountRow),this.layout.getRegion("totals").show(a)},showCustomer:function(){var a=new j({model:this.order});this.listenTo(a,"customer:select",function(a){this.order.unset("customer"),this.order.save({customer_id:a.id,customer:a})}),this.listenTo(this.layout.getRegion("customer"),"before:show",function(){var b=this.layout.getRegion("customer").$el.html();a.$el.prepend(b)}),this.layout.getRegion("customer").show(a)},showActions:function(){var a=new i({buttons:[{action:"void",className:"btn-danger pull-left"},{action:"fee",className:"btn-primary"},{action:"shipping",className:"btn-primary"},{action:"note",className:"btn-primary"},{action:"checkout",className:"btn-success"}]});this.listenTo(a,{"action:void":function(a,b){b.triggerMethod("disableButtons"),this.layout.getRegion("list").currentView.voidCart(this.order)},"action:note":function(){this.layout.getRegion("note").currentView.showNoteField()},"action:fee":function(){this.order.cart.addToCart({type:"fee",title:n.t("titles.fee")})},"action:shipping":function(){this.order.cart.addToCart({type:"shipping",method_title:n.t("titles.shipping"),method_id:""})},"action:checkout":function(){this.navigate("checkout/"+this.order.id,{trigger:!0})}}),this.layout.getRegion("actions").show(a)},showNotes:function(){var a=new h({model:this.order});this.on("note:clicked",a.showNoteField),this.layout.getRegion("note").show(a)},tabLabel:function(a){var b=n.t("titles.cart"),c=a.get("total"),d=m.formatMoney(c);return b+": "+d}});a.exports=o,l.attach("POSApp.Cart.Route",o)},function(a,b,c){var d=c(47);a.exports=d.extend({template:"#tmpl-cart",initialize:function(a){a=a||{},this.order=a.order},tagName:"section",regions:{list:".list",totals:".list-totals",customer:".cart-customer",actions:".list-actions",note:".cart-notes",footer:".list-footer"},attributes:{"class":"module cart-module"},onShow:function(){this.$el.toggleClass("cart-empty",!this.order)}})},function(a,b,c){var d=c(95),e=c(105),f=c(219),g=c(36),h=d.extend({tagName:"li",className:"empty",template:"#tmpl-cart-empty"}),i=e.extend({tagName:"ul",childView:f,emptyView:h,voidCart:function(a){this.children.each(function(b){b instanceof h?a.destroy():b.getRegion("item").currentView.removeItem()})}});a.exports=i,g.attach("POSApp.Cart.Views.Items",i)},function(a,b,c){var d=c(47),e=c(220),f=c(222);a.exports=d.extend({tagName:"li",className:function(){return this.model.get("type")},template:function(){return'<div class="item"></div><div class="drawer"></div>'},regions:{item:".item",drawer:".drawer"},modelEvents:{pulse:"pulse"},onRender:function(){var a=new e({model:this.model});this.listenTo(a,"drawer:open",this.openDrawer),this.listenTo(a,"drawer:close",this.closeDrawer),this.listenTo(a,"drawer:toggle",this.toggleDrawer),this.getRegion("item").show(a)},openDrawer:function(){var a=new f({model:this.model});this.getRegion("drawer").show(a),this.$el.addClass("drawer-open")},closeDrawer:function(){this.getRegion("drawer").empty(),this.$el.removeClass("drawer-open")},toggleDrawer:function(){this.getRegion("drawer").hasView()?this.closeDrawer():this.openDrawer()},pulse:function(a){if("remove"!==a){var b=this,c=this.$el.closest(".list"),d=c.scrollTop(),e=c.position().top,f=c.height()+e,g=this.$el.position().top,h=this.$el.height()+g,i=b.model.get("type");e>g&&(d-=e-g),h>f&&(d+=g-c.height()+4),this.$el.addClass("bg-success").closest(".list").animate({scrollTop:d},"fast",function(){("fee"===i||"shipping"===i)&&b.$(".title strong.action-edit-title").focus(),b.$el.animate({backgroundColor:"transparent"},500,function(){b.$el.removeClass("bg-success").removeAttr("style")})})}}})},function(a,b,c){var d=c(123),e=c(81),f=c(45),g=f.Radio,h=c(199),i=c(221),j=c(96),k=c(40),l=c(2);a.exports=d.extend({template:j.compile(k("#tmpl-cart-item").html()),initialize:function(){this.tax=g.request("entities","get",{type:"option",name:"tax"})||{}},templateHelpers:function(){var a=this.model.get("type");return{product:"shipping"!==a&&"fee"!==a}},behaviors:{AutoGrow:{behaviorClass:h},Numpad:{behaviorClass:i}},ui:{remove:'*[data-action="remove"]',more:'*[data-action="more"]',title:".title"},events:{"click @ui.remove":"removeItem","click @ui.title":"focusTitle"},triggers:{"click @ui.more":"drawer:toggle"},modelEvents:{"change:title":"save","change:method_title":"save"},bindings:{'input[name="quantity"]':{observe:"quantity",onGet:function(a){return e.formatNumber(a,"auto")},onSet:e.unformat},'*[data-name="title"]':{observe:"title",events:["blur"]},"dl.meta":{observe:"meta",updateMethod:"html",onGet:function(a){var b="";return l.each(a,function(a){b+="<dt>"+a.label+":</dt><dd>"+a.value+"</dd>"}),b}},'*[data-name="method_title"]':"method_title",'input[name="item_price"]':{observe:"item_price",onGet:e.formatNumber,onSet:e.unformat},".total":{observe:["total","subtotal","tax_class","taxable"],updateMethod:"html",onGet:function(a){"incl"===this.tax.tax_display_cart&&(a[0]=this.model.sum(["total","total_tax"]),a[1]=this.model.sum(["subtotal","subtotal_tax"]));var b=e.formatMoney(a[0]),c=e.formatMoney(a[1]);return b!==c?"<del>"+c+"</del> <ins>"+b+"</ins>":b}}},save:function(){console.log(arguments),this.model.save()},removeItem:function(a){a&&a.preventDefault();var b=this;this.ui.remove.attr("disabled","true"),this.$el.addClass("bg-danger").fadeOut(500,function(){b.model.destroy()})},focusTitle:function(){this.ui.title.find("strong").focus()}})},function(a,b,c){(function(b){var d=c(114),e=c(36),f=b.Modernizr,g=c(41),h=c(40),i=c(2),j=d.extend({ui:{target:"*[data-numpad]"},events:{"click @ui.target":"numpadPopover","open:numpad @ui.input":"numpadPopover","keypress @ui.target":"keyboardEntry"},onRender:function(){f.touch&&this.ui.target.each(function(){h(this).is("input")&&h(this).attr("readonly",!0)})},numpadPopover:function(a){var b=h(a.target),c=b.attr("name"),d=i.clone(b.data());i.defaults(d,{value:this.view.model.get(c)}),i.isString(d.original)&&(d.original=this.view.model.get(d.original));var e=g.request("numpad","view",d);this.listenTo(e,"input",function(a){b.popover("hide"),this.view.model.set(c,a,{numpadChange:!0})}),b.one("shown.bs.popover",function(){f.touch||e.ui.input.select()}),i.defaults(d,{target:b,view:e,parent:this.view,className:"popover popover-numpad popover-dark-bg",placement:"bottom"}),g.request("popover","open",d)},keyboardEntry:function(a){var b=h(a.target);b.data("popoverOpen")&&(b.one("hidden.bs.popover",function(){b.val(String.fromCharCode(a.keyCode)).trigger("input")}),b.popover("hide"))}});a.exports=j,e.attach("Behaviors.Numpad",j)}).call(b,function(){return this}())},function(a,b,c){var d=c(123),e=c(81),f=c(199),g=c(221),h=c(96),i=c(40),j=c(2),k=c(45),l=k.Radio;a.exports=d.extend({initialize:function(){this.template=h.compile(i("#tmpl-cart-item-drawer").html())},behaviors:{AutoGrow:{behaviorClass:f},Numpad:{behaviorClass:g}},ui:{addMeta:".action-add-meta",removeMeta:".action-remove-meta",metaLabel:'input[name="meta.label"]',metaValue:'textarea[name="meta.value"]'},events:{"click @ui.addMeta":"addMetaFields","click @ui.removeMeta":"removeMetaFields","blur @ui.metaLabel":"updateMeta","blur @ui.metaValue":"updateMeta"},modelEvents:{pulse:"pulse"},bindings:{'input[name="regular_price"]':{observe:"regular_price",onGet:e.formatNumber,onSet:e.unformat},'input[name="taxable"]':"taxable",'select[name="tax_class"]':{observe:"tax_class",selectOptions:{collection:function(){return l.request("entities","get",{type:"option",name:"tax_classes"})}},attributes:[{name:"disabled",observe:"taxable",onGet:function(a){return!a}}]},'select[name="method_id"]':{observe:"method_id",selectOptions:{collection:function(){return l.request("entities","get",{type:"option",name:"shipping"})},comparator:function(){}}}},onShow:function(){this.$el.hide().slideDown(250)},remove:function(){this.$el.slideUp(250,function(){d.prototype.remove.call(this)}.bind(this))},pulse:function(a){return"remove"===a?this.$el.slideUp(250):void 0},updateMeta:function(a){var b=i(a.target),c=b.attr("name").split("."),d=c[0],e=b.val(),f={},g=this,h=function(){var a=b.parent("span").data("key"),d=g.model.get("meta")||[],f=j.where(d,{key:a});return f=f.length>0?f[0]:{key:a},f[c[1]]=e,d.push(f),j.uniq(d,"key")};c.length>1&&"meta"===d&&(e=h()),f[d]=e,this.model.save(f)},addMetaFields:function(a){a.preventDefault();var b=i(a.currentTarget).prev("span").data("key"),c=b?b+1:1;i('<span data-key="'+c+'" />').append('<input type="text" name="meta.label"><textarea name="meta.value"></textarea><a href="#" class="action-remove-meta"><i class="icon icon-times"></i></a>').insertBefore(i(a.currentTarget))},removeMetaFields:function(a){a.preventDefault();var b=i(a.currentTarget).parent("span"),c=this.model.get("meta")||[],d=j.findIndex(c,{key:b.data("key")});d>=0&&(c.splice(d,1),this.model.save({meta:c}),this.model.trigger("change:meta")),b.remove()}})},function(a,b,c){var d=c(123),e=c(40),f=c(96),g=c(41);a.exports=d.extend({tagName:"ul",template:f.compile(e("#tmpl-cart-totals").html()),initialize:function(){this.tax=g.request("entities","get",{type:"option",name:"tax"})||{}},modelEvents:{change:"render"},templateHelpers:function(){var a={itemized:"itemized"===this.tax.tax_total_display,has_discount:0!==this.model.get("cart_discount")};return"incl"===this.tax.tax_display_cart&&(a.subtotal=this.model.sum(["subtotal","subtotal_tax"]),a.cart_discount=this.model.sum(["cart_discount","cart_discount_tax"]),a.incl_tax=!0),a}})},function(a,b,c){var d=c(95),e=c(2);a.exports=d.extend({template:e.template("<%= note %>"),modelEvents:{"change:note":"render"},events:{click:"edit",keypress:"saveOnEnter",blur:"save"},onShow:function(){this.showOrHide()},showOrHide:function(){""===this.model.get("note")&&this.$el.hide()},edit:function(){this.$el.attr("contenteditable","true").focus()},save:function(){var a=this.$el.text();this.model.save({note:a}),this.$el.attr("contenteditable","false"),this.showOrHide()},saveOnEnter:function(a){13===a.which&&(a.preventDefault(),this.$el.blur())},showNoteField:function(){this.$el.show(),this.$el.attr("contenteditable","true").focus()}})},function(a,b,c){var d=c(117),e=c(36),f=c(226),g=c(227),h=c(229),i=c(49),j=c(41),k=d.extend({initialize:function(a){a=a||{},this.container=a.container,this.collection=a.collection,this.setTabLabel({tab:"right",label:i.t("titles.checkout")})},fetch:function(){return this.collection.isNew()?this.collection.fetch():void 0},onFetch:function(a){this.order=this.collection.setActiveOrder(a),this.order&&this.listenTo(this.order,"change:status",function(a){a.isEditable()||"failed"===a.get("status")||this.navigate("receipt/"+a.id,{trigger:!0})})},render:function(){this.layout=new f,this.listenTo(this.layout,"show",function(){this.showStatus(),this.showGateways(),this.showActions()}),this.container.show(this.layout)},onRender:function(){this.order&&!this.order.isEditable()&&this.navigate("receipt/"+this.order.id,{trigger:!0})},showStatus:function(){var a=new g({model:this.order});this.layout.getRegion("header").show(a)},showGateways:function(){this.order.gateways.order=this.order;var a=new h({collection:this.order.gateways});this.layout.getRegion("list").show(a)},showActions:function(){var a=j.request("buttons","view",{buttons:[{action:"return-to-sale",className:"btn pull-left"},{action:"process-payment",className:"btn btn-success",icon:"prepend"}]});this.listenTo(a,{"action:return-to-sale":function(){this.navigate("cart/"+this.order.id,{trigger:!0})},"action:process-payment":function(a){a.trigger("state","loading"),this.order.process().always(function(){a.trigger("state","reset")})}}),this.layout.getRegion("actions").show(a)}});a.exports=k,e.attach("POSApp.Checkout.Route",k)},function(a,b,c){var d=c(47),e=c(36),f=c(96),g=d.extend({initialize:function(){this.template=f.compile('<div class="list-header"></div><div class="list"></div><div class="list-actions"></div><div class="list-footer"></div>')},tagName:"section",regions:{header:".list-header",list:".list",actions:".list-actions",footer:".list-footer"},attributes:{"class":"module checkout-module"}});a.exports=g,e.attach("POSApp.Checkout.Views.Layout",g)},function(a,b,c){var d=c(95),e=c(36),f=c(96),g=c(49),h=c(228),i=c(2),j=d.extend({template:f.compile(h),initialize:function(){},templateHelpers:function(){return{status:this.getStatus(),message:this.getMessage()}},modelEvents:{"change:payment_details":"render"},getStatus:function(){return this.model.get("payment_details.paid")===!1?(this.$el.addClass("fail"),g.t("titles.unpaid")):g.t("titles.to-pay")},getMessage:function(){var a=this.model.get("payment_details.message");return i.isArray(a)?i.last(a):a}});a.exports=j,e.attach("POSApp.Checkout.Views.Status",j)},function(a,b){a.exports="<h4>{{status}}: {{{money total}}}</h4>\n{{#if message}}\n  <p>{{{message}}}</p>\n{{/if}}"},function(a,b,c){var d=c(95),e=c(105),f=c(230),g=c(36),h=d.extend({tagName:"li",className:"empty",template:"#tmpl-checkout-gateways-empty"}),i=e.extend({tagName:"ul",childView:f,emptyView:h});a.exports=i,g.attach("POSApp.Checkout.Views.Gateways",i)},function(a,b,c){var d=c(47),e=c(231),f=c(232);a.exports=d.extend({tagName:"li",template:function(){return'<div class="gateway"></div><div class="drawer"></div>'},regions:{gatewayRegion:".gateway",drawerRegion:".drawer"},initialize:function(){this.listenTo(this.model,"change:active",this.toggleDrawer)},onRender:function(){var a=new e({model:this.model});this.gatewayRegion.show(a)},onShow:function(){this.model.get("active")&&this.openDrawer()},openDrawer:function(){var a=new f({model:this.model});this.drawerRegion.show(a),this.$el.addClass("active")},closeDrawer:function(){this.drawerRegion.empty(),this.$el.removeClass("active")},toggleDrawer:function(){this.drawerRegion.hasView()?this.closeDrawer():this.openDrawer()}})},function(a,b,c){var d=c(95),e=c(96);a.exports=d.extend({tagName:"h5",template:e.compile('{{method_title}}{{#if icon}}<img src="{{icon}}">{{/if}}'),events:{click:"makeActive"},makeActive:function(){this.model.set({active:!0})}})},function(a,b,c){var d=c(123),e=c(96),f=c(40),g=c(221),h=c(81),i=c(49);a.exports=d.extend({initialize:function(){this.template=e.compile(f('script[data-gateway="'+this.model.id+'"]').html()),this.order_total=this.model.collection.order.get("total"),this.updateStatusMessage()},templateHelpers:function(){return{total:this.order_total}},behaviors:{Numpad:{behaviorClass:g}},modelEvents:{"change:message":"updateStatusMessage"},onRender:function(){var a=this;return"pos_cash"===this.model.id?this.posCashRender():"pos_card"===this.model.id?this.posCardRender():void this.$("input, select, textarea").each(function(){var b=f(this).attr("name"),c=f(this).attr("id");b&&a.addBinding(null,'*[name="'+b+'"]',b),!b&&c&&a.addBinding(null,"#"+c,c)})},posCashRender:function(){this.addBinding(null,{"#pos-cash-tendered":{observe:"pos-cash-tendered",onGet:function(a){return this.calcChange(a),h.formatNumber(a)},onSet:function(a){var b=h.unformat(a);return this.calcChange(b),b},initialize:function(a,b){b.get("pos-cash-tendered")||b.set({"pos-cash-tendered":this.order_total})}}})},posCardRender:function(){this.addBinding(null,{"#pos-cashback":{observe:"pos-cashback",onGet:h.formatNumber,onSet:h.unformat}})},onShow:function(){this.$el.hide().slideDown(250)},remove:function(){this.$el.slideUp(250,function(){d.prototype.remove.call(this)}.bind(this))},calcChange:function(a){var b=a-this.order_total,c=i.t("titles.change")+": "+h.formatMoney(b);this.model.set({message:c,"pos-cash-change":b})},updateStatusMessage:function(){this.model.collection.order.set({"payment_details.message":this.model.get("message")})}})},function(a,b,c){var d=c(117),e=c(41),f=c(36),g=c(234),h=c(235),i=c(237),j=c(239),k=c(240),l=c(49),m=c(111),n=c(40),o=d.extend({initialize:function(a){a=a||{},this.container=a.container,this.collection=a.collection,this.autoPrint=a.autoPrint,this.setTabLabel({tab:"right",label:l.t("titles.receipt")}),this.tax=e.request("entities","get",{type:"option",name:"tax"})||{}},fetch:function(){return this.collection.isNew()?this.collection.fetch():void 0},onFetch:function(a){this.order=this.collection.get(a),this.order.clearCart();var b=this.order.get("payment_details.redirect");b&&""!==b&&window.open(b,"_blank");var c=e.request("entities","get",{type:"collection",name:"products"});c.fetchUpdated()},render:function(){this.layout=new g({model:this.order}),this.listenTo(this.layout,"show",function(){this.showStatus(),this.showItems(),this.showTotals(),this.showActions(),this.autoPrint&&this.print()}),this.container.show(this.layout)},showStatus:function(){var a=new h({model:this.order});this.layout.getRegion("status").show(a)},showItems:function(){var a=new i({model:this.order});this.layout.getRegion("list").show(a)},showTotals:function(){var a=new j({model:this.order});this.layout.getRegion("totals").show(a)},showActions:function(){var a=new m({buttons:[{action:"print",className:"btn-primary pull-left"},{action:"email",className:"btn-primary pull-left"},{action:"new-order",className:"btn-success"}]});this.listenTo(a,{"action:print":this.print,"action:email":this.email,"action:new-order":function(){this.navigate("",{trigger:!0})}}),this.layout.getRegion("actions").show(a)},print:function(){e.request("print","print",{template:"receipt",model:this.order})},email:function(){var a=this,b=new k({order_id:this.order.get("id"),email:this.order.get("customer.email")});e.request("modal","open",b).then(function(b){var c=b.view.getButtons();a.listenTo(c,"action:send",function(c,d){var e=b.view.getRegion("content").currentView.getEmail();a.send(c,d,e)})})},send:function(a,b,c){function d(b){"success"===b.result?a.trigger("state",["success",b.message]):a.trigger("state",["error",b.message])}function f(b){var c=null;b.responseJSON&&b.responseJSON.errors&&(c=b.responseJSON.errors[0].message),a.trigger("state",["error",c])}var g=this.order.get("id"),h=e.request("entities","get",{type:"option",name:"ajaxurl"});a.trigger("state",["loading",""]),n.getJSON(h,{action:"wc_pos_email_receipt",order_id:g,email:c}).done(d).fail(f)}});a.exports=o,f.attach("POSApp.Receipt.Route",o)},function(a,b,c){var d=c(47);a.exports=d.extend({template:"#tmpl-receipt",tagName:"section",regions:{status:".status",list:".list",totals:".list-totals",actions:".list-actions"},className:function(){return"module receipt-module "+this.model.get("status")}})},function(a,b,c){var d=c(95),e=c(36),f=c(96),g=c(49),h=c(236),i=c(2),j=d.extend({template:f.compile(h),className:function(){return this.model.get("payment_details.paid")?"paid":"unpaid"},initialize:function(){var a=this.model.get("payment_details.paid")?"paid":"unpaid";this.status=g.t("titles."+a);var b=this.model.get("payment_details.message");i.isArray(b)?this.message=i.last(b):this.message=b},templateHelpers:function(){return{status:this.status,message:this.message}}});a.exports=j,e.attach("POSApp.Receipt.Views.Status",j)},function(a,b){a.exports="<h4>{{status}}: {{{money total}}}</h4>\n{{#if message}}\n  <p>{{{message}}}</p>\n{{/if}}"},function(a,b,c){var d=c(238),e=c(36),f=c(96),g=c(40),h=d.extend({tagName:"ul",template:f.compile(g("#tmpl-receipt-items").html())});a.exports=h,e.attach("POSApp.Receipt.Views.Items",h)},function(a,b,c){var d=c(95),e=c(36),f=c(41),g=c(2);a.exports=e.ReceiptView=d.extend({viewOptions:["data"],initialize:function(){var a=f.request("entities","get",{type:"option",name:"tax"})||{},b=this.prepare(this.model.toJSON(),a);this.mergeOptions({data:b},this.viewOptions)},templateHelpers:function(){return this.data},prepare:function(a,b){return a.incl_tax="incl"===b.tax_display_cart,a.itemized="itemized"===b.tax_total_display,g.each(a.line_items,function(a){if(a.on_sale=a.subtotal!==a.total,!a.regular_price){var b=a.quantity||1;a.regular_price=parseFloat(a.subtotal)/b}}),a.incl_tax&&g.each(a.line_items,function(a){var b=a.quantity||1;a.subtotal=parseFloat(a.subtotal)+parseFloat(a.subtotal_tax),a.total=parseFloat(a.total)+parseFloat(a.total_tax),a.regular_price=a.subtotal/b,a.price=a.total/b}),a.itemized&&g.each(a.tax_lines,function(a){a.has_tax=0!==parseFloat(a.total)}),a.cart_discount=a.cart_discount||a.total_discount,a.incl_tax&&(a.subtotal=parseFloat(a.subtotal)+parseFloat(a.subtotal_tax),a.cart_discount=parseFloat(a.cart_discount)+parseFloat(a.cart_discount_tax),g.each(a.shipping_lines,function(a){a.total=parseFloat(a.total)+parseFloat(a.total_tax)}),g.each(a.fee_lines,function(a){a.total=parseFloat(a.total)+parseFloat(a.total_tax)})),a.has_tax=a.total_tax&&0!==parseFloat(a.total_tax),a.has_discount=a.cart_discount&&0!==parseFloat(a.cart_discount),a.has_order_discount=a.order_discount&&0!==parseFloat(a.order_discount),a}})},function(a,b,c){var d=c(238),e=c(36),f=c(96),g=c(40),h=d.extend({tagName:"ul",template:f.compile(g("#tmpl-receipt-totals").html())});a.exports=h,e.attach("POSApp.Receipt.Views.Totals",h)},function(a,b,c){var d=c(95),e=c(36),f=c(96),g=c(49),h=c(241),i=d.extend({template:f.compile(h),viewOptions:["email"],initialize:function(a){this.mergeOptions(a,this.viewOptions),this.modal={header:{title:g.t("titles.email-receipt")},footer:{buttons:[{type:"message"},{action:"send",className:"btn-success",icon:"prepend"}]}}},ui:{email:"input"},templateHelpers:function(){var a={email:this.email};return a},getEmail:function(){return this.ui.email.val()||this.email}});a.exports=i,e.attach("POSApp.Receipt.Views.Email",i)},function(a,b){a.exports='<div class="input-group">\n  <span class="input-group-addon">@</span>\n  <input type="text" class="form-control" placeholder="{{email}}">\n</div>'},function(a,b,c){var d=c(116),e=c(243),f=c(244),g=c(247),h=c(41),i=c(57),j=c(40);a.exports=d.extend({routes:{support:"showStatus"},initialize:function(a){this.container=a.container,this.collection=new i},onBeforeEnter:function(){this.layout=new e,this.container.show(this.layout),this.updateTitle(),this.showForm()},updateTitle:function(){var a=j("#menu li.support").text();h.request("header","update:title",a)},showForm:function(){var a=new f({container:this.layout.getRegion("left")});a.enter()},showStatus:function(){return new g({container:this.layout.getRegion("right"),collection:this.collection})}})},function(a,b,c){var d=c(47);a.exports=d.extend({columns:2,template:function(){return'<div id="left"></div><div id="right"></div>'},regions:{left:"#left",right:"#right"}})},function(a,b,c){var d=c(117),e=c(36),f=c(245),g=c(246),h=c(40),i=c(41),j=c(111),k=c(2),l=d.extend({initialize:function(a){this.container=a.container,this.setTabLabel({tab:"left",label:h("#tmpl-support-form").data("title")})},fetch:function(){},render:function(){this.layout=new f,this.listenTo(this.layout,"show",function(){this.showForm(),this.showActions()}),this.container.show(this.layout)},showForm:function(){var a=new g;this.layout.getRegion("form").show(a)},showActions:function(){var a=new j({buttons:[{type:"message"},{action:"send",className:"btn-success",icon:"prepend"}]});this.listenTo(a,"action:send",this.email),this.layout.getRegion("actions").show(a)},email:function(a,b){var c=this.layout.getRegion("form").currentView,d={action:"wc_pos_send_support_email",name:c.$('[data-name="name"]').text(),email:c.$('[data-name="email"]').text(),message:c.$('[data-name="message"]').text(),status:c.$("#pos_status").val()},e=i.request("entities","get",{type:"option",name:"ajaxurl"});a.trigger("state","loading"),b.triggerMethod("message","reset");var f=function(c){a.trigger("state","error"),b.triggerMethod("message",c,"error")},g=function(c){return k.isObject(c)&&"success"===c.result?(a.trigger("state","success"),void b.triggerMethod("message",c.message,"success")):f(c.message)};h.post(e,d).done(g).fail(f)}});a.exports=l,e.attach("SupportApp.Form.Route",l)},function(a,b,c){var d=c(47),e=c(36),f=c(40),g=d.extend({template:function(){return'<div class="list-header"><div><h4></h4></div></div><div class="list"></div><div class="list-actions"></div><div class="list-footer"></div>'},tagName:"section",regions:{header:".list-header",form:".list",actions:".list-actions",footer:".list-footer"},attributes:{"class":"module support-module"},onRender:function(){var a=f("#tmpl-support-form").data("title");this.$(".list-header h4").text(a)}});a.exports=g,e.attach("SupportApp.Views.Layout",g)},function(a,b,c){var d=c(95),e=c(40);a.exports=d.extend({tagName:"ul",template:"#tmpl-support-form",ui:{toggle:".toggle",status:"#pos_status",message:'div[data-name="message"]'},events:{"click @ui.toggle":"toggleReport","focusout @ui.message":"focusout"},onRender:function(){this.ui.status.append("\n*** Browser Info ***\n\n"+navigator.userAgent+"; "+e("html").attr("class")+"\n\n")},toggleReport:function(a){a.preventDefault(),e(a.currentTarget).next("textarea").toggle()},focusout:function(a){var b=e(a.target);b.text().replace(" ","").length||b.empty()}})},function(a,b,c){var d=c(117),e=c(36),f=c(248),g=c(249),h=c(40),i=c(2),j=c(41),k=c(49),l=d.extend({databases:["products","orders","cart"],initialize:function(a){this.container=a.container,this.collection=a.collection,this.setTabLabel({tab:"right",label:k.t("titles.system-status")}),this.ajaxurl=j.request("entities","get",{type:"option",name:"ajaxurl"}),this.nonce=j.request("entities","get",{type:"option",name:"nonce"})},fetch:function(){var a=i.map(this.databases,this.fetchDB,this);return a.push(this._fetch()),h.when.apply(h,a)},_fetch:function(){var a=this;return h.getJSON(this.ajaxurl,{action:"wc_pos_system_status",security:this.nonce},function(b){a.tests=b})},render:function(){this.layout=new f,this.listenTo(this.layout,"show",function(){this.showStatus()}),this.container.show(this.layout)},showStatus:function(){var a=new g({tests:this.tests,storage:this.storageStatus()});this.listenTo(a,{"action:clear":this.clearDB}),this.layout.getRegion("status").show(a)},storageStatus:function(){return i.map(this.databases,function(a){var b=k.t("titles."+a),c=this[a].length,d=b+": "+c+" "+k.t("plural.records",c);return{message:d,button:{action:"clear-"+a,label:"Clear"}}},this)},fetchDB:function(a){return this[a]=j.request("entities","get",{type:"collection",name:a}),this[a].isNew()?this[a].fetch():void 0},clearDB:function(a){var b=this[a],c=this;b.clear().then(function(){c.render()})}});a.exports=l,e.attach("SupportApp.Status.Route",l)},function(a,b,c){var d=c(47),e=c(36),f=c(49),g=d.extend({template:function(){var a=f.t("titles.system-status");return'<div class="list-header"><div><h4>'+a+'</h4></div></div><div class="list"></div><div class="list-footer"></div>'},tagName:"section",regions:{header:".list-header",status:".list",footer:".list-footer"},attributes:{"class":"module status-module"}});a.exports=g,e.attach("SupportApp.Views.Layout",g)},function(a,b,c){var d=c(95),e=c(40),f=c(250),g=c(96),h=c(49),i=c(141);a.exports=d.extend({tagName:"ul",template:g.compile(f),ui:{toggle:".toggle",btn:".btn"},events:{"click @ui.toggle":"toggleReport","click @ui.btn":"buttonClick"},behaviors:{EmulateHTTP:{behaviorClass:i}},templateHelpers:function(){return{"sub-heading":h.t("titles.local-storage"),tests:this.options.tests,storage:this.options.storage}},toggleReport:function(a){a.preventDefault(),e(a.currentTarget).next("textarea").toggle()},buttonClick:function(a){var b=e(a.target).data("action").split("-"),c=b.shift();c&&(a.preventDefault(),this.trigger("action:"+c,b[0]))}})},function(a,b){a.exports='{{#each tests}}\n  <li>\n    <div class="shrink">\n      {{#if pass}}\n        <i class="icon-success icon-lg"></i>\n      {{else}}\n        <i class="icon-error icon-lg"></i>\n      {{/if}}\n    </div>\n    <div class="title">{{title}}</div>\n    <div class="message">\n      {{{message}}}\n      {{#each buttons}}\n        <a href="{{#if href}}{{href}}{{else}}#{{/if}}" {{#if action}}data-action="{{action}}"{{/if}} class="btn btn-default">{{prompt}}</a>\n      {{/each}}\n    </div>\n  </li>\n{{/each}}\n\n<li class="sub-heading"><div>{{sub-heading}}</div></li>\n\n{{#each storage}}\n<li>\n  {{#if icon}}\n  <div class="shrink">\n    <i class="icon-{{icon}} icon-lg"></i>\n  </div>\n  {{/if}}\n  {{#if title}}\n  <div class="title">{{title}}</div>\n  {{/if}}\n  <div class="message">\n    {{{message}}}\n    {{#if button}}\n      <button class="btn btn-default" data-action="{{button.action}}">{{button.label}}</button>\n    {{/if}}\n  </div>\n</li>\n{{/each}}'},function(a,b,c){var d=c(36),e=c(116),f=c(252),g=c(253),h=c(41),i=e.extend({routes:{"print(/:id)(/)":"showReceipt"},initialize:function(a){this.container=a.container},onBeforeEnter:function(){this.layout=new f,this.container.show(this.layout)},onBeforeRoute:function(){this.showActions()},showReceipt:function(){return new g({container:this.layout.getRegion("iframe")})},showActions:function(){var a=h.request("buttons","view",{buttons:[{action:"print",className:"btn-success"}]});this.listenTo(a,"action:print",function(){this.layout.getRegion("iframe").currentView.print()}),this.layout.getRegion("actions").show(a)}});a.exports=i,d.attach("Print.Router",i)},function(a,b,c){var d=c(47);a.exports=d.extend({className:"print-preview",template:function(){return'<div id="iframe"></div><div id="actions"></div>'},regions:{iframe:"#iframe",actions:"#actions"}})},function(a,b,c){var d=c(117),e=c(41),f=c(254),g=d.extend({initialize:function(a){a=a||{},this.container=a.container,this.collection=e.request("entities","get",{name:"orders",type:"collection"})},fetch:function(){return 0===this.collection.length?this.collection.fetch({remote:!0}):void 0},render:function(){var a=new f({model:this.collection.at(0)});this.container.show(a)}});a.exports=g},function(a,b,c){var d=c(238),e=c(96),f=c(40);a.exports=d.extend({tagName:"iframe",template:function(){},onShow:function(){var a=e.compile(f("#tmpl-print-receipt").html());this.window=this.el.contentWindow,this.window.document.write(a(this.data))},print:function(){this.window.focus(),this.window.print()}})},function(a,b,c){var d=c(2),e=c(96),f=c(48),g=c(60),h=c(81);e.registerHelper("is",function(a,b,c){return a&&d.includes(b.split("|"),a)?c.fn(this):c.inverse(this)}),e.registerHelper("compare",function(a,b,c,d){if(arguments.length<3)throw new Error('Handlebars Helper "compare" needs 2 parameters');void 0===d&&(d=c,c=b,b="===");var e={"===":function(a,b){return a===b},"!==":function(a,b){return a!==b},"<":function(a,b){return b>a},">":function(a,b){return a>b},"<=":function(a,b){return b>=a},">=":function(a,b){return a>=b}};if(!e[b])throw new Error('Handlebars Helper "compare" doesn\'t know the operator '+b);var f=e[b](a,c);return f?d.fn(this):d.inverse(this)}),e.registerHelper("list",function(a,b,c){if(d.isArray(a)||d.isObject(a)){var e=d.map(a,c.fn);return e.join(b)}return c.fn(a)}),e.registerHelper("csv",function(a,b){return b.fn(a.join(", "))}),e.registerHelper("money",function(a,b){var c=f.settings.currency.precision,d=b.hash.precision||c;return"auto"===d&&(d=h.decimalPlaces(a)),a=h.round(a,d),b.hash.negative&&(a=-1*a),f.formatMoney(a)}),e.registerHelper("number",function(a,b){var c=f.settings.number.precision,d=b.hash.precision||c;return"auto"===d&&(d=h.decimalPlaces(a)),b.hash.negative&&(a=-1*a),f.formatNumber(a,d)}),e.registerHelper("formatAddress",function(a,b){
a=a||{};var c=[[a.first_name,a.last_name],[a.company],[a.address_1],[a.address_2],[a.city,a.state,a.postcode]],f=d.chain(c).map(function(a){return d.compact(a).join(" ")}).compact().join("<br>\n").value();return""!==f&&b.hash.title&&(f="<h3>"+b.hash.title+"</h3>\n"+f),new e.SafeString(f)}),e.registerHelper("formatDate",function(a,b){var c=b.hash.format||"";return g(a).format(c)}),e.registerHelper("formatDay",function(a,b){var c=b.hash.format||"",d=parseInt(a,10)+1;return g().isoWeekday(d).format(c)}),e.registerHelper("debug",function(a){console.log("Current Context"),console.log("===================="),console.log(this),a&&(console.log("Value"),console.log("===================="),console.log(a))})}]);